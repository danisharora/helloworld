[2016-11-17 14:06:49,053] WARN [ReplicaFetcherThread-0-0], Error in fetch kafka.server.ReplicaFetcherThread$FetchRequest@69051dab. Possible cause: java.io.IOException: Connection to 0 was disconnected before the response was read (kafka.server.ReplicaFetcherThread)
[2016-11-17 14:06:49,054] INFO Partition [__consumer_offsets,33] on broker 2: Shrinking ISR for partition [__consumer_offsets,33] from 2,1 to 2 (kafka.cluster.Partition)
[2016-11-17 14:06:49,054] WARN [ReplicaFetcherThread-0-1], Error in fetch kafka.server.ReplicaFetcherThread$FetchRequest@378b36c4. Possible cause: java.io.IOException: Connection to 1 was disconnected before the response was read (kafka.server.ReplicaFetcherThread)
[2016-11-17 14:06:52,736] INFO Creating /controller (is it secure? false) (kafka.utils.ZKCheckedEphemeral)
[2016-11-17 14:06:52,953] INFO Partition [__consumer_offsets,37] on broker 2: Shrinking ISR for partition [__consumer_offsets,37] from 2,1 to 2 (kafka.cluster.Partition)
[2016-11-17 14:06:53,130] INFO Partition [othertopic,1] on broker 2: Shrinking ISR for partition [othertopic,1] from 2,0,1 to 2 (kafka.cluster.Partition)
[2016-11-17 14:06:53,453] INFO Result of znode creation is: NODEEXISTS (kafka.utils.ZKCheckedEphemeral)
[2016-11-17 14:06:54,171] INFO re-registering broker info in ZK for broker 2 (kafka.server.KafkaHealthcheck)
[2016-11-17 14:06:54,171] INFO Partition [__consumer_offsets,29] on broker 2: Shrinking ISR for partition [__consumer_offsets,29] from 2,1 to 2 (kafka.cluster.Partition)
[2016-11-17 14:06:54,183] INFO Creating /brokers/ids/2 (is it secure? false) (kafka.utils.ZKCheckedEphemeral)
[2016-11-17 14:06:54,862] INFO Partition [__consumer_offsets,15] on broker 2: Shrinking ISR for partition [__consumer_offsets,15] from 2,1 to 2 (kafka.cluster.Partition)
[2016-11-17 14:06:54,863] INFO Result of znode creation is: OK (kafka.utils.ZKCheckedEphemeral)
[2016-11-17 14:06:54,863] INFO Registered broker 2 at path /brokers/ids/2 with addresses: PLAINTEXT -> EndPoint(localhost,9094,PLAINTEXT) (kafka.utils.ZkUtils)
[2016-11-17 14:06:54,863] INFO done re-registering broker (kafka.server.KafkaHealthcheck)
[2016-11-17 14:06:54,863] INFO Subscribing to /brokers/topics path to watch for new topics (kafka.server.KafkaHealthcheck)
[2016-11-17 14:06:55,492] INFO Partition [__consumer_offsets,5] on broker 2: Shrinking ISR for partition [__consumer_offsets,5] from 2,1 to 2 (kafka.cluster.Partition)
[2016-11-17 14:06:55,512] INFO Partition [__consumer_offsets,11] on broker 2: Shrinking ISR for partition [__consumer_offsets,11] from 2,1 to 2 (kafka.cluster.Partition)
[2016-11-17 14:06:55,519] INFO Partition [__consumer_offsets,49] on broker 2: Shrinking ISR for partition [__consumer_offsets,49] from 2,1 to 2 (kafka.cluster.Partition)
[2016-11-17 14:06:55,550] INFO Partition [__consumer_offsets,31] on broker 2: Shrinking ISR for partition [__consumer_offsets,31] from 2,1 to 2 (kafka.cluster.Partition)
[2016-11-17 14:06:56,441] INFO Partition [__consumer_offsets,13] on broker 2: Shrinking ISR for partition [__consumer_offsets,13] from 2,1 to 2 (kafka.cluster.Partition)
[2016-11-17 14:06:57,167] INFO Partition [__consumer_offsets,47] on broker 2: Shrinking ISR for partition [__consumer_offsets,47] from 2,1 to 2 (kafka.cluster.Partition)
[2016-11-17 14:06:57,274] INFO Partition [__consumer_offsets,7] on broker 2: Shrinking ISR for partition [__consumer_offsets,7] from 2,1 to 2 (kafka.cluster.Partition)
[2016-11-17 14:06:57,672] INFO Partition [__consumer_offsets,17] on broker 2: Shrinking ISR for partition [__consumer_offsets,17] from 2,1 to 2 (kafka.cluster.Partition)
[2016-11-17 14:06:57,952] INFO Partition [__consumer_offsets,1] on broker 2: Shrinking ISR for partition [__consumer_offsets,1] from 2,1 to 2 (kafka.cluster.Partition)
[2016-11-17 14:06:58,038] INFO Partition [topic2,1] on broker 2: Shrinking ISR for partition [topic2,1] from 2,0,1 to 2 (kafka.cluster.Partition)
[2016-11-17 14:06:58,143] INFO Partition [__consumer_offsets,9] on broker 2: Shrinking ISR for partition [__consumer_offsets,9] from 2,1 to 2 (kafka.cluster.Partition)
[2016-11-17 14:06:58,162] INFO Partition [__consumer_offsets,21] on broker 2: Shrinking ISR for partition [__consumer_offsets,21] from 2,1 to 2 (kafka.cluster.Partition)
[2016-11-17 14:06:58,536] INFO Partition [__consumer_offsets,3] on broker 2: Shrinking ISR for partition [__consumer_offsets,3] from 2,1 to 2 (kafka.cluster.Partition)
[2016-11-17 14:06:58,777] INFO Partition [__consumer_offsets,23] on broker 2: Shrinking ISR for partition [__consumer_offsets,23] from 2,1 to 2 (kafka.cluster.Partition)
[2016-11-17 14:06:58,779] INFO Partition [__consumer_offsets,39] on broker 2: Shrinking ISR for partition [__consumer_offsets,39] from 2,1 to 2 (kafka.cluster.Partition)
[2016-11-17 14:06:58,781] INFO Partition [__consumer_offsets,43] on broker 2: Shrinking ISR for partition [__consumer_offsets,43] from 2,1 to 2 (kafka.cluster.Partition)
[2016-11-17 14:06:59,052] INFO Partition [__consumer_offsets,35] on broker 2: Shrinking ISR for partition [__consumer_offsets,35] from 2,1 to 2 (kafka.cluster.Partition)
[2016-11-17 14:06:59,090] INFO Partition [__consumer_offsets,41] on broker 2: Shrinking ISR for partition [__consumer_offsets,41] from 2,1 to 2 (kafka.cluster.Partition)
[2016-11-17 14:06:59,223] INFO Partition [__consumer_offsets,19] on broker 2: Shrinking ISR for partition [__consumer_offsets,19] from 2,1 to 2 (kafka.cluster.Partition)
[2016-11-17 14:06:59,331] INFO Partition [__consumer_offsets,27] on broker 2: Shrinking ISR for partition [__consumer_offsets,27] from 2,1 to 2 (kafka.cluster.Partition)
[2016-11-17 14:06:59,832] INFO Partition [__consumer_offsets,25] on broker 2: Shrinking ISR for partition [__consumer_offsets,25] from 2,1 to 2 (kafka.cluster.Partition)
[2016-11-17 14:07:00,135] INFO Partition [__consumer_offsets,45] on broker 2: Shrinking ISR for partition [__consumer_offsets,45] from 2,1 to 2 (kafka.cluster.Partition)
[2016-11-17 14:07:00,136] INFO New leader is 0 (kafka.server.ZookeeperLeaderElector$LeaderChangeListener)
[2016-11-17 14:07:00,621] INFO New leader is 0 (kafka.server.ZookeeperLeaderElector$LeaderChangeListener)
[2016-11-17 14:07:04,736] ERROR [KafkaApi-2] error when handling request Name:UpdateMetadataRequest;Version:1;Controller:1;ControllerEpoch:57;CorrelationId:3;ClientId:1;AliveBrokers:0 : (EndPoint(localhost,9092,PLAINTEXT)),2 : (EndPoint(localhost,9094,PLAINTEXT));PartitionState:[__consumer_offsets,32] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:32,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,16] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,44] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,28] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,4] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,24] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,0] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,38] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,8] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,36] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,40] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:32,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,6] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,20] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,2] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,34] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,22] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,42] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,14] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,10] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[topic2,0] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:13,ControllerEpoch:57),ReplicationFactor:3),AllReplicas:1,0,2),[__consumer_offsets,48] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,18] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,12] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,46] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:32,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,26] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,30] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[othertopic,0] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57),ReplicationFactor:3),AllReplicas:1,2,0) (kafka.server.KafkaApis)
kafka.common.ControllerMovedException: Broker 2 received update metadata request with correlation id 3 from an old controller 1 with epoch 57. Latest known controller epoch is 58
	at kafka.server.ReplicaManager.maybeUpdateMetadataCache(ReplicaManager.scala:574)
	at kafka.server.KafkaApis.handleUpdateMetadataRequest(KafkaApis.scala:160)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:74)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
[2016-11-17 14:07:04,790] INFO [ReplicaFetcherManager on broker 2] Removed fetcher for partitions [__consumer_offsets,32],[__consumer_offsets,16],[__consumer_offsets,44],[__consumer_offsets,28],[__consumer_offsets,4],[__consumer_offsets,24],[__consumer_offsets,0],[__consumer_offsets,38],[__consumer_offsets,8],[__consumer_offsets,36],[__consumer_offsets,40],[__consumer_offsets,6],[__consumer_offsets,20],[__consumer_offsets,2],[__consumer_offsets,34],[__consumer_offsets,22],[__consumer_offsets,42],[__consumer_offsets,14],[__consumer_offsets,10],[__consumer_offsets,48],[__consumer_offsets,18],[__consumer_offsets,12],[__consumer_offsets,46],[__consumer_offsets,26],[__consumer_offsets,30],[othertopic,0] (kafka.server.ReplicaFetcherManager)
[2016-11-17 14:07:04,792] INFO [ReplicaFetcherManager on broker 2] Removed fetcher for partitions [topic2,0] (kafka.server.ReplicaFetcherManager)
[2016-11-17 14:07:04,793] INFO Truncating log topic2-0 to offset 0. (kafka.log.Log)
[2016-11-17 14:07:05,105] ERROR [KafkaApi-2] error when handling request Name:LeaderAndIsrRequest;Version:0;Controller:0;ControllerEpoch:58;CorrelationId:2;ClientId:0;Leaders:BrokerEndPoint(0,localhost,9092),BrokerEndPoint(2,localhost,9094);PartitionState:(__consumer_offsets,32) -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:58),ReplicationFactor:2),AllReplicas:1,2),(__consumer_offsets,16) -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58),ReplicationFactor:2),AllReplicas:1,2),(__consumer_offsets,44) -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58),ReplicationFactor:2),AllReplicas:1,2),(__consumer_offsets,28) -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58),ReplicationFactor:2),AllReplicas:1,2),(__consumer_offsets,4) -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58),ReplicationFactor:2),AllReplicas:1,2),(__consumer_offsets,24) -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58),ReplicationFactor:2),AllReplicas:1,2),(__consumer_offsets,0) -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58),ReplicationFactor:2),AllReplicas:1,2),(__consumer_offsets,38) -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58),ReplicationFactor:2),AllReplicas:1,2),(__consumer_offsets,8) -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58),ReplicationFactor:2),AllReplicas:1,2),(__consumer_offsets,36) -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58),ReplicationFactor:2),AllReplicas:1,2),(__consumer_offsets,40) -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:58),ReplicationFactor:2),AllReplicas:1,2),(__consumer_offsets,6) -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58),ReplicationFactor:2),AllReplicas:1,2),(__consumer_offsets,20) -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58),ReplicationFactor:2),AllReplicas:1,2),(__consumer_offsets,2) -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58),ReplicationFactor:2),AllReplicas:1,2),(__consumer_offsets,34) -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58),ReplicationFactor:2),AllReplicas:1,2),(__consumer_offsets,22) -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58),ReplicationFactor:2),AllReplicas:1,2),(__consumer_offsets,42) -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58),ReplicationFactor:2),AllReplicas:1,2),(__consumer_offsets,14) -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58),ReplicationFactor:2),AllReplicas:1,2),(__consumer_offsets,10) -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58),ReplicationFactor:2),AllReplicas:1,2),(topic2,0) -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:14,ControllerEpoch:58),ReplicationFactor:3),AllReplicas:1,0,2),(__consumer_offsets,48) -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58),ReplicationFactor:2),AllReplicas:1,2),(__consumer_offsets,18) -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58),ReplicationFactor:2),AllReplicas:1,2),(__consumer_offsets,12) -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58),ReplicationFactor:2),AllReplicas:1,2),(__consumer_offsets,46) -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:58),ReplicationFactor:2),AllReplicas:1,2),(__consumer_offsets,26) -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58),ReplicationFactor:2),AllReplicas:1,2),(__consumer_offsets,30) -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58),ReplicationFactor:2),AllReplicas:1,2),(othertopic,0) -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58),ReplicationFactor:3),AllReplicas:1,2,0) (kafka.server.KafkaApis)
java.lang.IllegalArgumentException: A metric named 'MetricName [name=connection-close-rate, group=replica-fetcher-metrics, description=Connections closed per second in the window., tags={broker-id=0, fetcher-id=0}]' already exists, can't register another one.
	at org.apache.kafka.common.metrics.Metrics.registerMetric(Metrics.java:285)
	at org.apache.kafka.common.metrics.Sensor.add(Sensor.java:177)
	at org.apache.kafka.common.metrics.Sensor.add(Sensor.java:162)
	at org.apache.kafka.common.network.Selector$SelectorMetrics.<init>(Selector.java:572)
	at org.apache.kafka.common.network.Selector.<init>(Selector.java:112)
	at kafka.server.ReplicaFetcherThread.<init>(ReplicaFetcherThread.scala:73)
	at kafka.server.ReplicaFetcherManager.createFetcherThread(ReplicaFetcherManager.scala:35)
	at kafka.server.AbstractFetcherManager$$anonfun$addFetcherForPartitions$2.apply(AbstractFetcherManager.scala:83)
	at kafka.server.AbstractFetcherManager$$anonfun$addFetcherForPartitions$2.apply(AbstractFetcherManager.scala:78)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.immutable.Map$Map1.foreach(Map.scala:116)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.server.AbstractFetcherManager.addFetcherForPartitions(AbstractFetcherManager.scala:78)
	at kafka.server.ReplicaManager.makeFollowers(ReplicaManager.scala:816)
	at kafka.server.ReplicaManager.becomeLeaderOrFollower(ReplicaManager.scala:641)
	at kafka.server.KafkaApis.handleLeaderAndIsrRequest(KafkaApis.scala:131)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:72)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
[2016-11-17 14:07:05,109] ERROR [KafkaApi-2] error when handling request Name:UpdateMetadataRequest;Version:1;Controller:1;ControllerEpoch:57;CorrelationId:4;ClientId:1;AliveBrokers:0 : (EndPoint(localhost,9092,PLAINTEXT)),2 : (EndPoint(localhost,9094,PLAINTEXT));PartitionState:[__consumer_offsets,32] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:32,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,16] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[topic2,2] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:38),ReplicationFactor:3),AllReplicas:0,2,1),[__consumer_offsets,49] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,44] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,28] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[topic2,1] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:17,ControllerEpoch:53),ReplicationFactor:3),AllReplicas:2,1,0),[__consumer_offsets,17] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,23] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,7] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,4] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,29] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[topic4,0] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:38),ReplicationFactor:2),AllReplicas:0,1),[__consumer_offsets,35] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:36,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,3] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,24] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,41] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[topic1,0] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:21,ControllerEpoch:52),ReplicationFactor:1),AllReplicas:2),[__consumer_offsets,0] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,38] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,13] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,8] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,5] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,39] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,36] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[topic3,1] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:6,ControllerEpoch:55),ReplicationFactor:1),AllReplicas:1),[__consumer_offsets,40] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:32,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[othertopic,2] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:48,ControllerEpoch:38),ReplicationFactor:3),AllReplicas:0,1,2),[__consumer_offsets,45] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,15] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,33] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,37] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,21] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[othertopic,1] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:53,ControllerEpoch:53),ReplicationFactor:3),AllReplicas:2,0,1),[__consumer_offsets,6] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,11] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,20] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,47] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,2] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,27] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[topic3,2] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:52),ReplicationFactor:1),AllReplicas:2),[mytopic,0] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:37,ControllerEpoch:38),ReplicationFactor:1),AllReplicas:0),[__consumer_offsets,34] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,9] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:36,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,22] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,42] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,14] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,25] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:36,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,10] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[topic2,0] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:13,ControllerEpoch:57),ReplicationFactor:3),AllReplicas:1,0,2),[__consumer_offsets,48] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,31] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,18] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,19] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:34,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,12] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[topic3,0] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:38),ReplicationFactor:1),AllReplicas:0),[__consumer_offsets,46] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:32,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,43] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,1] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:36,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,26] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,30] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:57),ReplicationFactor:2),AllReplicas:1,2),[othertopic,0] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:48,ControllerEpoch:57),ReplicationFactor:3),AllReplicas:1,2,0) (kafka.server.KafkaApis)
kafka.common.ControllerMovedException: Broker 2 received update metadata request with correlation id 4 from an old controller 1 with epoch 57. Latest known controller epoch is 58
	at kafka.server.ReplicaManager.maybeUpdateMetadataCache(ReplicaManager.scala:574)
	at kafka.server.KafkaApis.handleUpdateMetadataRequest(KafkaApis.scala:160)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:74)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
[2016-11-17 14:07:24,265] WARN [ReplicaFetcherThread-0-1], Error in fetch kafka.server.ReplicaFetcherThread$FetchRequest@46b505ff. Possible cause: java.io.IOException: Connection to Node(1, 172.16.26.72, 9093) failed (kafka.server.ReplicaFetcherThread)
[2016-11-17 14:07:24,265] WARN [ReplicaFetcherThread-0-0], Error in fetch kafka.server.ReplicaFetcherThread$FetchRequest@5a86355a. Possible cause: java.io.IOException: Connection to Node(0, 172.16.26.72, 9092) failed (kafka.server.ReplicaFetcherThread)
[2016-11-17 14:07:26,296] INFO Partition [topic2,1] on broker 2: Expanding ISR for partition [topic2,1] from 2 to 2,0 (kafka.cluster.Partition)
[2016-11-17 14:07:26,296] INFO Partition [__consumer_offsets,49] on broker 2: Expanding ISR for partition [__consumer_offsets,49] from 2 to 2,1 (kafka.cluster.Partition)
[2016-11-17 14:07:26,316] INFO Partition [othertopic,1] on broker 2: Expanding ISR for partition [othertopic,1] from 2 to 2,0 (kafka.cluster.Partition)
[2016-11-17 14:07:26,316] INFO Partition [topic2,1] on broker 2: Expanding ISR for partition [topic2,1] from 2,0 to 2,0,1 (kafka.cluster.Partition)
[2016-11-17 14:07:26,317] INFO Partition [__consumer_offsets,17] on broker 2: Expanding ISR for partition [__consumer_offsets,17] from 2 to 2,1 (kafka.cluster.Partition)
[2016-11-17 14:07:26,318] INFO Partition [__consumer_offsets,23] on broker 2: Expanding ISR for partition [__consumer_offsets,23] from 2 to 2,1 (kafka.cluster.Partition)
[2016-11-17 14:07:26,319] INFO Partition [__consumer_offsets,7] on broker 2: Expanding ISR for partition [__consumer_offsets,7] from 2 to 2,1 (kafka.cluster.Partition)
[2016-11-17 14:07:26,319] INFO Partition [__consumer_offsets,29] on broker 2: Expanding ISR for partition [__consumer_offsets,29] from 2 to 2,1 (kafka.cluster.Partition)
[2016-11-17 14:07:26,320] INFO Partition [__consumer_offsets,35] on broker 2: Expanding ISR for partition [__consumer_offsets,35] from 2 to 2,1 (kafka.cluster.Partition)
[2016-11-17 14:07:26,321] INFO Partition [__consumer_offsets,3] on broker 2: Expanding ISR for partition [__consumer_offsets,3] from 2 to 2,1 (kafka.cluster.Partition)
[2016-11-17 14:07:26,321] INFO Partition [__consumer_offsets,41] on broker 2: Expanding ISR for partition [__consumer_offsets,41] from 2 to 2,1 (kafka.cluster.Partition)
[2016-11-17 14:07:26,322] INFO Partition [__consumer_offsets,13] on broker 2: Expanding ISR for partition [__consumer_offsets,13] from 2 to 2,1 (kafka.cluster.Partition)
[2016-11-17 14:07:26,322] INFO Partition [__consumer_offsets,5] on broker 2: Expanding ISR for partition [__consumer_offsets,5] from 2 to 2,1 (kafka.cluster.Partition)
[2016-11-17 14:07:26,323] INFO Partition [__consumer_offsets,39] on broker 2: Expanding ISR for partition [__consumer_offsets,39] from 2 to 2,1 (kafka.cluster.Partition)
[2016-11-17 14:07:26,324] INFO Partition [__consumer_offsets,45] on broker 2: Expanding ISR for partition [__consumer_offsets,45] from 2 to 2,1 (kafka.cluster.Partition)
[2016-11-17 14:07:26,325] INFO Partition [__consumer_offsets,15] on broker 2: Expanding ISR for partition [__consumer_offsets,15] from 2 to 2,1 (kafka.cluster.Partition)
[2016-11-17 14:07:26,325] INFO Partition [__consumer_offsets,33] on broker 2: Expanding ISR for partition [__consumer_offsets,33] from 2 to 2,1 (kafka.cluster.Partition)
[2016-11-17 14:07:26,326] INFO Partition [__consumer_offsets,37] on broker 2: Expanding ISR for partition [__consumer_offsets,37] from 2 to 2,1 (kafka.cluster.Partition)
[2016-11-17 14:07:26,326] INFO Partition [__consumer_offsets,21] on broker 2: Expanding ISR for partition [__consumer_offsets,21] from 2 to 2,1 (kafka.cluster.Partition)
[2016-11-17 14:07:26,327] INFO Partition [othertopic,1] on broker 2: Expanding ISR for partition [othertopic,1] from 2,0 to 2,0,1 (kafka.cluster.Partition)
[2016-11-17 14:07:26,328] INFO Partition [__consumer_offsets,11] on broker 2: Expanding ISR for partition [__consumer_offsets,11] from 2 to 2,1 (kafka.cluster.Partition)
[2016-11-17 14:07:26,328] INFO Partition [__consumer_offsets,47] on broker 2: Expanding ISR for partition [__consumer_offsets,47] from 2 to 2,1 (kafka.cluster.Partition)
[2016-11-17 14:07:26,329] INFO Partition [__consumer_offsets,27] on broker 2: Expanding ISR for partition [__consumer_offsets,27] from 2 to 2,1 (kafka.cluster.Partition)
[2016-11-17 14:07:26,329] INFO Partition [__consumer_offsets,9] on broker 2: Expanding ISR for partition [__consumer_offsets,9] from 2 to 2,1 (kafka.cluster.Partition)
[2016-11-17 14:07:26,330] INFO Partition [__consumer_offsets,25] on broker 2: Expanding ISR for partition [__consumer_offsets,25] from 2 to 2,1 (kafka.cluster.Partition)
[2016-11-17 14:07:26,330] INFO Partition [__consumer_offsets,31] on broker 2: Expanding ISR for partition [__consumer_offsets,31] from 2 to 2,1 (kafka.cluster.Partition)
[2016-11-17 14:07:26,331] INFO Partition [__consumer_offsets,19] on broker 2: Expanding ISR for partition [__consumer_offsets,19] from 2 to 2,1 (kafka.cluster.Partition)
[2016-11-17 14:07:26,332] INFO Partition [__consumer_offsets,43] on broker 2: Expanding ISR for partition [__consumer_offsets,43] from 2 to 2,1 (kafka.cluster.Partition)
[2016-11-17 14:07:26,333] INFO Partition [__consumer_offsets,1] on broker 2: Expanding ISR for partition [__consumer_offsets,1] from 2 to 2,1 (kafka.cluster.Partition)
[2016-11-17 14:13:41,131] INFO [Group Metadata Manager on Broker 2]: Removed 0 expired offsets in 0 milliseconds. (kafka.coordinator.GroupMetadataManager)
[2016-11-17 14:23:41,105] INFO [Group Metadata Manager on Broker 2]: Removed 0 expired offsets in 1 milliseconds. (kafka.coordinator.GroupMetadataManager)
[2016-11-17 14:33:41,077] INFO [Group Metadata Manager on Broker 2]: Removed 0 expired offsets in 0 milliseconds. (kafka.coordinator.GroupMetadataManager)
[2016-11-17 14:43:41,054] INFO [Group Metadata Manager on Broker 2]: Removed 0 expired offsets in 0 milliseconds. (kafka.coordinator.GroupMetadataManager)
[2016-11-17 14:53:41,032] INFO [Group Metadata Manager on Broker 2]: Removed 0 expired offsets in 0 milliseconds. (kafka.coordinator.GroupMetadataManager)
