[2016-11-17 15:02:09,990] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2016-11-17 15:02:10,068] DEBUG [Controller 0]: preferred replicas by broker Map(2 -> Map([__consumer_offsets,19] -> List(2, 1), [__consumer_offsets,47] -> List(2, 1), [__consumer_offsets,41] -> List(2, 1), [__consumer_offsets,29] -> List(2, 1), [topic2,1] -> List(2, 1, 0), [__consumer_offsets,39] -> List(2, 1), [__consumer_offsets,17] -> List(2, 1), [__consumer_offsets,33] -> List(2, 1), [__consumer_offsets,5] -> List(2, 1), [__consumer_offsets,21] -> List(2, 1), [__consumer_offsets,3] -> List(2, 1), [othertopic,1] -> List(2, 0, 1), [__consumer_offsets,23] -> List(2, 1), [__consumer_offsets,15] -> List(2, 1), [__consumer_offsets,11] -> List(2, 1), [__consumer_offsets,13] -> List(2, 1), [__consumer_offsets,49] -> List(2, 1), [__consumer_offsets,37] -> List(2, 1), [__consumer_offsets,31] -> List(2, 1), [topic1,0] -> List(2), [topic3,2] -> List(2), [__consumer_offsets,25] -> List(2, 1), [__consumer_offsets,45] -> List(2, 1), [__consumer_offsets,27] -> List(2, 1), [__consumer_offsets,43] -> List(2, 1), [__consumer_offsets,35] -> List(2, 1), [__consumer_offsets,7] -> List(2, 1), [__consumer_offsets,9] -> List(2, 1), [__consumer_offsets,1] -> List(2, 1)), 1 -> Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [topic3,1] -> List(1), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [topic2,0] -> List(1, 0, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2)), 0 -> Map([othertopic,2] -> List(0, 1, 2), [topic2,2] -> List(0, 2, 1), [mytopic,0] -> List(0), [topic4,0] -> List(0, 1), [topic3,0] -> List(0))) (kafka.controller.KafkaController)
[2016-11-17 15:02:10,069] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2016-11-17 15:02:10,069] TRACE [Controller 0]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2016-11-17 15:02:10,069] DEBUG [Controller 0]: topics not in preferred replica Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [topic2,0] -> List(1, 0, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2)) (kafka.controller.KafkaController)
[2016-11-17 15:02:10,069] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 0.964286 (kafka.controller.KafkaController)
[2016-11-17 15:02:10,069] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,30] (kafka.controller.KafkaController)
[2016-11-17 15:02:10,069] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,30] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:02:10,071] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,30] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:02:10,072] WARN [Controller 0]: Partition [__consumer_offsets,30] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:02:10,072] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,10] (kafka.controller.KafkaController)
[2016-11-17 15:02:10,072] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,10] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:02:10,073] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,10] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:02:10,074] WARN [Controller 0]: Partition [__consumer_offsets,10] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:02:10,074] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,14] (kafka.controller.KafkaController)
[2016-11-17 15:02:10,074] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,14] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:02:10,075] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,14] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:02:10,076] WARN [Controller 0]: Partition [__consumer_offsets,14] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:02:10,076] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,40] (kafka.controller.KafkaController)
[2016-11-17 15:02:10,076] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,40] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:02:10,077] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,40] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:02:10,077] WARN [Controller 0]: Partition [__consumer_offsets,40] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:02:10,077] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,18] (kafka.controller.KafkaController)
[2016-11-17 15:02:10,077] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,18] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:02:10,079] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,18] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:02:10,079] WARN [Controller 0]: Partition [__consumer_offsets,18] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:02:10,079] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,26] (kafka.controller.KafkaController)
[2016-11-17 15:02:10,079] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,26] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:02:10,080] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,26] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:02:10,081] WARN [Controller 0]: Partition [__consumer_offsets,26] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:02:10,081] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,0] (kafka.controller.KafkaController)
[2016-11-17 15:02:10,081] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:02:10,082] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:02:10,083] WARN [Controller 0]: Partition [__consumer_offsets,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:02:10,083] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,24] (kafka.controller.KafkaController)
[2016-11-17 15:02:10,083] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,24] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:02:10,084] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,24] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:02:10,084] WARN [Controller 0]: Partition [__consumer_offsets,24] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:02:10,084] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,0] (kafka.controller.KafkaController)
[2016-11-17 15:02:10,084] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:02:10,085] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [othertopic,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:02:10,086] WARN [Controller 0]: Partition [othertopic,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:02:10,086] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,20] (kafka.controller.KafkaController)
[2016-11-17 15:02:10,086] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,20] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:02:10,087] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,20] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:02:10,087] WARN [Controller 0]: Partition [__consumer_offsets,20] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:02:10,087] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,22] (kafka.controller.KafkaController)
[2016-11-17 15:02:10,087] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,22] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:02:10,088] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,22] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:02:10,089] WARN [Controller 0]: Partition [__consumer_offsets,22] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:02:10,089] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,12] (kafka.controller.KafkaController)
[2016-11-17 15:02:10,089] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,12] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:02:10,090] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,12] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:02:10,090] WARN [Controller 0]: Partition [__consumer_offsets,12] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:02:10,090] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic2,0] (kafka.controller.KafkaController)
[2016-11-17 15:02:10,090] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic2,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:02:10,091] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 0 for partition [topic2,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:02:10,092] WARN [Controller 0]: Partition [topic2,0] failed to complete preferred replica leader election. Leader is 0 (kafka.controller.KafkaController)
[2016-11-17 15:02:10,092] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,8] (kafka.controller.KafkaController)
[2016-11-17 15:02:10,092] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,8] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:02:10,093] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,8] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:02:10,093] WARN [Controller 0]: Partition [__consumer_offsets,8] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:02:10,093] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,48] (kafka.controller.KafkaController)
[2016-11-17 15:02:10,093] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,48] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:02:10,094] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,48] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:02:10,095] WARN [Controller 0]: Partition [__consumer_offsets,48] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:02:10,095] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,6] (kafka.controller.KafkaController)
[2016-11-17 15:02:10,095] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,6] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:02:10,096] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,6] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:02:10,096] WARN [Controller 0]: Partition [__consumer_offsets,6] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:02:10,096] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,28] (kafka.controller.KafkaController)
[2016-11-17 15:02:10,096] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,28] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:02:10,097] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,28] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:02:10,098] WARN [Controller 0]: Partition [__consumer_offsets,28] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:02:10,098] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,4] (kafka.controller.KafkaController)
[2016-11-17 15:02:10,098] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,4] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:02:10,099] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,4] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:02:10,099] WARN [Controller 0]: Partition [__consumer_offsets,4] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:02:10,099] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,44] (kafka.controller.KafkaController)
[2016-11-17 15:02:10,099] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,44] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:02:10,100] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,44] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:02:10,100] WARN [Controller 0]: Partition [__consumer_offsets,44] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:02:10,100] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,42] (kafka.controller.KafkaController)
[2016-11-17 15:02:10,100] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,42] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:02:10,101] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,42] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:02:10,102] WARN [Controller 0]: Partition [__consumer_offsets,42] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:02:10,102] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,34] (kafka.controller.KafkaController)
[2016-11-17 15:02:10,102] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,34] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:02:10,103] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,34] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:02:10,103] WARN [Controller 0]: Partition [__consumer_offsets,34] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:02:10,103] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,46] (kafka.controller.KafkaController)
[2016-11-17 15:02:10,103] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,46] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:02:10,104] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,46] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:02:10,105] WARN [Controller 0]: Partition [__consumer_offsets,46] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:02:10,105] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,32] (kafka.controller.KafkaController)
[2016-11-17 15:02:10,105] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,32] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:02:10,106] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,32] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:02:10,106] WARN [Controller 0]: Partition [__consumer_offsets,32] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:02:10,106] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,36] (kafka.controller.KafkaController)
[2016-11-17 15:02:10,106] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,36] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:02:10,107] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,36] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:02:10,108] WARN [Controller 0]: Partition [__consumer_offsets,36] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:02:10,108] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,38] (kafka.controller.KafkaController)
[2016-11-17 15:02:10,108] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,38] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:02:10,109] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,38] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:02:10,109] WARN [Controller 0]: Partition [__consumer_offsets,38] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:02:10,109] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,16] (kafka.controller.KafkaController)
[2016-11-17 15:02:10,109] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,16] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:02:10,110] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,16] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:02:10,111] WARN [Controller 0]: Partition [__consumer_offsets,16] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:02:10,111] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,2] (kafka.controller.KafkaController)
[2016-11-17 15:02:10,111] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:02:10,112] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:02:10,113] WARN [Controller 0]: Partition [__consumer_offsets,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:02:10,113] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2016-11-17 15:02:10,113] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2016-11-17 15:07:09,974] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2016-11-17 15:07:09,992] DEBUG [Controller 0]: preferred replicas by broker Map(2 -> Map([__consumer_offsets,19] -> List(2, 1), [__consumer_offsets,47] -> List(2, 1), [__consumer_offsets,41] -> List(2, 1), [__consumer_offsets,29] -> List(2, 1), [topic2,1] -> List(2, 1, 0), [__consumer_offsets,39] -> List(2, 1), [__consumer_offsets,17] -> List(2, 1), [__consumer_offsets,33] -> List(2, 1), [__consumer_offsets,5] -> List(2, 1), [__consumer_offsets,21] -> List(2, 1), [__consumer_offsets,3] -> List(2, 1), [othertopic,1] -> List(2, 0, 1), [__consumer_offsets,23] -> List(2, 1), [__consumer_offsets,15] -> List(2, 1), [__consumer_offsets,11] -> List(2, 1), [__consumer_offsets,13] -> List(2, 1), [__consumer_offsets,49] -> List(2, 1), [__consumer_offsets,37] -> List(2, 1), [__consumer_offsets,31] -> List(2, 1), [topic1,0] -> List(2), [topic3,2] -> List(2), [__consumer_offsets,25] -> List(2, 1), [__consumer_offsets,45] -> List(2, 1), [__consumer_offsets,27] -> List(2, 1), [__consumer_offsets,43] -> List(2, 1), [__consumer_offsets,35] -> List(2, 1), [__consumer_offsets,7] -> List(2, 1), [__consumer_offsets,9] -> List(2, 1), [__consumer_offsets,1] -> List(2, 1)), 1 -> Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [topic3,1] -> List(1), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [topic2,0] -> List(1, 0, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2)), 0 -> Map([othertopic,2] -> List(0, 1, 2), [topic2,2] -> List(0, 2, 1), [mytopic,0] -> List(0), [topic4,0] -> List(0, 1), [topic3,0] -> List(0))) (kafka.controller.KafkaController)
[2016-11-17 15:07:09,992] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2016-11-17 15:07:09,992] TRACE [Controller 0]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2016-11-17 15:07:09,992] DEBUG [Controller 0]: topics not in preferred replica Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [topic2,0] -> List(1, 0, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2)) (kafka.controller.KafkaController)
[2016-11-17 15:07:09,992] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 0.964286 (kafka.controller.KafkaController)
[2016-11-17 15:07:09,993] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,30] (kafka.controller.KafkaController)
[2016-11-17 15:07:09,993] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,30] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:07:10,012] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,30] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:07:10,012] WARN [Controller 0]: Partition [__consumer_offsets,30] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:07:10,013] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,10] (kafka.controller.KafkaController)
[2016-11-17 15:07:10,013] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,10] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:07:10,014] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,10] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:07:10,015] WARN [Controller 0]: Partition [__consumer_offsets,10] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:07:10,015] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,14] (kafka.controller.KafkaController)
[2016-11-17 15:07:10,015] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,14] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:07:10,016] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,14] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:07:10,016] WARN [Controller 0]: Partition [__consumer_offsets,14] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:07:10,016] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,40] (kafka.controller.KafkaController)
[2016-11-17 15:07:10,016] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,40] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:07:10,018] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,40] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:07:10,018] WARN [Controller 0]: Partition [__consumer_offsets,40] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:07:10,018] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,18] (kafka.controller.KafkaController)
[2016-11-17 15:07:10,018] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,18] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:07:10,020] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,18] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:07:10,020] WARN [Controller 0]: Partition [__consumer_offsets,18] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:07:10,020] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,26] (kafka.controller.KafkaController)
[2016-11-17 15:07:10,020] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,26] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:07:10,022] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,26] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:07:10,022] WARN [Controller 0]: Partition [__consumer_offsets,26] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:07:10,022] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,0] (kafka.controller.KafkaController)
[2016-11-17 15:07:10,022] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:07:10,024] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:07:10,024] WARN [Controller 0]: Partition [__consumer_offsets,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:07:10,024] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,24] (kafka.controller.KafkaController)
[2016-11-17 15:07:10,024] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,24] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:07:10,025] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,24] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:07:10,026] WARN [Controller 0]: Partition [__consumer_offsets,24] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:07:10,026] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,0] (kafka.controller.KafkaController)
[2016-11-17 15:07:10,026] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:07:10,027] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [othertopic,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:07:10,027] WARN [Controller 0]: Partition [othertopic,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:07:10,027] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,20] (kafka.controller.KafkaController)
[2016-11-17 15:07:10,027] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,20] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:07:10,029] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,20] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:07:10,029] WARN [Controller 0]: Partition [__consumer_offsets,20] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:07:10,029] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,22] (kafka.controller.KafkaController)
[2016-11-17 15:07:10,029] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,22] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:07:10,030] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,22] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:07:10,031] WARN [Controller 0]: Partition [__consumer_offsets,22] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:07:10,031] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,12] (kafka.controller.KafkaController)
[2016-11-17 15:07:10,031] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,12] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:07:10,032] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,12] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:07:10,032] WARN [Controller 0]: Partition [__consumer_offsets,12] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:07:10,032] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic2,0] (kafka.controller.KafkaController)
[2016-11-17 15:07:10,032] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic2,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:07:10,033] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 0 for partition [topic2,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:07:10,034] WARN [Controller 0]: Partition [topic2,0] failed to complete preferred replica leader election. Leader is 0 (kafka.controller.KafkaController)
[2016-11-17 15:07:10,034] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,8] (kafka.controller.KafkaController)
[2016-11-17 15:07:10,034] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,8] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:07:10,035] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,8] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:07:10,036] WARN [Controller 0]: Partition [__consumer_offsets,8] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:07:10,036] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,48] (kafka.controller.KafkaController)
[2016-11-17 15:07:10,036] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,48] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:07:10,037] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,48] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:07:10,037] WARN [Controller 0]: Partition [__consumer_offsets,48] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:07:10,037] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,6] (kafka.controller.KafkaController)
[2016-11-17 15:07:10,037] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,6] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:07:10,038] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,6] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:07:10,039] WARN [Controller 0]: Partition [__consumer_offsets,6] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:07:10,039] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,28] (kafka.controller.KafkaController)
[2016-11-17 15:07:10,039] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,28] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:07:10,040] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,28] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:07:10,040] WARN [Controller 0]: Partition [__consumer_offsets,28] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:07:10,040] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,4] (kafka.controller.KafkaController)
[2016-11-17 15:07:10,040] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,4] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:07:10,041] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,4] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:07:10,042] WARN [Controller 0]: Partition [__consumer_offsets,4] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:07:10,042] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,44] (kafka.controller.KafkaController)
[2016-11-17 15:07:10,042] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,44] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:07:10,043] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,44] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:07:10,043] WARN [Controller 0]: Partition [__consumer_offsets,44] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:07:10,043] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,42] (kafka.controller.KafkaController)
[2016-11-17 15:07:10,043] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,42] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:07:10,044] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,42] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:07:10,045] WARN [Controller 0]: Partition [__consumer_offsets,42] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:07:10,045] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,34] (kafka.controller.KafkaController)
[2016-11-17 15:07:10,045] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,34] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:07:10,046] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,34] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:07:10,046] WARN [Controller 0]: Partition [__consumer_offsets,34] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:07:10,046] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,46] (kafka.controller.KafkaController)
[2016-11-17 15:07:10,046] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,46] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:07:10,047] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,46] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:07:10,048] WARN [Controller 0]: Partition [__consumer_offsets,46] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:07:10,048] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,32] (kafka.controller.KafkaController)
[2016-11-17 15:07:10,048] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,32] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:07:10,049] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,32] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:07:10,049] WARN [Controller 0]: Partition [__consumer_offsets,32] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:07:10,049] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,36] (kafka.controller.KafkaController)
[2016-11-17 15:07:10,049] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,36] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:07:10,051] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,36] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:07:10,051] WARN [Controller 0]: Partition [__consumer_offsets,36] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:07:10,051] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,38] (kafka.controller.KafkaController)
[2016-11-17 15:07:10,051] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,38] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:07:10,052] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,38] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:07:10,053] WARN [Controller 0]: Partition [__consumer_offsets,38] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:07:10,053] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,16] (kafka.controller.KafkaController)
[2016-11-17 15:07:10,053] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,16] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:07:10,054] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,16] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:07:10,054] WARN [Controller 0]: Partition [__consumer_offsets,16] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:07:10,054] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,2] (kafka.controller.KafkaController)
[2016-11-17 15:07:10,054] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:07:10,056] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:07:10,056] WARN [Controller 0]: Partition [__consumer_offsets,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:07:10,056] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2016-11-17 15:07:10,056] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2016-11-17 15:12:09,964] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2016-11-17 15:12:09,964] DEBUG [Controller 0]: preferred replicas by broker Map(2 -> Map([__consumer_offsets,19] -> List(2, 1), [__consumer_offsets,47] -> List(2, 1), [__consumer_offsets,41] -> List(2, 1), [__consumer_offsets,29] -> List(2, 1), [topic2,1] -> List(2, 1, 0), [__consumer_offsets,39] -> List(2, 1), [__consumer_offsets,17] -> List(2, 1), [__consumer_offsets,33] -> List(2, 1), [__consumer_offsets,5] -> List(2, 1), [__consumer_offsets,21] -> List(2, 1), [__consumer_offsets,3] -> List(2, 1), [othertopic,1] -> List(2, 0, 1), [__consumer_offsets,23] -> List(2, 1), [__consumer_offsets,15] -> List(2, 1), [__consumer_offsets,11] -> List(2, 1), [__consumer_offsets,13] -> List(2, 1), [__consumer_offsets,49] -> List(2, 1), [__consumer_offsets,37] -> List(2, 1), [__consumer_offsets,31] -> List(2, 1), [topic1,0] -> List(2), [topic3,2] -> List(2), [__consumer_offsets,25] -> List(2, 1), [__consumer_offsets,45] -> List(2, 1), [__consumer_offsets,27] -> List(2, 1), [__consumer_offsets,43] -> List(2, 1), [__consumer_offsets,35] -> List(2, 1), [__consumer_offsets,7] -> List(2, 1), [__consumer_offsets,9] -> List(2, 1), [__consumer_offsets,1] -> List(2, 1)), 1 -> Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [topic3,1] -> List(1), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [topic2,0] -> List(1, 0, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2)), 0 -> Map([othertopic,2] -> List(0, 1, 2), [topic2,2] -> List(0, 2, 1), [mytopic,0] -> List(0), [topic4,0] -> List(0, 1), [topic3,0] -> List(0))) (kafka.controller.KafkaController)
[2016-11-17 15:12:09,964] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2016-11-17 15:12:09,964] TRACE [Controller 0]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2016-11-17 15:12:09,965] DEBUG [Controller 0]: topics not in preferred replica Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [topic2,0] -> List(1, 0, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2)) (kafka.controller.KafkaController)
[2016-11-17 15:12:09,965] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 0.964286 (kafka.controller.KafkaController)
[2016-11-17 15:12:09,965] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,30] (kafka.controller.KafkaController)
[2016-11-17 15:12:09,965] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,30] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:12:09,966] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,30] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:12:09,967] WARN [Controller 0]: Partition [__consumer_offsets,30] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:12:09,967] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,10] (kafka.controller.KafkaController)
[2016-11-17 15:12:09,967] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,10] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:12:09,969] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,10] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:12:09,969] WARN [Controller 0]: Partition [__consumer_offsets,10] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:12:09,969] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,14] (kafka.controller.KafkaController)
[2016-11-17 15:12:09,969] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,14] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:12:09,971] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,14] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:12:09,971] WARN [Controller 0]: Partition [__consumer_offsets,14] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:12:09,971] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,40] (kafka.controller.KafkaController)
[2016-11-17 15:12:09,971] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,40] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:12:09,972] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,40] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:12:09,973] WARN [Controller 0]: Partition [__consumer_offsets,40] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:12:09,973] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,18] (kafka.controller.KafkaController)
[2016-11-17 15:12:09,973] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,18] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:12:09,974] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,18] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:12:09,975] WARN [Controller 0]: Partition [__consumer_offsets,18] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:12:09,975] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,26] (kafka.controller.KafkaController)
[2016-11-17 15:12:09,975] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,26] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:12:09,976] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,26] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:12:09,976] WARN [Controller 0]: Partition [__consumer_offsets,26] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:12:09,976] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,0] (kafka.controller.KafkaController)
[2016-11-17 15:12:09,976] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:12:09,978] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:12:09,978] WARN [Controller 0]: Partition [__consumer_offsets,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:12:09,978] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,24] (kafka.controller.KafkaController)
[2016-11-17 15:12:09,978] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,24] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:12:09,980] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,24] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:12:09,980] WARN [Controller 0]: Partition [__consumer_offsets,24] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:12:09,980] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,0] (kafka.controller.KafkaController)
[2016-11-17 15:12:09,980] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:12:09,982] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [othertopic,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:12:09,982] WARN [Controller 0]: Partition [othertopic,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:12:09,982] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,20] (kafka.controller.KafkaController)
[2016-11-17 15:12:09,982] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,20] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:12:09,983] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,20] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:12:09,984] WARN [Controller 0]: Partition [__consumer_offsets,20] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:12:09,984] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,22] (kafka.controller.KafkaController)
[2016-11-17 15:12:09,984] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,22] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:12:09,985] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,22] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:12:09,985] WARN [Controller 0]: Partition [__consumer_offsets,22] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:12:09,985] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,12] (kafka.controller.KafkaController)
[2016-11-17 15:12:09,985] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,12] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:12:09,986] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,12] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:12:09,987] WARN [Controller 0]: Partition [__consumer_offsets,12] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:12:09,987] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic2,0] (kafka.controller.KafkaController)
[2016-11-17 15:12:09,987] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic2,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:12:09,988] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 0 for partition [topic2,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:12:09,988] WARN [Controller 0]: Partition [topic2,0] failed to complete preferred replica leader election. Leader is 0 (kafka.controller.KafkaController)
[2016-11-17 15:12:09,988] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,8] (kafka.controller.KafkaController)
[2016-11-17 15:12:09,988] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,8] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:12:09,989] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,8] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:12:09,990] WARN [Controller 0]: Partition [__consumer_offsets,8] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:12:09,990] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,48] (kafka.controller.KafkaController)
[2016-11-17 15:12:09,990] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,48] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:12:09,991] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,48] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:12:09,991] WARN [Controller 0]: Partition [__consumer_offsets,48] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:12:09,991] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,6] (kafka.controller.KafkaController)
[2016-11-17 15:12:09,991] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,6] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:12:09,992] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,6] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:12:09,993] WARN [Controller 0]: Partition [__consumer_offsets,6] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:12:09,993] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,28] (kafka.controller.KafkaController)
[2016-11-17 15:12:09,993] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,28] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:12:09,994] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,28] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:12:09,994] WARN [Controller 0]: Partition [__consumer_offsets,28] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:12:09,994] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,4] (kafka.controller.KafkaController)
[2016-11-17 15:12:09,994] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,4] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:12:09,995] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,4] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:12:09,996] WARN [Controller 0]: Partition [__consumer_offsets,4] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:12:09,996] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,44] (kafka.controller.KafkaController)
[2016-11-17 15:12:09,996] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,44] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:12:09,997] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,44] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:12:09,998] WARN [Controller 0]: Partition [__consumer_offsets,44] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:12:09,998] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,42] (kafka.controller.KafkaController)
[2016-11-17 15:12:09,998] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,42] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:12:09,999] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,42] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:12:09,999] WARN [Controller 0]: Partition [__consumer_offsets,42] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:12:09,999] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,34] (kafka.controller.KafkaController)
[2016-11-17 15:12:09,999] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,34] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:12:10,000] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,34] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:12:10,001] WARN [Controller 0]: Partition [__consumer_offsets,34] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:12:10,001] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,46] (kafka.controller.KafkaController)
[2016-11-17 15:12:10,001] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,46] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:12:10,002] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,46] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:12:10,002] WARN [Controller 0]: Partition [__consumer_offsets,46] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:12:10,002] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,32] (kafka.controller.KafkaController)
[2016-11-17 15:12:10,002] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,32] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:12:10,003] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,32] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:12:10,004] WARN [Controller 0]: Partition [__consumer_offsets,32] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:12:10,004] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,36] (kafka.controller.KafkaController)
[2016-11-17 15:12:10,004] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,36] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:12:10,005] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,36] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:12:10,005] WARN [Controller 0]: Partition [__consumer_offsets,36] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:12:10,005] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,38] (kafka.controller.KafkaController)
[2016-11-17 15:12:10,005] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,38] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:12:10,006] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,38] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:12:10,007] WARN [Controller 0]: Partition [__consumer_offsets,38] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:12:10,007] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,16] (kafka.controller.KafkaController)
[2016-11-17 15:12:10,007] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,16] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:12:10,008] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,16] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:12:10,008] WARN [Controller 0]: Partition [__consumer_offsets,16] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:12:10,008] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,2] (kafka.controller.KafkaController)
[2016-11-17 15:12:10,008] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:12:10,010] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:12:10,010] WARN [Controller 0]: Partition [__consumer_offsets,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:12:10,010] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2016-11-17 15:12:10,010] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2016-11-17 15:17:09,953] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2016-11-17 15:17:10,005] DEBUG [Controller 0]: preferred replicas by broker Map(2 -> Map([__consumer_offsets,19] -> List(2, 1), [__consumer_offsets,47] -> List(2, 1), [__consumer_offsets,41] -> List(2, 1), [__consumer_offsets,29] -> List(2, 1), [topic2,1] -> List(2, 1, 0), [__consumer_offsets,39] -> List(2, 1), [__consumer_offsets,17] -> List(2, 1), [__consumer_offsets,33] -> List(2, 1), [__consumer_offsets,5] -> List(2, 1), [__consumer_offsets,21] -> List(2, 1), [__consumer_offsets,3] -> List(2, 1), [othertopic,1] -> List(2, 0, 1), [__consumer_offsets,23] -> List(2, 1), [__consumer_offsets,15] -> List(2, 1), [__consumer_offsets,11] -> List(2, 1), [__consumer_offsets,13] -> List(2, 1), [__consumer_offsets,49] -> List(2, 1), [__consumer_offsets,37] -> List(2, 1), [__consumer_offsets,31] -> List(2, 1), [topic1,0] -> List(2), [topic3,2] -> List(2), [__consumer_offsets,25] -> List(2, 1), [__consumer_offsets,45] -> List(2, 1), [__consumer_offsets,27] -> List(2, 1), [__consumer_offsets,43] -> List(2, 1), [__consumer_offsets,35] -> List(2, 1), [__consumer_offsets,7] -> List(2, 1), [__consumer_offsets,9] -> List(2, 1), [__consumer_offsets,1] -> List(2, 1)), 1 -> Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [topic3,1] -> List(1), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [topic2,0] -> List(1, 0, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2)), 0 -> Map([othertopic,2] -> List(0, 1, 2), [topic2,2] -> List(0, 2, 1), [mytopic,0] -> List(0), [topic4,0] -> List(0, 1), [topic3,0] -> List(0))) (kafka.controller.KafkaController)
[2016-11-17 15:17:10,005] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2016-11-17 15:17:10,005] TRACE [Controller 0]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2016-11-17 15:17:10,005] DEBUG [Controller 0]: topics not in preferred replica Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [topic2,0] -> List(1, 0, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2)) (kafka.controller.KafkaController)
[2016-11-17 15:17:10,005] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 0.964286 (kafka.controller.KafkaController)
[2016-11-17 15:17:10,005] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,30] (kafka.controller.KafkaController)
[2016-11-17 15:17:10,005] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,30] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:17:10,014] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,30] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:17:10,015] WARN [Controller 0]: Partition [__consumer_offsets,30] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:17:10,015] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,10] (kafka.controller.KafkaController)
[2016-11-17 15:17:10,015] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,10] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:17:10,016] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,10] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:17:10,017] WARN [Controller 0]: Partition [__consumer_offsets,10] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:17:10,017] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,14] (kafka.controller.KafkaController)
[2016-11-17 15:17:10,017] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,14] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:17:10,018] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,14] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:17:10,018] WARN [Controller 0]: Partition [__consumer_offsets,14] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:17:10,018] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,40] (kafka.controller.KafkaController)
[2016-11-17 15:17:10,018] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,40] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:17:10,019] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,40] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:17:10,020] WARN [Controller 0]: Partition [__consumer_offsets,40] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:17:10,020] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,18] (kafka.controller.KafkaController)
[2016-11-17 15:17:10,020] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,18] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:17:10,021] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,18] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:17:10,021] WARN [Controller 0]: Partition [__consumer_offsets,18] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:17:10,021] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,26] (kafka.controller.KafkaController)
[2016-11-17 15:17:10,021] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,26] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:17:10,023] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,26] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:17:10,023] WARN [Controller 0]: Partition [__consumer_offsets,26] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:17:10,023] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,0] (kafka.controller.KafkaController)
[2016-11-17 15:17:10,023] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:17:10,025] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:17:10,025] WARN [Controller 0]: Partition [__consumer_offsets,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:17:10,026] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,24] (kafka.controller.KafkaController)
[2016-11-17 15:17:10,026] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,24] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:17:10,027] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,24] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:17:10,027] WARN [Controller 0]: Partition [__consumer_offsets,24] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:17:10,027] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,0] (kafka.controller.KafkaController)
[2016-11-17 15:17:10,027] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:17:10,028] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [othertopic,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:17:10,029] WARN [Controller 0]: Partition [othertopic,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:17:10,029] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,20] (kafka.controller.KafkaController)
[2016-11-17 15:17:10,029] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,20] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:17:10,030] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,20] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:17:10,030] WARN [Controller 0]: Partition [__consumer_offsets,20] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:17:10,030] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,22] (kafka.controller.KafkaController)
[2016-11-17 15:17:10,030] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,22] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:17:10,031] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,22] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:17:10,032] WARN [Controller 0]: Partition [__consumer_offsets,22] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:17:10,032] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,12] (kafka.controller.KafkaController)
[2016-11-17 15:17:10,032] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,12] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:17:10,033] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,12] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:17:10,033] WARN [Controller 0]: Partition [__consumer_offsets,12] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:17:10,033] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic2,0] (kafka.controller.KafkaController)
[2016-11-17 15:17:10,033] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic2,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:17:10,034] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 0 for partition [topic2,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:17:10,035] WARN [Controller 0]: Partition [topic2,0] failed to complete preferred replica leader election. Leader is 0 (kafka.controller.KafkaController)
[2016-11-17 15:17:10,035] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,8] (kafka.controller.KafkaController)
[2016-11-17 15:17:10,035] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,8] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:17:10,036] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,8] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:17:10,036] WARN [Controller 0]: Partition [__consumer_offsets,8] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:17:10,036] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,48] (kafka.controller.KafkaController)
[2016-11-17 15:17:10,036] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,48] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:17:10,037] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,48] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:17:10,037] WARN [Controller 0]: Partition [__consumer_offsets,48] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:17:10,037] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,6] (kafka.controller.KafkaController)
[2016-11-17 15:17:10,037] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,6] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:17:10,038] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,6] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:17:10,039] WARN [Controller 0]: Partition [__consumer_offsets,6] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:17:10,039] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,28] (kafka.controller.KafkaController)
[2016-11-17 15:17:10,039] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,28] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:17:10,040] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,28] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:17:10,041] WARN [Controller 0]: Partition [__consumer_offsets,28] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:17:10,041] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,4] (kafka.controller.KafkaController)
[2016-11-17 15:17:10,041] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,4] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:17:10,042] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,4] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:17:10,042] WARN [Controller 0]: Partition [__consumer_offsets,4] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:17:10,042] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,44] (kafka.controller.KafkaController)
[2016-11-17 15:17:10,042] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,44] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:17:10,043] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,44] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:17:10,044] WARN [Controller 0]: Partition [__consumer_offsets,44] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:17:10,044] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,42] (kafka.controller.KafkaController)
[2016-11-17 15:17:10,044] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,42] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:17:10,045] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,42] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:17:10,045] WARN [Controller 0]: Partition [__consumer_offsets,42] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:17:10,045] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,34] (kafka.controller.KafkaController)
[2016-11-17 15:17:10,045] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,34] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:17:10,046] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,34] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:17:10,047] WARN [Controller 0]: Partition [__consumer_offsets,34] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:17:10,047] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,46] (kafka.controller.KafkaController)
[2016-11-17 15:17:10,047] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,46] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:17:10,048] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,46] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:17:10,048] WARN [Controller 0]: Partition [__consumer_offsets,46] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:17:10,048] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,32] (kafka.controller.KafkaController)
[2016-11-17 15:17:10,048] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,32] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:17:10,049] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,32] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:17:10,049] WARN [Controller 0]: Partition [__consumer_offsets,32] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:17:10,049] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,36] (kafka.controller.KafkaController)
[2016-11-17 15:17:10,049] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,36] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:17:10,050] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,36] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:17:10,051] WARN [Controller 0]: Partition [__consumer_offsets,36] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:17:10,051] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,38] (kafka.controller.KafkaController)
[2016-11-17 15:17:10,051] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,38] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:17:10,052] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,38] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:17:10,052] WARN [Controller 0]: Partition [__consumer_offsets,38] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:17:10,052] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,16] (kafka.controller.KafkaController)
[2016-11-17 15:17:10,052] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,16] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:17:10,053] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,16] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:17:10,054] WARN [Controller 0]: Partition [__consumer_offsets,16] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:17:10,054] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,2] (kafka.controller.KafkaController)
[2016-11-17 15:17:10,054] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:17:10,055] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:17:10,055] WARN [Controller 0]: Partition [__consumer_offsets,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:17:10,055] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2016-11-17 15:17:10,055] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2016-11-17 15:22:09,942] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2016-11-17 15:22:09,967] DEBUG [Controller 0]: preferred replicas by broker Map(2 -> Map([__consumer_offsets,19] -> List(2, 1), [__consumer_offsets,47] -> List(2, 1), [__consumer_offsets,41] -> List(2, 1), [__consumer_offsets,29] -> List(2, 1), [topic2,1] -> List(2, 1, 0), [__consumer_offsets,39] -> List(2, 1), [__consumer_offsets,17] -> List(2, 1), [__consumer_offsets,33] -> List(2, 1), [__consumer_offsets,5] -> List(2, 1), [__consumer_offsets,21] -> List(2, 1), [__consumer_offsets,3] -> List(2, 1), [othertopic,1] -> List(2, 0, 1), [__consumer_offsets,23] -> List(2, 1), [__consumer_offsets,15] -> List(2, 1), [__consumer_offsets,11] -> List(2, 1), [__consumer_offsets,13] -> List(2, 1), [__consumer_offsets,49] -> List(2, 1), [__consumer_offsets,37] -> List(2, 1), [__consumer_offsets,31] -> List(2, 1), [topic1,0] -> List(2), [topic3,2] -> List(2), [__consumer_offsets,25] -> List(2, 1), [__consumer_offsets,45] -> List(2, 1), [__consumer_offsets,27] -> List(2, 1), [__consumer_offsets,43] -> List(2, 1), [__consumer_offsets,35] -> List(2, 1), [__consumer_offsets,7] -> List(2, 1), [__consumer_offsets,9] -> List(2, 1), [__consumer_offsets,1] -> List(2, 1)), 1 -> Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [topic3,1] -> List(1), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [topic2,0] -> List(1, 0, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2)), 0 -> Map([othertopic,2] -> List(0, 1, 2), [topic2,2] -> List(0, 2, 1), [mytopic,0] -> List(0), [topic4,0] -> List(0, 1), [topic3,0] -> List(0))) (kafka.controller.KafkaController)
[2016-11-17 15:22:09,967] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2016-11-17 15:22:09,967] TRACE [Controller 0]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2016-11-17 15:22:09,967] DEBUG [Controller 0]: topics not in preferred replica Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [topic2,0] -> List(1, 0, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2)) (kafka.controller.KafkaController)
[2016-11-17 15:22:09,967] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 0.964286 (kafka.controller.KafkaController)
[2016-11-17 15:22:09,967] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,30] (kafka.controller.KafkaController)
[2016-11-17 15:22:09,967] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,30] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:22:09,980] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,30] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:22:09,981] WARN [Controller 0]: Partition [__consumer_offsets,30] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:22:09,981] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,10] (kafka.controller.KafkaController)
[2016-11-17 15:22:09,981] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,10] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:22:09,983] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,10] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:22:09,983] WARN [Controller 0]: Partition [__consumer_offsets,10] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:22:09,983] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,14] (kafka.controller.KafkaController)
[2016-11-17 15:22:09,983] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,14] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:22:09,985] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,14] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:22:09,985] WARN [Controller 0]: Partition [__consumer_offsets,14] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:22:09,985] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,40] (kafka.controller.KafkaController)
[2016-11-17 15:22:09,985] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,40] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:22:09,986] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,40] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:22:09,987] WARN [Controller 0]: Partition [__consumer_offsets,40] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:22:09,987] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,18] (kafka.controller.KafkaController)
[2016-11-17 15:22:09,987] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,18] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:22:09,988] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,18] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:22:09,989] WARN [Controller 0]: Partition [__consumer_offsets,18] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:22:09,989] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,26] (kafka.controller.KafkaController)
[2016-11-17 15:22:09,989] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,26] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:22:09,991] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,26] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:22:09,991] WARN [Controller 0]: Partition [__consumer_offsets,26] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:22:09,991] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,0] (kafka.controller.KafkaController)
[2016-11-17 15:22:09,991] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:22:09,992] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:22:09,993] WARN [Controller 0]: Partition [__consumer_offsets,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:22:09,993] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,24] (kafka.controller.KafkaController)
[2016-11-17 15:22:09,993] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,24] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:22:09,994] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,24] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:22:09,995] WARN [Controller 0]: Partition [__consumer_offsets,24] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:22:09,995] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,0] (kafka.controller.KafkaController)
[2016-11-17 15:22:09,995] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:22:09,996] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [othertopic,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:22:09,996] WARN [Controller 0]: Partition [othertopic,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:22:09,996] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,20] (kafka.controller.KafkaController)
[2016-11-17 15:22:09,996] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,20] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:22:09,997] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,20] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:22:09,997] WARN [Controller 0]: Partition [__consumer_offsets,20] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:22:09,998] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,22] (kafka.controller.KafkaController)
[2016-11-17 15:22:09,998] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,22] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:22:09,999] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,22] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:22:09,999] WARN [Controller 0]: Partition [__consumer_offsets,22] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:22:09,999] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,12] (kafka.controller.KafkaController)
[2016-11-17 15:22:09,999] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,12] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:22:10,000] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,12] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:22:10,000] WARN [Controller 0]: Partition [__consumer_offsets,12] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:22:10,000] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic2,0] (kafka.controller.KafkaController)
[2016-11-17 15:22:10,000] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic2,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:22:10,002] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 0 for partition [topic2,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:22:10,002] WARN [Controller 0]: Partition [topic2,0] failed to complete preferred replica leader election. Leader is 0 (kafka.controller.KafkaController)
[2016-11-17 15:22:10,002] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,8] (kafka.controller.KafkaController)
[2016-11-17 15:22:10,002] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,8] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:22:10,003] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,8] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:22:10,004] WARN [Controller 0]: Partition [__consumer_offsets,8] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:22:10,004] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,48] (kafka.controller.KafkaController)
[2016-11-17 15:22:10,004] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,48] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:22:10,005] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,48] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:22:10,006] WARN [Controller 0]: Partition [__consumer_offsets,48] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:22:10,006] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,6] (kafka.controller.KafkaController)
[2016-11-17 15:22:10,006] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,6] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:22:10,007] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,6] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:22:10,007] WARN [Controller 0]: Partition [__consumer_offsets,6] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:22:10,007] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,28] (kafka.controller.KafkaController)
[2016-11-17 15:22:10,007] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,28] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:22:10,008] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,28] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:22:10,008] WARN [Controller 0]: Partition [__consumer_offsets,28] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:22:10,008] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,4] (kafka.controller.KafkaController)
[2016-11-17 15:22:10,008] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,4] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:22:10,009] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,4] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:22:10,010] WARN [Controller 0]: Partition [__consumer_offsets,4] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:22:10,010] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,44] (kafka.controller.KafkaController)
[2016-11-17 15:22:10,010] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,44] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:22:10,011] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,44] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:22:10,011] WARN [Controller 0]: Partition [__consumer_offsets,44] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:22:10,011] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,42] (kafka.controller.KafkaController)
[2016-11-17 15:22:10,011] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,42] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:22:10,012] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,42] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:22:10,013] WARN [Controller 0]: Partition [__consumer_offsets,42] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:22:10,013] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,34] (kafka.controller.KafkaController)
[2016-11-17 15:22:10,013] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,34] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:22:10,014] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,34] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:22:10,014] WARN [Controller 0]: Partition [__consumer_offsets,34] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:22:10,014] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,46] (kafka.controller.KafkaController)
[2016-11-17 15:22:10,014] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,46] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:22:10,015] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,46] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:22:10,016] WARN [Controller 0]: Partition [__consumer_offsets,46] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:22:10,016] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,32] (kafka.controller.KafkaController)
[2016-11-17 15:22:10,016] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,32] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:22:10,017] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,32] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:22:10,017] WARN [Controller 0]: Partition [__consumer_offsets,32] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:22:10,017] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,36] (kafka.controller.KafkaController)
[2016-11-17 15:22:10,017] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,36] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:22:10,018] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,36] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:22:10,018] WARN [Controller 0]: Partition [__consumer_offsets,36] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:22:10,019] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,38] (kafka.controller.KafkaController)
[2016-11-17 15:22:10,019] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,38] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:22:10,019] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,38] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:22:10,020] WARN [Controller 0]: Partition [__consumer_offsets,38] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:22:10,020] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,16] (kafka.controller.KafkaController)
[2016-11-17 15:22:10,020] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,16] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:22:10,021] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,16] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:22:10,021] WARN [Controller 0]: Partition [__consumer_offsets,16] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:22:10,021] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,2] (kafka.controller.KafkaController)
[2016-11-17 15:22:10,021] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:22:10,022] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:22:10,023] WARN [Controller 0]: Partition [__consumer_offsets,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:22:10,023] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2016-11-17 15:22:10,023] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2016-11-17 15:27:09,925] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2016-11-17 15:27:09,926] DEBUG [Controller 0]: preferred replicas by broker Map(2 -> Map([__consumer_offsets,19] -> List(2, 1), [__consumer_offsets,47] -> List(2, 1), [__consumer_offsets,41] -> List(2, 1), [__consumer_offsets,29] -> List(2, 1), [topic2,1] -> List(2, 1, 0), [__consumer_offsets,39] -> List(2, 1), [__consumer_offsets,17] -> List(2, 1), [__consumer_offsets,33] -> List(2, 1), [__consumer_offsets,5] -> List(2, 1), [__consumer_offsets,21] -> List(2, 1), [__consumer_offsets,3] -> List(2, 1), [othertopic,1] -> List(2, 0, 1), [__consumer_offsets,23] -> List(2, 1), [__consumer_offsets,15] -> List(2, 1), [__consumer_offsets,11] -> List(2, 1), [__consumer_offsets,13] -> List(2, 1), [__consumer_offsets,49] -> List(2, 1), [__consumer_offsets,37] -> List(2, 1), [__consumer_offsets,31] -> List(2, 1), [topic1,0] -> List(2), [topic3,2] -> List(2), [__consumer_offsets,25] -> List(2, 1), [__consumer_offsets,45] -> List(2, 1), [__consumer_offsets,27] -> List(2, 1), [__consumer_offsets,43] -> List(2, 1), [__consumer_offsets,35] -> List(2, 1), [__consumer_offsets,7] -> List(2, 1), [__consumer_offsets,9] -> List(2, 1), [__consumer_offsets,1] -> List(2, 1)), 1 -> Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [topic3,1] -> List(1), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [topic2,0] -> List(1, 0, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2)), 0 -> Map([othertopic,2] -> List(0, 1, 2), [topic2,2] -> List(0, 2, 1), [mytopic,0] -> List(0), [topic4,0] -> List(0, 1), [topic3,0] -> List(0))) (kafka.controller.KafkaController)
[2016-11-17 15:27:09,926] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2016-11-17 15:27:09,926] TRACE [Controller 0]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2016-11-17 15:27:09,926] DEBUG [Controller 0]: topics not in preferred replica Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [topic2,0] -> List(1, 0, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2)) (kafka.controller.KafkaController)
[2016-11-17 15:27:09,926] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 0.964286 (kafka.controller.KafkaController)
[2016-11-17 15:27:09,926] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,30] (kafka.controller.KafkaController)
[2016-11-17 15:27:09,926] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,30] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:27:09,928] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,30] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:27:09,928] WARN [Controller 0]: Partition [__consumer_offsets,30] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:27:09,928] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,10] (kafka.controller.KafkaController)
[2016-11-17 15:27:09,928] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,10] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:27:09,930] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,10] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:27:09,930] WARN [Controller 0]: Partition [__consumer_offsets,10] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:27:09,930] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,14] (kafka.controller.KafkaController)
[2016-11-17 15:27:09,930] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,14] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:27:09,931] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,14] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:27:09,932] WARN [Controller 0]: Partition [__consumer_offsets,14] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:27:09,932] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,40] (kafka.controller.KafkaController)
[2016-11-17 15:27:09,932] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,40] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:27:09,933] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,40] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:27:09,934] WARN [Controller 0]: Partition [__consumer_offsets,40] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:27:09,934] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,18] (kafka.controller.KafkaController)
[2016-11-17 15:27:09,934] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,18] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:27:09,935] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,18] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:27:09,935] WARN [Controller 0]: Partition [__consumer_offsets,18] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:27:09,935] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,26] (kafka.controller.KafkaController)
[2016-11-17 15:27:09,935] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,26] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:27:09,936] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,26] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:27:09,937] WARN [Controller 0]: Partition [__consumer_offsets,26] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:27:09,937] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,0] (kafka.controller.KafkaController)
[2016-11-17 15:27:09,937] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:27:09,938] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:27:09,938] WARN [Controller 0]: Partition [__consumer_offsets,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:27:09,938] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,24] (kafka.controller.KafkaController)
[2016-11-17 15:27:09,938] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,24] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:27:09,940] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,24] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:27:09,940] WARN [Controller 0]: Partition [__consumer_offsets,24] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:27:09,940] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,0] (kafka.controller.KafkaController)
[2016-11-17 15:27:09,940] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:27:09,942] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [othertopic,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:27:09,942] WARN [Controller 0]: Partition [othertopic,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:27:09,942] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,20] (kafka.controller.KafkaController)
[2016-11-17 15:27:09,942] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,20] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:27:09,943] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,20] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:27:09,944] WARN [Controller 0]: Partition [__consumer_offsets,20] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:27:09,944] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,22] (kafka.controller.KafkaController)
[2016-11-17 15:27:09,944] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,22] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:27:09,945] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,22] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:27:09,945] WARN [Controller 0]: Partition [__consumer_offsets,22] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:27:09,945] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,12] (kafka.controller.KafkaController)
[2016-11-17 15:27:09,945] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,12] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:27:09,947] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,12] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:27:09,947] WARN [Controller 0]: Partition [__consumer_offsets,12] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:27:09,947] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic2,0] (kafka.controller.KafkaController)
[2016-11-17 15:27:09,947] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic2,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:27:09,948] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 0 for partition [topic2,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:27:09,949] WARN [Controller 0]: Partition [topic2,0] failed to complete preferred replica leader election. Leader is 0 (kafka.controller.KafkaController)
[2016-11-17 15:27:09,949] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,8] (kafka.controller.KafkaController)
[2016-11-17 15:27:09,949] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,8] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:27:09,950] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,8] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:27:09,950] WARN [Controller 0]: Partition [__consumer_offsets,8] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:27:09,950] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,48] (kafka.controller.KafkaController)
[2016-11-17 15:27:09,950] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,48] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:27:09,951] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,48] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:27:09,951] WARN [Controller 0]: Partition [__consumer_offsets,48] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:27:09,951] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,6] (kafka.controller.KafkaController)
[2016-11-17 15:27:09,951] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,6] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:27:09,952] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,6] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:27:09,953] WARN [Controller 0]: Partition [__consumer_offsets,6] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:27:09,953] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,28] (kafka.controller.KafkaController)
[2016-11-17 15:27:09,953] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,28] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:27:09,954] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,28] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:27:09,954] WARN [Controller 0]: Partition [__consumer_offsets,28] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:27:09,954] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,4] (kafka.controller.KafkaController)
[2016-11-17 15:27:09,954] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,4] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:27:09,955] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,4] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:27:09,956] WARN [Controller 0]: Partition [__consumer_offsets,4] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:27:09,956] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,44] (kafka.controller.KafkaController)
[2016-11-17 15:27:09,956] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,44] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:27:09,957] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,44] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:27:09,957] WARN [Controller 0]: Partition [__consumer_offsets,44] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:27:09,957] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,42] (kafka.controller.KafkaController)
[2016-11-17 15:27:09,957] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,42] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:27:09,959] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,42] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:27:09,959] WARN [Controller 0]: Partition [__consumer_offsets,42] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:27:09,959] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,34] (kafka.controller.KafkaController)
[2016-11-17 15:27:09,959] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,34] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:27:09,960] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,34] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:27:09,961] WARN [Controller 0]: Partition [__consumer_offsets,34] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:27:09,961] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,46] (kafka.controller.KafkaController)
[2016-11-17 15:27:09,961] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,46] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:27:09,962] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,46] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:27:09,962] WARN [Controller 0]: Partition [__consumer_offsets,46] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:27:09,962] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,32] (kafka.controller.KafkaController)
[2016-11-17 15:27:09,962] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,32] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:27:09,963] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,32] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:27:09,964] WARN [Controller 0]: Partition [__consumer_offsets,32] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:27:09,964] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,36] (kafka.controller.KafkaController)
[2016-11-17 15:27:09,964] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,36] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:27:09,965] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,36] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:27:09,965] WARN [Controller 0]: Partition [__consumer_offsets,36] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:27:09,965] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,38] (kafka.controller.KafkaController)
[2016-11-17 15:27:09,965] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,38] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:27:09,966] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,38] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:27:09,967] WARN [Controller 0]: Partition [__consumer_offsets,38] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:27:09,967] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,16] (kafka.controller.KafkaController)
[2016-11-17 15:27:09,967] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,16] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:27:09,968] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,16] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:27:09,968] WARN [Controller 0]: Partition [__consumer_offsets,16] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:27:09,968] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,2] (kafka.controller.KafkaController)
[2016-11-17 15:27:09,968] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:27:09,969] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:27:09,969] WARN [Controller 0]: Partition [__consumer_offsets,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:27:09,969] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2016-11-17 15:27:09,969] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2016-11-17 15:32:09,914] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2016-11-17 15:32:09,915] DEBUG [Controller 0]: preferred replicas by broker Map(2 -> Map([__consumer_offsets,19] -> List(2, 1), [__consumer_offsets,47] -> List(2, 1), [__consumer_offsets,41] -> List(2, 1), [__consumer_offsets,29] -> List(2, 1), [topic2,1] -> List(2, 1, 0), [__consumer_offsets,39] -> List(2, 1), [__consumer_offsets,17] -> List(2, 1), [__consumer_offsets,33] -> List(2, 1), [__consumer_offsets,5] -> List(2, 1), [__consumer_offsets,21] -> List(2, 1), [__consumer_offsets,3] -> List(2, 1), [othertopic,1] -> List(2, 0, 1), [__consumer_offsets,23] -> List(2, 1), [__consumer_offsets,15] -> List(2, 1), [__consumer_offsets,11] -> List(2, 1), [__consumer_offsets,13] -> List(2, 1), [__consumer_offsets,49] -> List(2, 1), [__consumer_offsets,37] -> List(2, 1), [__consumer_offsets,31] -> List(2, 1), [topic1,0] -> List(2), [topic3,2] -> List(2), [__consumer_offsets,25] -> List(2, 1), [__consumer_offsets,45] -> List(2, 1), [__consumer_offsets,27] -> List(2, 1), [__consumer_offsets,43] -> List(2, 1), [__consumer_offsets,35] -> List(2, 1), [__consumer_offsets,7] -> List(2, 1), [__consumer_offsets,9] -> List(2, 1), [__consumer_offsets,1] -> List(2, 1)), 1 -> Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [topic3,1] -> List(1), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [topic2,0] -> List(1, 0, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2)), 0 -> Map([othertopic,2] -> List(0, 1, 2), [topic2,2] -> List(0, 2, 1), [mytopic,0] -> List(0), [topic4,0] -> List(0, 1), [topic3,0] -> List(0))) (kafka.controller.KafkaController)
[2016-11-17 15:32:09,915] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2016-11-17 15:32:09,915] TRACE [Controller 0]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2016-11-17 15:32:09,915] DEBUG [Controller 0]: topics not in preferred replica Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [topic2,0] -> List(1, 0, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2)) (kafka.controller.KafkaController)
[2016-11-17 15:32:09,915] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 0.964286 (kafka.controller.KafkaController)
[2016-11-17 15:32:09,915] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,30] (kafka.controller.KafkaController)
[2016-11-17 15:32:09,915] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,30] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:32:09,917] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,30] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:32:09,917] WARN [Controller 0]: Partition [__consumer_offsets,30] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:32:09,917] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,10] (kafka.controller.KafkaController)
[2016-11-17 15:32:09,917] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,10] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:32:09,918] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,10] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:32:09,919] WARN [Controller 0]: Partition [__consumer_offsets,10] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:32:09,919] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,14] (kafka.controller.KafkaController)
[2016-11-17 15:32:09,919] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,14] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:32:09,920] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,14] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:32:09,921] WARN [Controller 0]: Partition [__consumer_offsets,14] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:32:09,921] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,40] (kafka.controller.KafkaController)
[2016-11-17 15:32:09,921] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,40] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:32:09,922] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,40] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:32:09,922] WARN [Controller 0]: Partition [__consumer_offsets,40] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:32:09,922] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,18] (kafka.controller.KafkaController)
[2016-11-17 15:32:09,922] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,18] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:32:09,923] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,18] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:32:09,924] WARN [Controller 0]: Partition [__consumer_offsets,18] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:32:09,924] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,26] (kafka.controller.KafkaController)
[2016-11-17 15:32:09,924] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,26] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:32:09,925] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,26] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:32:09,925] WARN [Controller 0]: Partition [__consumer_offsets,26] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:32:09,925] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,0] (kafka.controller.KafkaController)
[2016-11-17 15:32:09,925] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:32:09,926] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:32:09,927] WARN [Controller 0]: Partition [__consumer_offsets,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:32:09,927] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,24] (kafka.controller.KafkaController)
[2016-11-17 15:32:09,927] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,24] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:32:09,928] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,24] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:32:09,928] WARN [Controller 0]: Partition [__consumer_offsets,24] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:32:09,928] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,0] (kafka.controller.KafkaController)
[2016-11-17 15:32:09,928] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:32:09,929] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [othertopic,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:32:09,930] WARN [Controller 0]: Partition [othertopic,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:32:09,930] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,20] (kafka.controller.KafkaController)
[2016-11-17 15:32:09,930] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,20] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:32:09,931] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,20] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:32:09,931] WARN [Controller 0]: Partition [__consumer_offsets,20] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:32:09,931] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,22] (kafka.controller.KafkaController)
[2016-11-17 15:32:09,931] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,22] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:32:09,932] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,22] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:32:09,933] WARN [Controller 0]: Partition [__consumer_offsets,22] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:32:09,933] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,12] (kafka.controller.KafkaController)
[2016-11-17 15:32:09,933] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,12] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:32:09,934] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,12] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:32:09,934] WARN [Controller 0]: Partition [__consumer_offsets,12] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:32:09,934] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic2,0] (kafka.controller.KafkaController)
[2016-11-17 15:32:09,935] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic2,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:32:09,936] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 0 for partition [topic2,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:32:09,936] WARN [Controller 0]: Partition [topic2,0] failed to complete preferred replica leader election. Leader is 0 (kafka.controller.KafkaController)
[2016-11-17 15:32:09,936] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,8] (kafka.controller.KafkaController)
[2016-11-17 15:32:09,936] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,8] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:32:09,937] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,8] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:32:09,937] WARN [Controller 0]: Partition [__consumer_offsets,8] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:32:09,937] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,48] (kafka.controller.KafkaController)
[2016-11-17 15:32:09,937] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,48] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:32:09,938] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,48] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:32:09,939] WARN [Controller 0]: Partition [__consumer_offsets,48] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:32:09,939] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,6] (kafka.controller.KafkaController)
[2016-11-17 15:32:09,939] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,6] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:32:09,940] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,6] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:32:09,940] WARN [Controller 0]: Partition [__consumer_offsets,6] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:32:09,940] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,28] (kafka.controller.KafkaController)
[2016-11-17 15:32:09,940] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,28] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:32:09,941] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,28] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:32:09,941] WARN [Controller 0]: Partition [__consumer_offsets,28] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:32:09,941] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,4] (kafka.controller.KafkaController)
[2016-11-17 15:32:09,942] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,4] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:32:09,942] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,4] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:32:09,943] WARN [Controller 0]: Partition [__consumer_offsets,4] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:32:09,943] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,44] (kafka.controller.KafkaController)
[2016-11-17 15:32:09,943] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,44] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:32:09,944] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,44] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:32:09,944] WARN [Controller 0]: Partition [__consumer_offsets,44] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:32:09,944] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,42] (kafka.controller.KafkaController)
[2016-11-17 15:32:09,944] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,42] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:32:09,945] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,42] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:32:09,946] WARN [Controller 0]: Partition [__consumer_offsets,42] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:32:09,946] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,34] (kafka.controller.KafkaController)
[2016-11-17 15:32:09,946] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,34] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:32:09,947] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,34] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:32:09,947] WARN [Controller 0]: Partition [__consumer_offsets,34] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:32:09,947] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,46] (kafka.controller.KafkaController)
[2016-11-17 15:32:09,947] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,46] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:32:09,948] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,46] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:32:09,948] WARN [Controller 0]: Partition [__consumer_offsets,46] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:32:09,948] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,32] (kafka.controller.KafkaController)
[2016-11-17 15:32:09,948] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,32] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:32:09,949] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,32] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:32:09,950] WARN [Controller 0]: Partition [__consumer_offsets,32] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:32:09,950] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,36] (kafka.controller.KafkaController)
[2016-11-17 15:32:09,950] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,36] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:32:09,951] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,36] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:32:09,951] WARN [Controller 0]: Partition [__consumer_offsets,36] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:32:09,951] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,38] (kafka.controller.KafkaController)
[2016-11-17 15:32:09,951] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,38] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:32:09,952] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,38] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:32:09,953] WARN [Controller 0]: Partition [__consumer_offsets,38] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:32:09,953] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,16] (kafka.controller.KafkaController)
[2016-11-17 15:32:09,953] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,16] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:32:09,954] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,16] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:32:09,954] WARN [Controller 0]: Partition [__consumer_offsets,16] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:32:09,954] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,2] (kafka.controller.KafkaController)
[2016-11-17 15:32:09,954] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:32:09,955] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:32:09,955] WARN [Controller 0]: Partition [__consumer_offsets,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:32:09,955] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2016-11-17 15:32:09,956] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2016-11-17 15:37:09,903] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2016-11-17 15:37:09,940] DEBUG [Controller 0]: preferred replicas by broker Map(2 -> Map([__consumer_offsets,19] -> List(2, 1), [__consumer_offsets,47] -> List(2, 1), [__consumer_offsets,41] -> List(2, 1), [__consumer_offsets,29] -> List(2, 1), [topic2,1] -> List(2, 1, 0), [__consumer_offsets,39] -> List(2, 1), [__consumer_offsets,17] -> List(2, 1), [__consumer_offsets,33] -> List(2, 1), [__consumer_offsets,5] -> List(2, 1), [__consumer_offsets,21] -> List(2, 1), [__consumer_offsets,3] -> List(2, 1), [othertopic,1] -> List(2, 0, 1), [__consumer_offsets,23] -> List(2, 1), [__consumer_offsets,15] -> List(2, 1), [__consumer_offsets,11] -> List(2, 1), [__consumer_offsets,13] -> List(2, 1), [__consumer_offsets,49] -> List(2, 1), [__consumer_offsets,37] -> List(2, 1), [__consumer_offsets,31] -> List(2, 1), [topic1,0] -> List(2), [topic3,2] -> List(2), [__consumer_offsets,25] -> List(2, 1), [__consumer_offsets,45] -> List(2, 1), [__consumer_offsets,27] -> List(2, 1), [__consumer_offsets,43] -> List(2, 1), [__consumer_offsets,35] -> List(2, 1), [__consumer_offsets,7] -> List(2, 1), [__consumer_offsets,9] -> List(2, 1), [__consumer_offsets,1] -> List(2, 1)), 1 -> Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [topic3,1] -> List(1), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [topic2,0] -> List(1, 0, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2)), 0 -> Map([othertopic,2] -> List(0, 1, 2), [topic2,2] -> List(0, 2, 1), [mytopic,0] -> List(0), [topic4,0] -> List(0, 1), [topic3,0] -> List(0))) (kafka.controller.KafkaController)
[2016-11-17 15:37:09,940] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2016-11-17 15:37:09,940] TRACE [Controller 0]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2016-11-17 15:37:09,941] DEBUG [Controller 0]: topics not in preferred replica Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [topic2,0] -> List(1, 0, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2)) (kafka.controller.KafkaController)
[2016-11-17 15:37:09,941] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 0.964286 (kafka.controller.KafkaController)
[2016-11-17 15:37:09,941] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,30] (kafka.controller.KafkaController)
[2016-11-17 15:37:09,941] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,30] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:37:09,953] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,30] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:37:09,953] WARN [Controller 0]: Partition [__consumer_offsets,30] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:37:09,954] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,10] (kafka.controller.KafkaController)
[2016-11-17 15:37:09,954] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,10] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:37:09,955] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,10] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:37:09,955] WARN [Controller 0]: Partition [__consumer_offsets,10] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:37:09,955] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,14] (kafka.controller.KafkaController)
[2016-11-17 15:37:09,955] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,14] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:37:09,956] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,14] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:37:09,957] WARN [Controller 0]: Partition [__consumer_offsets,14] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:37:09,957] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,40] (kafka.controller.KafkaController)
[2016-11-17 15:37:09,957] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,40] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:37:09,958] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,40] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:37:09,958] WARN [Controller 0]: Partition [__consumer_offsets,40] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:37:09,958] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,18] (kafka.controller.KafkaController)
[2016-11-17 15:37:09,958] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,18] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:37:09,959] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,18] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:37:09,960] WARN [Controller 0]: Partition [__consumer_offsets,18] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:37:09,960] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,26] (kafka.controller.KafkaController)
[2016-11-17 15:37:09,960] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,26] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:37:09,961] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,26] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:37:09,962] WARN [Controller 0]: Partition [__consumer_offsets,26] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:37:09,962] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,0] (kafka.controller.KafkaController)
[2016-11-17 15:37:09,962] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:37:09,963] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:37:09,963] WARN [Controller 0]: Partition [__consumer_offsets,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:37:09,963] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,24] (kafka.controller.KafkaController)
[2016-11-17 15:37:09,963] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,24] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:37:09,964] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,24] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:37:09,965] WARN [Controller 0]: Partition [__consumer_offsets,24] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:37:09,965] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,0] (kafka.controller.KafkaController)
[2016-11-17 15:37:09,965] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:37:09,966] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [othertopic,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:37:09,966] WARN [Controller 0]: Partition [othertopic,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:37:09,966] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,20] (kafka.controller.KafkaController)
[2016-11-17 15:37:09,966] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,20] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:37:09,967] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,20] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:37:09,968] WARN [Controller 0]: Partition [__consumer_offsets,20] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:37:09,968] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,22] (kafka.controller.KafkaController)
[2016-11-17 15:37:09,968] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,22] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:37:09,968] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,22] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:37:09,969] WARN [Controller 0]: Partition [__consumer_offsets,22] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:37:09,969] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,12] (kafka.controller.KafkaController)
[2016-11-17 15:37:09,969] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,12] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:37:09,970] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,12] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:37:09,970] WARN [Controller 0]: Partition [__consumer_offsets,12] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:37:09,970] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic2,0] (kafka.controller.KafkaController)
[2016-11-17 15:37:09,970] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic2,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:37:09,971] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 0 for partition [topic2,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:37:09,972] WARN [Controller 0]: Partition [topic2,0] failed to complete preferred replica leader election. Leader is 0 (kafka.controller.KafkaController)
[2016-11-17 15:37:09,972] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,8] (kafka.controller.KafkaController)
[2016-11-17 15:37:09,972] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,8] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:37:09,973] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,8] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:37:09,973] WARN [Controller 0]: Partition [__consumer_offsets,8] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:37:09,973] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,48] (kafka.controller.KafkaController)
[2016-11-17 15:37:09,973] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,48] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:37:09,974] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,48] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:37:09,975] WARN [Controller 0]: Partition [__consumer_offsets,48] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:37:09,975] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,6] (kafka.controller.KafkaController)
[2016-11-17 15:37:09,975] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,6] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:37:10,002] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,6] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:37:10,003] WARN [Controller 0]: Partition [__consumer_offsets,6] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:37:10,003] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,28] (kafka.controller.KafkaController)
[2016-11-17 15:37:10,003] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,28] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:37:10,004] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,28] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:37:10,005] WARN [Controller 0]: Partition [__consumer_offsets,28] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:37:10,005] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,4] (kafka.controller.KafkaController)
[2016-11-17 15:37:10,005] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,4] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:37:10,006] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,4] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:37:10,007] WARN [Controller 0]: Partition [__consumer_offsets,4] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:37:10,007] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,44] (kafka.controller.KafkaController)
[2016-11-17 15:37:10,007] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,44] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:37:10,008] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,44] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:37:10,008] WARN [Controller 0]: Partition [__consumer_offsets,44] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:37:10,008] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,42] (kafka.controller.KafkaController)
[2016-11-17 15:37:10,008] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,42] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:37:10,009] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,42] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:37:10,010] WARN [Controller 0]: Partition [__consumer_offsets,42] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:37:10,010] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,34] (kafka.controller.KafkaController)
[2016-11-17 15:37:10,010] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,34] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:37:10,011] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,34] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:37:10,012] WARN [Controller 0]: Partition [__consumer_offsets,34] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:37:10,012] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,46] (kafka.controller.KafkaController)
[2016-11-17 15:37:10,012] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,46] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:37:10,013] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,46] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:37:10,013] WARN [Controller 0]: Partition [__consumer_offsets,46] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:37:10,013] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,32] (kafka.controller.KafkaController)
[2016-11-17 15:37:10,013] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,32] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:37:10,014] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,32] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:37:10,015] WARN [Controller 0]: Partition [__consumer_offsets,32] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:37:10,015] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,36] (kafka.controller.KafkaController)
[2016-11-17 15:37:10,015] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,36] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:37:10,016] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,36] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:37:10,016] WARN [Controller 0]: Partition [__consumer_offsets,36] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:37:10,016] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,38] (kafka.controller.KafkaController)
[2016-11-17 15:37:10,016] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,38] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:37:10,017] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,38] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:37:10,018] WARN [Controller 0]: Partition [__consumer_offsets,38] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:37:10,018] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,16] (kafka.controller.KafkaController)
[2016-11-17 15:37:10,018] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,16] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:37:10,019] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,16] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:37:10,020] WARN [Controller 0]: Partition [__consumer_offsets,16] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:37:10,020] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,2] (kafka.controller.KafkaController)
[2016-11-17 15:37:10,020] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:37:10,021] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:37:10,021] WARN [Controller 0]: Partition [__consumer_offsets,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:37:10,021] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2016-11-17 15:37:10,021] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2016-11-17 15:46:05,054] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2016-11-17 15:46:05,172] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2016-11-17 15:46:05,172] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2016-11-17 15:46:05,173] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2016-11-17 15:46:05,173] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2016-11-17 15:46:05,175] INFO [Controller-0-to-broker-2-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2016-11-17 15:46:05,175] INFO [Controller-0-to-broker-2-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2016-11-17 15:46:05,175] INFO [Controller-0-to-broker-2-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2016-11-17 15:46:05,177] INFO [Controller-0-to-broker-1-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2016-11-17 15:46:05,177] INFO [Controller-0-to-broker-1-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2016-11-17 15:46:05,177] INFO [Controller-0-to-broker-1-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2016-11-17 15:46:05,179] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2016-11-17 15:46:05,447] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2016-11-17 15:46:05,447] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2016-11-17 15:46:05,447] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2016-11-17 15:46:06,866] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2016-11-17 15:46:08,271] INFO [Controller 0]: Initialized controller epoch to 58 and zk version 57 (kafka.controller.KafkaController)
[2016-11-17 15:46:08,738] INFO [Controller 0]: Controller 0 incremented epoch to 59 (kafka.controller.KafkaController)
[2016-11-17 15:46:09,027] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2016-11-17 15:46:15,946] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2016-11-17 15:46:15,947] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2016-11-17 15:46:15,948] INFO [Controller-0-to-broker-2-send-thread], Starting  (kafka.controller.RequestSendThread)
[2016-11-17 15:46:15,949] INFO [Controller-0-to-broker-1-send-thread], Starting  (kafka.controller.RequestSendThread)
[2016-11-17 15:46:15,949] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2016-11-17 15:46:15,949] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2016-11-17 15:46:15,949] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2016-11-17 15:46:15,949] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2016-11-17 15:46:15,949] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2016-11-17 15:46:15,949] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2016-11-17 15:46:15,950] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2016-11-17 15:46:15,950] INFO [Controller 0]: List of topics ineligible for deletion: topic2,topic4,mytopic,topic3,othertopic (kafka.controller.KafkaController)
[2016-11-17 15:46:15,950] INFO [Controller 0]: Currently active brokers in the cluster: Set(1, 2) (kafka.controller.KafkaController)
[2016-11-17 15:46:15,950] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2016-11-17 15:46:15,950] INFO [Controller 0]: Current list of topics in the cluster: Set(topic2, topic1, __consumer_offsets, topic4, mytopic, topic3, othertopic) (kafka.controller.KafkaController)
[2016-11-17 15:46:15,951] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=__consumer_offsets,Partition=28,Replica=1],[Topic=__consumer_offsets,Partition=17,Replica=2],[Topic=__consumer_offsets,Partition=48,Replica=1],[Topic=__consumer_offsets,Partition=5,Replica=1],[Topic=__consumer_offsets,Partition=21,Replica=1],[Topic=__consumer_offsets,Partition=38,Replica=2],[Topic=__consumer_offsets,Partition=39,Replica=2],[Topic=__consumer_offsets,Partition=2,Replica=1],[Topic=__consumer_offsets,Partition=18,Replica=1],[Topic=__consumer_offsets,Partition=23,Replica=2],[Topic=__consumer_offsets,Partition=48,Replica=2],[Topic=__consumer_offsets,Partition=23,Replica=1],[Topic=__consumer_offsets,Partition=9,Replica=1],[Topic=__consumer_offsets,Partition=42,Replica=2],[Topic=__consumer_offsets,Partition=39,Replica=1],[Topic=topic3,Partition=1,Replica=1],[Topic=__consumer_offsets,Partition=31,Replica=1],[Topic=__consumer_offsets,Partition=2,Replica=2],[Topic=topic2,Partition=0,Replica=1],[Topic=__consumer_offsets,Partition=22,Replica=2],[Topic=__consumer_offsets,Partition=19,Replica=1],[Topic=__consumer_offsets,Partition=10,Replica=1],[Topic=__consumer_offsets,Partition=13,Replica=2],[Topic=__consumer_offsets,Partition=34,Replica=2],[Topic=othertopic,Partition=1,Replica=2],[Topic=__consumer_offsets,Partition=22,Replica=1],[Topic=__consumer_offsets,Partition=40,Replica=2],[Topic=__consumer_offsets,Partition=33,Replica=2],[Topic=__consumer_offsets,Partition=3,Replica=2],[Topic=__consumer_offsets,Partition=37,Replica=2],[Topic=__consumer_offsets,Partition=24,Replica=2],[Topic=__consumer_offsets,Partition=43,Replica=1],[Topic=__consumer_offsets,Partition=40,Replica=1],[Topic=__consumer_offsets,Partition=11,Replica=2],[Topic=__consumer_offsets,Partition=27,Replica=1],[Topic=__consumer_offsets,Partition=6,Replica=1],[Topic=__consumer_offsets,Partition=1,Replica=1],[Topic=__consumer_offsets,Partition=20,Replica=2],[Topic=__consumer_offsets,Partition=47,Replica=1],[Topic=__consumer_offsets,Partition=30,Replica=1],[Topic=__consumer_offsets,Partition=42,Replica=1],[Topic=__consumer_offsets,Partition=27,Replica=2],[Topic=__consumer_offsets,Partition=41,Replica=1],[Topic=__consumer_offsets,Partition=30,Replica=2],[Topic=topic1,Partition=0,Replica=2],[Topic=__consumer_offsets,Partition=15,Replica=2],[Topic=__consumer_offsets,Partition=3,Replica=1],[Topic=__consumer_offsets,Partition=28,Replica=2],[Topic=__consumer_offsets,Partition=13,Replica=1],[Topic=__consumer_offsets,Partition=7,Replica=2],[Topic=__consumer_offsets,Partition=43,Replica=2],[Topic=__consumer_offsets,Partition=10,Replica=2],[Topic=__consumer_offsets,Partition=4,Replica=1],[Topic=__consumer_offsets,Partition=16,Replica=1],[Topic=__consumer_offsets,Partition=46,Replica=1],[Topic=__consumer_offsets,Partition=12,Replica=2],[Topic=__consumer_offsets,Partition=32,Replica=2],[Topic=__consumer_offsets,Partition=49,Replica=1],[Topic=topic4,Partition=0,Replica=1],[Topic=__consumer_offsets,Partition=14,Replica=1],[Topic=__consumer_offsets,Partition=4,Replica=2],[Topic=__consumer_offsets,Partition=26,Replica=2],[Topic=__consumer_offsets,Partition=35,Replica=2],[Topic=__consumer_offsets,Partition=45,Replica=1],[Topic=__consumer_offsets,Partition=46,Replica=2],[Topic=__consumer_offsets,Partition=37,Replica=1],[Topic=__consumer_offsets,Partition=29,Replica=1],[Topic=othertopic,Partition=0,Replica=1],[Topic=__consumer_offsets,Partition=20,Replica=1],[Topic=__consumer_offsets,Partition=8,Replica=1],[Topic=__consumer_offsets,Partition=6,Replica=2],[Topic=__consumer_offsets,Partition=38,Replica=1],[Topic=othertopic,Partition=2,Replica=1],[Topic=__consumer_offsets,Partition=8,Replica=2],[Topic=__consumer_offsets,Partition=44,Replica=2],[Topic=__consumer_offsets,Partition=7,Replica=1],[Topic=__consumer_offsets,Partition=45,Replica=2],[Topic=topic2,Partition=0,Replica=2],[Topic=topic2,Partition=1,Replica=1],[Topic=topic2,Partition=1,Replica=2],[Topic=topic3,Partition=2,Replica=2],[Topic=__consumer_offsets,Partition=49,Replica=2],[Topic=__consumer_offsets,Partition=1,Replica=2],[Topic=__consumer_offsets,Partition=19,Replica=2],[Topic=__consumer_offsets,Partition=0,Replica=1],[Topic=__consumer_offsets,Partition=34,Replica=1],[Topic=__consumer_offsets,Partition=36,Replica=2],[Topic=__consumer_offsets,Partition=33,Replica=1],[Topic=__consumer_offsets,Partition=14,Replica=2],[Topic=__consumer_offsets,Partition=26,Replica=1],[Topic=__consumer_offsets,Partition=44,Replica=1],[Topic=othertopic,Partition=0,Replica=2],[Topic=__consumer_offsets,Partition=32,Replica=1],[Topic=__consumer_offsets,Partition=25,Replica=1],[Topic=__consumer_offsets,Partition=11,Replica=1],[Topic=__consumer_offsets,Partition=31,Replica=2],[Topic=__consumer_offsets,Partition=21,Replica=2],[Topic=othertopic,Partition=2,Replica=2],[Topic=__consumer_offsets,Partition=25,Replica=2],[Topic=__consumer_offsets,Partition=5,Replica=2],[Topic=__consumer_offsets,Partition=41,Replica=2],[Topic=__consumer_offsets,Partition=47,Replica=2],[Topic=__consumer_offsets,Partition=36,Replica=1],[Topic=othertopic,Partition=1,Replica=1],[Topic=__consumer_offsets,Partition=12,Replica=1],[Topic=__consumer_offsets,Partition=16,Replica=2],[Topic=__consumer_offsets,Partition=0,Replica=2],[Topic=topic2,Partition=2,Replica=2],[Topic=__consumer_offsets,Partition=35,Replica=1],[Topic=__consumer_offsets,Partition=29,Replica=2],[Topic=__consumer_offsets,Partition=15,Replica=1],[Topic=__consumer_offsets,Partition=18,Replica=2],[Topic=__consumer_offsets,Partition=17,Replica=1],[Topic=__consumer_offsets,Partition=24,Replica=1],[Topic=topic2,Partition=2,Replica=1],[Topic=__consumer_offsets,Partition=9,Replica=2] (kafka.controller.ReplicaStateMachine)
[2016-11-17 15:46:16,068] INFO [Controller-0-to-broker-2-send-thread], Controller 0 connected to Node(2, localhost, 9094) for sending state change requests (kafka.controller.RequestSendThread)
[2016-11-17 15:46:16,075] INFO [Controller-0-to-broker-1-send-thread], Controller 0 connected to Node(1, localhost, 9093) for sending state change requests (kafka.controller.RequestSendThread)
[2016-11-17 15:46:16,081] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=__consumer_offsets,Partition=45,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=48,Replica=1] -> OnlineReplica, [Topic=othertopic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=__consumer_offsets,Partition=24,Replica=2] -> OnlineReplica, [Topic=topic3,Partition=1,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=10,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=2,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=18,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=38,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=11,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=10,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=21,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=23,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=6,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=48,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=13,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=22,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=0,Replica=2] -> OnlineReplica, [Topic=topic2,Partition=1,Replica=0] -> ReplicaDeletionIneligible, [Topic=__consumer_offsets,Partition=34,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=28,Replica=2] -> OnlineReplica, [Topic=topic2,Partition=0,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=42,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=26,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=44,Replica=1] -> OnlineReplica, [Topic=othertopic,Partition=1,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=4,Replica=2] -> OnlineReplica, [Topic=topic3,Partition=2,Replica=2] -> OnlineReplica, [Topic=topic2,Partition=1,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=46,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=41,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=36,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=30,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=11,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=12,Replica=1] -> OnlineReplica, [Topic=topic4,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=__consumer_offsets,Partition=33,Replica=1] -> OnlineReplica, [Topic=othertopic,Partition=2,Replica=0] -> ReplicaDeletionIneligible, [Topic=__consumer_offsets,Partition=47,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=37,Replica=1] -> OnlineReplica, [Topic=topic2,Partition=2,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=9,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=1,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=42,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=13,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=23,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=6,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=32,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=37,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=2,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=3,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=43,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=49,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=15,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=7,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=4,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=47,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=40,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=46,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=39,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=28,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=22,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=15,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=26,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=3,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=7,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=38,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=16,Replica=1] -> OnlineReplica, [Topic=topic2,Partition=2,Replica=0] -> ReplicaDeletionIneligible, [Topic=__consumer_offsets,Partition=8,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=40,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=36,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=17,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=35,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=32,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=33,Replica=2] -> OnlineReplica, [Topic=othertopic,Partition=2,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=49,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=12,Replica=2] -> OnlineReplica, [Topic=othertopic,Partition=1,Replica=0] -> ReplicaDeletionIneligible, [Topic=__consumer_offsets,Partition=29,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=45,Replica=1] -> OnlineReplica, [Topic=othertopic,Partition=0,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=44,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=0,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=5,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=27,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=41,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=31,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=24,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=29,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=30,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=31,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=1,Replica=1] -> OnlineReplica, [Topic=topic2,Partition=1,Replica=1] -> OnlineReplica, [Topic=othertopic,Partition=2,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=35,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=19,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=19,Replica=1] -> OnlineReplica, [Topic=topic2,Partition=2,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=20,Replica=1] -> OnlineReplica, [Topic=topic4,Partition=0,Replica=1] -> OnlineReplica, [Topic=mytopic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=topic3,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=__consumer_offsets,Partition=34,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=9,Replica=1] -> OnlineReplica, [Topic=othertopic,Partition=1,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=20,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=14,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=16,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=14,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=25,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=18,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=8,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=17,Replica=2] -> OnlineReplica, [Topic=othertopic,Partition=0,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=43,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=25,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=21,Replica=2] -> OnlineReplica, [Topic=topic2,Partition=0,Replica=2] -> OnlineReplica, [Topic=topic2,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=__consumer_offsets,Partition=27,Replica=2] -> OnlineReplica, [Topic=topic1,Partition=0,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=5,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=39,Replica=1] -> OnlineReplica) (kafka.controller.ReplicaStateMachine)
[2016-11-17 15:46:16,179] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic2,0]. Pick the leader from the alive assigned replicas: 1,2 (kafka.controller.OfflinePartitionLeaderSelector)
[2016-11-17 15:46:16,181] WARN [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic2,0]. Elect leader 1 from live brokers 1,2. There's potential data loss. (kafka.controller.OfflinePartitionLeaderSelector)
[2016-11-17 15:46:16,181] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":1,"leader_epoch":15,"isr":[1]} for offline partition [topic2,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2016-11-17 15:46:16,548] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([__consumer_offsets,19] -> (Leader:2,ISR:2,1,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,30] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,47] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,29] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,41] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [topic2,1] -> (Leader:2,ISR:2,LeaderEpoch:17,ControllerEpoch:53), [__consumer_offsets,39] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,10] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [__consumer_offsets,17] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,14] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [topic3,1] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:58), [__consumer_offsets,40] -> (Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:58), [__consumer_offsets,18] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,0] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,26] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,24] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,33] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [othertopic,0] -> (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58), [__consumer_offsets,20] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [__consumer_offsets,21] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,3] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,5] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,22] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [othertopic,1] -> (Leader:2,ISR:2,LeaderEpoch:53,ControllerEpoch:53), [__consumer_offsets,12] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [topic2,0] -> (Leader:1,ISR:1,LeaderEpoch:15,ControllerEpoch:59), [__consumer_offsets,8] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,23] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,15] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,11] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,48] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [__consumer_offsets,13] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,49] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,6] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [__consumer_offsets,28] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,4] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [__consumer_offsets,37] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,31] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,44] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [__consumer_offsets,42] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,34] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [topic1,0] -> (Leader:2,ISR:2,LeaderEpoch:21,ControllerEpoch:52), [__consumer_offsets,46] -> (Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:58), [topic3,2] -> (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:52), [__consumer_offsets,25] -> (Leader:2,ISR:2,LeaderEpoch:36,ControllerEpoch:53), [__consumer_offsets,45] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,27] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [topic2,2] -> (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:38), [__consumer_offsets,32] -> (Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:58), [__consumer_offsets,43] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [othertopic,2] -> (Leader:0,ISR:0,LeaderEpoch:48,ControllerEpoch:38), [__consumer_offsets,36] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [mytopic,0] -> (Leader:0,ISR:0,LeaderEpoch:37,ControllerEpoch:38), [__consumer_offsets,35] -> (Leader:2,ISR:2,LeaderEpoch:36,ControllerEpoch:53), [__consumer_offsets,7] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,38] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,9] -> (Leader:2,ISR:2,LeaderEpoch:36,ControllerEpoch:53), [__consumer_offsets,1] -> (Leader:2,ISR:2,LeaderEpoch:36,ControllerEpoch:53), [topic4,0] -> (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:38), [topic3,0] -> (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:38), [__consumer_offsets,2] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,16] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58)) (kafka.controller.PartitionStateMachine)
[2016-11-17 15:46:16,550] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic2,2]. Pick the leader from the alive assigned replicas: 2,1 (kafka.controller.OfflinePartitionLeaderSelector)
[2016-11-17 15:46:16,551] WARN [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic2,2]. Elect leader 2 from live brokers 2,1. There's potential data loss. (kafka.controller.OfflinePartitionLeaderSelector)
[2016-11-17 15:46:16,551] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":2,"leader_epoch":7,"isr":[2]} for offline partition [topic2,2] (kafka.controller.OfflinePartitionLeaderSelector)
[2016-11-17 15:46:16,633] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([__consumer_offsets,19] -> (Leader:2,ISR:2,1,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,30] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,47] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,29] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,41] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [topic2,1] -> (Leader:2,ISR:2,LeaderEpoch:17,ControllerEpoch:53), [__consumer_offsets,39] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,10] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [__consumer_offsets,17] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,14] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [topic3,1] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:58), [__consumer_offsets,40] -> (Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:58), [__consumer_offsets,18] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,0] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,26] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,24] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,33] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [othertopic,0] -> (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58), [__consumer_offsets,20] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [__consumer_offsets,21] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,3] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,5] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,22] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [othertopic,1] -> (Leader:2,ISR:2,LeaderEpoch:53,ControllerEpoch:53), [__consumer_offsets,12] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [topic2,0] -> (Leader:1,ISR:1,LeaderEpoch:15,ControllerEpoch:59), [__consumer_offsets,8] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,23] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,15] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,11] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,48] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [__consumer_offsets,13] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,49] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,6] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [__consumer_offsets,28] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,4] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [__consumer_offsets,37] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,31] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,44] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [__consumer_offsets,42] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,34] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [topic1,0] -> (Leader:2,ISR:2,LeaderEpoch:21,ControllerEpoch:52), [__consumer_offsets,46] -> (Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:58), [topic3,2] -> (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:52), [__consumer_offsets,25] -> (Leader:2,ISR:2,LeaderEpoch:36,ControllerEpoch:53), [__consumer_offsets,45] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,27] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [topic2,2] -> (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:59), [__consumer_offsets,32] -> (Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:58), [__consumer_offsets,43] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [othertopic,2] -> (Leader:0,ISR:0,LeaderEpoch:48,ControllerEpoch:38), [__consumer_offsets,36] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [mytopic,0] -> (Leader:0,ISR:0,LeaderEpoch:37,ControllerEpoch:38), [__consumer_offsets,35] -> (Leader:2,ISR:2,LeaderEpoch:36,ControllerEpoch:53), [__consumer_offsets,7] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,38] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,9] -> (Leader:2,ISR:2,LeaderEpoch:36,ControllerEpoch:53), [__consumer_offsets,1] -> (Leader:2,ISR:2,LeaderEpoch:36,ControllerEpoch:53), [topic4,0] -> (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:38), [topic3,0] -> (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:38), [__consumer_offsets,2] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,16] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58)) (kafka.controller.PartitionStateMachine)
[2016-11-17 15:46:16,635] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [othertopic,2]. Pick the leader from the alive assigned replicas: 1,2 (kafka.controller.OfflinePartitionLeaderSelector)
[2016-11-17 15:46:16,635] WARN [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [othertopic,2]. Elect leader 1 from live brokers 1,2. There's potential data loss. (kafka.controller.OfflinePartitionLeaderSelector)
[2016-11-17 15:46:16,635] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":1,"leader_epoch":49,"isr":[1]} for offline partition [othertopic,2] (kafka.controller.OfflinePartitionLeaderSelector)
[2016-11-17 15:46:16,732] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([__consumer_offsets,19] -> (Leader:2,ISR:2,1,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,30] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,47] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,29] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,41] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [topic2,1] -> (Leader:2,ISR:2,LeaderEpoch:17,ControllerEpoch:53), [__consumer_offsets,39] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,10] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [__consumer_offsets,17] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,14] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [topic3,1] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:58), [__consumer_offsets,40] -> (Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:58), [__consumer_offsets,18] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,0] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,26] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,24] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,33] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [othertopic,0] -> (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58), [__consumer_offsets,20] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [__consumer_offsets,21] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,3] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,5] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,22] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [othertopic,1] -> (Leader:2,ISR:2,LeaderEpoch:53,ControllerEpoch:53), [__consumer_offsets,12] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [topic2,0] -> (Leader:1,ISR:1,LeaderEpoch:15,ControllerEpoch:59), [__consumer_offsets,8] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,23] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,15] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,11] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,48] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [__consumer_offsets,13] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,49] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,6] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [__consumer_offsets,28] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,4] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [__consumer_offsets,37] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,31] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,44] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [__consumer_offsets,42] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,34] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [topic1,0] -> (Leader:2,ISR:2,LeaderEpoch:21,ControllerEpoch:52), [__consumer_offsets,46] -> (Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:58), [topic3,2] -> (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:52), [__consumer_offsets,25] -> (Leader:2,ISR:2,LeaderEpoch:36,ControllerEpoch:53), [__consumer_offsets,45] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,27] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [topic2,2] -> (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:59), [__consumer_offsets,32] -> (Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:58), [__consumer_offsets,43] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [othertopic,2] -> (Leader:1,ISR:1,LeaderEpoch:49,ControllerEpoch:59), [__consumer_offsets,36] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [mytopic,0] -> (Leader:0,ISR:0,LeaderEpoch:37,ControllerEpoch:38), [__consumer_offsets,35] -> (Leader:2,ISR:2,LeaderEpoch:36,ControllerEpoch:53), [__consumer_offsets,7] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,38] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,9] -> (Leader:2,ISR:2,LeaderEpoch:36,ControllerEpoch:53), [__consumer_offsets,1] -> (Leader:2,ISR:2,LeaderEpoch:36,ControllerEpoch:53), [topic4,0] -> (Leader:0,ISR:0,LeaderEpoch:3,ControllerEpoch:38), [topic3,0] -> (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:38), [__consumer_offsets,2] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,16] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58)) (kafka.controller.PartitionStateMachine)
[2016-11-17 15:46:16,734] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [mytopic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2016-11-17 15:46:16,737] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic4,0]. Pick the leader from the alive assigned replicas: 1 (kafka.controller.OfflinePartitionLeaderSelector)
[2016-11-17 15:46:16,737] WARN [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic4,0]. Elect leader 1 from live brokers 1. There's potential data loss. (kafka.controller.OfflinePartitionLeaderSelector)
[2016-11-17 15:46:16,737] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":1,"leader_epoch":4,"isr":[1]} for offline partition [topic4,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2016-11-17 15:46:16,946] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([__consumer_offsets,19] -> (Leader:2,ISR:2,1,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,30] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,47] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,29] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,41] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [topic2,1] -> (Leader:2,ISR:2,LeaderEpoch:17,ControllerEpoch:53), [__consumer_offsets,39] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,10] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [__consumer_offsets,17] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,14] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [topic3,1] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:58), [__consumer_offsets,40] -> (Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:58), [__consumer_offsets,18] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,0] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,26] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,24] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,33] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [othertopic,0] -> (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58), [__consumer_offsets,20] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [__consumer_offsets,21] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,3] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,5] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,22] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [othertopic,1] -> (Leader:2,ISR:2,LeaderEpoch:53,ControllerEpoch:53), [__consumer_offsets,12] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [topic2,0] -> (Leader:1,ISR:1,LeaderEpoch:15,ControllerEpoch:59), [__consumer_offsets,8] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,23] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,15] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,11] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,48] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [__consumer_offsets,13] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,49] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,6] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [__consumer_offsets,28] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,4] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [__consumer_offsets,37] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,31] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,44] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [__consumer_offsets,42] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,34] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [topic1,0] -> (Leader:2,ISR:2,LeaderEpoch:21,ControllerEpoch:52), [__consumer_offsets,46] -> (Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:58), [topic3,2] -> (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:52), [__consumer_offsets,25] -> (Leader:2,ISR:2,LeaderEpoch:36,ControllerEpoch:53), [__consumer_offsets,45] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,27] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [topic2,2] -> (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:59), [__consumer_offsets,32] -> (Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:58), [__consumer_offsets,43] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [othertopic,2] -> (Leader:1,ISR:1,LeaderEpoch:49,ControllerEpoch:59), [__consumer_offsets,36] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [mytopic,0] -> (Leader:0,ISR:0,LeaderEpoch:37,ControllerEpoch:38), [__consumer_offsets,35] -> (Leader:2,ISR:2,LeaderEpoch:36,ControllerEpoch:53), [__consumer_offsets,7] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,38] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,9] -> (Leader:2,ISR:2,LeaderEpoch:36,ControllerEpoch:53), [__consumer_offsets,1] -> (Leader:2,ISR:2,LeaderEpoch:36,ControllerEpoch:53), [topic4,0] -> (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:59), [topic3,0] -> (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:38), [__consumer_offsets,2] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,16] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58)) (kafka.controller.PartitionStateMachine)
[2016-11-17 15:46:17,004] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [topic3,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2016-11-17 15:46:17,103] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([__consumer_offsets,19] -> OnlinePartition, [__consumer_offsets,30] -> OnlinePartition, [__consumer_offsets,47] -> OnlinePartition, [__consumer_offsets,29] -> OnlinePartition, [__consumer_offsets,41] -> OnlinePartition, [topic2,1] -> OnlinePartition, [__consumer_offsets,39] -> OnlinePartition, [__consumer_offsets,17] -> OnlinePartition, [__consumer_offsets,10] -> OnlinePartition, [__consumer_offsets,14] -> OnlinePartition, [topic3,1] -> OnlinePartition, [__consumer_offsets,40] -> OnlinePartition, [__consumer_offsets,18] -> OnlinePartition, [__consumer_offsets,0] -> OnlinePartition, [__consumer_offsets,26] -> OnlinePartition, [__consumer_offsets,24] -> OnlinePartition, [__consumer_offsets,33] -> OnlinePartition, [othertopic,0] -> OnlinePartition, [__consumer_offsets,20] -> OnlinePartition, [__consumer_offsets,21] -> OnlinePartition, [__consumer_offsets,3] -> OnlinePartition, [__consumer_offsets,5] -> OnlinePartition, [__consumer_offsets,22] -> OnlinePartition, [othertopic,1] -> OnlinePartition, [__consumer_offsets,12] -> OnlinePartition, [topic2,0] -> OnlinePartition, [__consumer_offsets,8] -> OnlinePartition, [__consumer_offsets,23] -> OnlinePartition, [__consumer_offsets,15] -> OnlinePartition, [__consumer_offsets,48] -> OnlinePartition, [__consumer_offsets,11] -> OnlinePartition, [__consumer_offsets,13] -> OnlinePartition, [__consumer_offsets,6] -> OnlinePartition, [__consumer_offsets,49] -> OnlinePartition, [__consumer_offsets,4] -> OnlinePartition, [__consumer_offsets,28] -> OnlinePartition, [__consumer_offsets,37] -> OnlinePartition, [__consumer_offsets,31] -> OnlinePartition, [__consumer_offsets,44] -> OnlinePartition, [__consumer_offsets,42] -> OnlinePartition, [__consumer_offsets,34] -> OnlinePartition, [topic1,0] -> OnlinePartition, [__consumer_offsets,46] -> OnlinePartition, [topic3,2] -> OnlinePartition, [__consumer_offsets,25] -> OnlinePartition, [__consumer_offsets,27] -> OnlinePartition, [__consumer_offsets,45] -> OnlinePartition, [__consumer_offsets,32] -> OnlinePartition, [topic2,2] -> OnlinePartition, [__consumer_offsets,43] -> OnlinePartition, [othertopic,2] -> OnlinePartition, [__consumer_offsets,36] -> OnlinePartition, [mytopic,0] -> OfflinePartition, [__consumer_offsets,35] -> OnlinePartition, [__consumer_offsets,7] -> OnlinePartition, [__consumer_offsets,38] -> OnlinePartition, [__consumer_offsets,9] -> OnlinePartition, [__consumer_offsets,1] -> OnlinePartition, [topic4,0] -> OnlinePartition, [topic3,0] -> OfflinePartition, [__consumer_offsets,2] -> OnlinePartition, [__consumer_offsets,16] -> OnlinePartition) (kafka.controller.PartitionStateMachine)
[2016-11-17 15:46:17,225] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 59 (kafka.controller.KafkaController)
[2016-11-17 15:46:17,225] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2016-11-17 15:46:17,225] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2016-11-17 15:46:17,427] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2016-11-17 15:46:22,428] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2016-11-17 15:46:22,444] DEBUG [Controller 0]: preferred replicas by broker Map(2 -> Map([__consumer_offsets,19] -> List(2, 1), [__consumer_offsets,47] -> List(2, 1), [__consumer_offsets,41] -> List(2, 1), [__consumer_offsets,29] -> List(2, 1), [topic2,1] -> List(2, 1, 0), [__consumer_offsets,39] -> List(2, 1), [__consumer_offsets,17] -> List(2, 1), [__consumer_offsets,33] -> List(2, 1), [__consumer_offsets,5] -> List(2, 1), [__consumer_offsets,21] -> List(2, 1), [__consumer_offsets,3] -> List(2, 1), [othertopic,1] -> List(2, 0, 1), [__consumer_offsets,23] -> List(2, 1), [__consumer_offsets,15] -> List(2, 1), [__consumer_offsets,11] -> List(2, 1), [__consumer_offsets,13] -> List(2, 1), [__consumer_offsets,49] -> List(2, 1), [__consumer_offsets,37] -> List(2, 1), [__consumer_offsets,31] -> List(2, 1), [topic1,0] -> List(2), [topic3,2] -> List(2), [__consumer_offsets,25] -> List(2, 1), [__consumer_offsets,45] -> List(2, 1), [__consumer_offsets,27] -> List(2, 1), [__consumer_offsets,43] -> List(2, 1), [__consumer_offsets,35] -> List(2, 1), [__consumer_offsets,7] -> List(2, 1), [__consumer_offsets,9] -> List(2, 1), [__consumer_offsets,1] -> List(2, 1)), 1 -> Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [topic3,1] -> List(1), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [topic2,0] -> List(1, 0, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2)), 0 -> Map([othertopic,2] -> List(0, 1, 2), [topic2,2] -> List(0, 2, 1), [mytopic,0] -> List(0), [topic4,0] -> List(0, 1), [topic3,0] -> List(0))) (kafka.controller.KafkaController)
[2016-11-17 15:46:22,444] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2016-11-17 15:46:22,444] TRACE [Controller 0]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2016-11-17 15:46:22,444] DEBUG [Controller 0]: topics not in preferred replica Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2)) (kafka.controller.KafkaController)
[2016-11-17 15:46:22,444] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 0.928571 (kafka.controller.KafkaController)
[2016-11-17 15:46:22,444] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,30] (kafka.controller.KafkaController)
[2016-11-17 15:46:22,444] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,30] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:46:22,446] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,30] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:46:22,447] WARN [Controller 0]: Partition [__consumer_offsets,30] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:46:22,447] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,10] (kafka.controller.KafkaController)
[2016-11-17 15:46:22,447] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,10] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:46:22,449] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,10] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:46:22,449] WARN [Controller 0]: Partition [__consumer_offsets,10] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:46:22,450] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,14] (kafka.controller.KafkaController)
[2016-11-17 15:46:22,450] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,14] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:46:22,451] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,14] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:46:22,452] WARN [Controller 0]: Partition [__consumer_offsets,14] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:46:22,452] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,40] (kafka.controller.KafkaController)
[2016-11-17 15:46:22,452] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,40] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:46:22,454] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,40] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:46:22,454] WARN [Controller 0]: Partition [__consumer_offsets,40] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:46:22,454] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,18] (kafka.controller.KafkaController)
[2016-11-17 15:46:22,454] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,18] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:46:22,457] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,18] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:46:22,457] WARN [Controller 0]: Partition [__consumer_offsets,18] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:46:22,457] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,26] (kafka.controller.KafkaController)
[2016-11-17 15:46:22,457] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,26] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:46:22,459] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,26] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:46:22,460] WARN [Controller 0]: Partition [__consumer_offsets,26] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:46:22,460] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,0] (kafka.controller.KafkaController)
[2016-11-17 15:46:22,460] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:46:22,461] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:46:22,461] WARN [Controller 0]: Partition [__consumer_offsets,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:46:22,462] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,24] (kafka.controller.KafkaController)
[2016-11-17 15:46:22,462] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,24] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:46:22,463] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,24] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:46:22,463] WARN [Controller 0]: Partition [__consumer_offsets,24] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:46:22,463] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,0] (kafka.controller.KafkaController)
[2016-11-17 15:46:22,463] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:46:22,464] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [othertopic,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:46:22,465] WARN [Controller 0]: Partition [othertopic,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:46:22,465] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,20] (kafka.controller.KafkaController)
[2016-11-17 15:46:22,465] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,20] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:46:22,466] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,20] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:46:22,467] WARN [Controller 0]: Partition [__consumer_offsets,20] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:46:22,467] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,22] (kafka.controller.KafkaController)
[2016-11-17 15:46:22,467] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,22] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:46:22,468] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,22] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:46:22,469] WARN [Controller 0]: Partition [__consumer_offsets,22] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:46:22,469] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,12] (kafka.controller.KafkaController)
[2016-11-17 15:46:22,469] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,12] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:46:22,470] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,12] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:46:22,471] WARN [Controller 0]: Partition [__consumer_offsets,12] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:46:22,471] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,8] (kafka.controller.KafkaController)
[2016-11-17 15:46:22,471] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,8] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:46:22,472] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,8] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:46:22,472] WARN [Controller 0]: Partition [__consumer_offsets,8] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:46:22,473] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,48] (kafka.controller.KafkaController)
[2016-11-17 15:46:22,473] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,48] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:46:22,474] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,48] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:46:22,474] WARN [Controller 0]: Partition [__consumer_offsets,48] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:46:22,474] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,6] (kafka.controller.KafkaController)
[2016-11-17 15:46:22,474] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,6] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:46:22,476] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,6] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:46:22,476] WARN [Controller 0]: Partition [__consumer_offsets,6] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:46:22,476] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,28] (kafka.controller.KafkaController)
[2016-11-17 15:46:22,476] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,28] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:46:22,478] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,28] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:46:22,478] WARN [Controller 0]: Partition [__consumer_offsets,28] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:46:22,479] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,4] (kafka.controller.KafkaController)
[2016-11-17 15:46:22,479] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,4] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:46:22,480] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,4] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:46:22,481] WARN [Controller 0]: Partition [__consumer_offsets,4] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:46:22,481] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,44] (kafka.controller.KafkaController)
[2016-11-17 15:46:22,481] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,44] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:46:22,482] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,44] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:46:22,483] WARN [Controller 0]: Partition [__consumer_offsets,44] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:46:22,483] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,42] (kafka.controller.KafkaController)
[2016-11-17 15:46:22,483] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,42] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:46:22,485] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,42] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:46:22,485] WARN [Controller 0]: Partition [__consumer_offsets,42] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:46:22,485] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,34] (kafka.controller.KafkaController)
[2016-11-17 15:46:22,485] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,34] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:46:22,487] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,34] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:46:22,487] WARN [Controller 0]: Partition [__consumer_offsets,34] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:46:22,487] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,46] (kafka.controller.KafkaController)
[2016-11-17 15:46:22,487] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,46] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:46:22,488] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,46] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:46:22,489] WARN [Controller 0]: Partition [__consumer_offsets,46] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:46:22,489] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,32] (kafka.controller.KafkaController)
[2016-11-17 15:46:22,489] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,32] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:46:22,490] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,32] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:46:22,491] WARN [Controller 0]: Partition [__consumer_offsets,32] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:46:22,491] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,36] (kafka.controller.KafkaController)
[2016-11-17 15:46:22,491] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,36] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:46:22,492] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,36] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:46:22,492] WARN [Controller 0]: Partition [__consumer_offsets,36] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:46:22,492] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,38] (kafka.controller.KafkaController)
[2016-11-17 15:46:22,492] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,38] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:46:22,494] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,38] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:46:22,494] WARN [Controller 0]: Partition [__consumer_offsets,38] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:46:22,494] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,16] (kafka.controller.KafkaController)
[2016-11-17 15:46:22,494] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,16] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:46:22,495] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,16] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:46:22,496] WARN [Controller 0]: Partition [__consumer_offsets,16] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:46:22,496] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,2] (kafka.controller.KafkaController)
[2016-11-17 15:46:22,496] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:46:22,497] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:46:22,497] WARN [Controller 0]: Partition [__consumer_offsets,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:46:22,497] DEBUG [Controller 0]: topics not in preferred replica Map([topic2,2] -> List(0, 2, 1), [othertopic,2] -> List(0, 1, 2), [topic4,0] -> List(0, 1)) (kafka.controller.KafkaController)
[2016-11-17 15:46:22,498] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.600000 (kafka.controller.KafkaController)
[2016-11-17 15:46:22,860] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2016-11-17 15:46:22,910] DEBUG Sending MetadataRequest to Brokers:ArrayBuffer(1, 2) for TopicAndPartitions:Set([topic2,2], [__consumer_offsets,49], [topic2,1], [__consumer_offsets,17], [__consumer_offsets,23], [__consumer_offsets,7], [__consumer_offsets,29], [topic4,0], [__consumer_offsets,35], [__consumer_offsets,3], [__consumer_offsets,41], [__consumer_offsets,13], [__consumer_offsets,5], [__consumer_offsets,39], [othertopic,2], [__consumer_offsets,45], [__consumer_offsets,15], [__consumer_offsets,33], [__consumer_offsets,37], [__consumer_offsets,21], [othertopic,1], [__consumer_offsets,11], [__consumer_offsets,47], [__consumer_offsets,27], [__consumer_offsets,9], [__consumer_offsets,25], [topic2,0], [__consumer_offsets,31], [__consumer_offsets,19], [__consumer_offsets,43], [__consumer_offsets,1]) (kafka.controller.IsrChangeNotificationListener)
[2016-11-17 15:46:22,938] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0,1,2 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2016-11-17 15:46:22,944] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0,1,2 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2016-11-17 15:46:22,944] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2016-11-17 15:46:22,945] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2016-11-17 15:46:22,945] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2016-11-17 15:46:22,949] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=othertopic,Partition=1,Replica=0],[Topic=mytopic,Partition=0,Replica=0],[Topic=othertopic,Partition=2,Replica=0],[Topic=topic2,Partition=1,Replica=0],[Topic=topic2,Partition=0,Replica=0],[Topic=topic2,Partition=2,Replica=0],[Topic=topic3,Partition=0,Replica=0],[Topic=othertopic,Partition=0,Replica=0],[Topic=topic4,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2016-11-17 15:46:22,949] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, 172.16.26.72, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2016-11-17 15:46:22,952] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [mytopic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2016-11-17 15:46:22,952] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":38,"isr":[0]} for offline partition [mytopic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2016-11-17 15:46:22,953] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([__consumer_offsets,19] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,30] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,47] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,29] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,41] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [topic2,1] -> (Leader:2,ISR:2,LeaderEpoch:17,ControllerEpoch:53), [__consumer_offsets,39] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,10] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [__consumer_offsets,17] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,14] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [topic3,1] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:58), [__consumer_offsets,40] -> (Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:58), [__consumer_offsets,18] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,0] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,26] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,24] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,33] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [othertopic,0] -> (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58), [__consumer_offsets,20] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [__consumer_offsets,21] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,3] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,5] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,22] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [othertopic,1] -> (Leader:2,ISR:2,LeaderEpoch:53,ControllerEpoch:53), [__consumer_offsets,12] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [topic2,0] -> (Leader:1,ISR:1,2,LeaderEpoch:15,ControllerEpoch:59), [__consumer_offsets,8] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,23] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,15] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,11] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,48] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [__consumer_offsets,13] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,49] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,6] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [__consumer_offsets,28] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,4] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [__consumer_offsets,37] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,31] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,44] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [__consumer_offsets,42] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,34] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [topic1,0] -> (Leader:2,ISR:2,LeaderEpoch:21,ControllerEpoch:52), [__consumer_offsets,46] -> (Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:58), [topic3,2] -> (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:52), [__consumer_offsets,25] -> (Leader:2,ISR:2,LeaderEpoch:36,ControllerEpoch:53), [__consumer_offsets,45] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,27] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [topic2,2] -> (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:59), [__consumer_offsets,32] -> (Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:58), [__consumer_offsets,43] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [othertopic,2] -> (Leader:1,ISR:1,2,LeaderEpoch:49,ControllerEpoch:59), [__consumer_offsets,36] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [mytopic,0] -> (Leader:0,ISR:0,LeaderEpoch:38,ControllerEpoch:59), [__consumer_offsets,35] -> (Leader:2,ISR:2,LeaderEpoch:36,ControllerEpoch:53), [__consumer_offsets,7] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,38] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,9] -> (Leader:2,ISR:2,LeaderEpoch:36,ControllerEpoch:53), [__consumer_offsets,1] -> (Leader:2,ISR:2,LeaderEpoch:36,ControllerEpoch:53), [topic4,0] -> (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:59), [topic3,0] -> (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:38), [__consumer_offsets,2] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,16] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58)) (kafka.controller.PartitionStateMachine)
[2016-11-17 15:46:22,954] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [topic3,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2016-11-17 15:46:22,955] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":5,"isr":[0]} for offline partition [topic3,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2016-11-17 15:46:22,956] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([__consumer_offsets,19] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,30] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,47] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,29] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,41] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [topic2,1] -> (Leader:2,ISR:2,LeaderEpoch:17,ControllerEpoch:53), [__consumer_offsets,39] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,10] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [__consumer_offsets,17] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,14] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [topic3,1] -> (Leader:1,ISR:1,LeaderEpoch:7,ControllerEpoch:58), [__consumer_offsets,40] -> (Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:58), [__consumer_offsets,18] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,0] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,26] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,24] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,33] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [othertopic,0] -> (Leader:2,ISR:2,LeaderEpoch:49,ControllerEpoch:58), [__consumer_offsets,20] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [__consumer_offsets,21] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,3] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,5] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,22] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [othertopic,1] -> (Leader:2,ISR:2,LeaderEpoch:53,ControllerEpoch:53), [__consumer_offsets,12] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [topic2,0] -> (Leader:1,ISR:1,2,LeaderEpoch:15,ControllerEpoch:59), [__consumer_offsets,8] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,23] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,15] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,11] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,48] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [__consumer_offsets,13] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,49] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,6] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [__consumer_offsets,28] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,4] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [__consumer_offsets,37] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,31] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:53), [__consumer_offsets,44] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [__consumer_offsets,42] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,34] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58), [topic1,0] -> (Leader:2,ISR:2,LeaderEpoch:21,ControllerEpoch:52), [__consumer_offsets,46] -> (Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:58), [topic3,2] -> (Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:52), [__consumer_offsets,25] -> (Leader:2,ISR:2,LeaderEpoch:36,ControllerEpoch:53), [__consumer_offsets,45] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,27] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [topic2,2] -> (Leader:2,ISR:2,LeaderEpoch:7,ControllerEpoch:59), [__consumer_offsets,32] -> (Leader:2,ISR:2,LeaderEpoch:33,ControllerEpoch:58), [__consumer_offsets,43] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [othertopic,2] -> (Leader:1,ISR:1,2,LeaderEpoch:49,ControllerEpoch:59), [__consumer_offsets,36] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [mytopic,0] -> (Leader:0,ISR:0,LeaderEpoch:38,ControllerEpoch:59), [__consumer_offsets,35] -> (Leader:2,ISR:2,LeaderEpoch:36,ControllerEpoch:53), [__consumer_offsets,7] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:53), [__consumer_offsets,38] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,9] -> (Leader:2,ISR:2,LeaderEpoch:36,ControllerEpoch:53), [__consumer_offsets,1] -> (Leader:2,ISR:2,LeaderEpoch:36,ControllerEpoch:53), [topic4,0] -> (Leader:1,ISR:1,LeaderEpoch:4,ControllerEpoch:59), [topic3,0] -> (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:59), [__consumer_offsets,2] -> (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:58), [__consumer_offsets,16] -> (Leader:2,ISR:2,LeaderEpoch:35,ControllerEpoch:58)) (kafka.controller.PartitionStateMachine)
[2016-11-17 15:46:22,958] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children topic1,topic2,othertopic,topic3,topic4,mytopic,__consumer_offsets (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2016-11-17 15:46:22,958] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2016-11-17 15:46:22,961] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"2":[0,1,2],"1":[2,0,1],"0":[1,2,0]}} for path /brokers/topics/othertopic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2016-11-17 15:46:22,965] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/mytopic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2016-11-17 15:46:22,966] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[2]}} for path /brokers/topics/topic1 (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2016-11-17 15:46:22,967] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"2":[2],"1":[1],"0":[0]}} for path /brokers/topics/topic3 (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2016-11-17 15:46:22,968] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"2":[0,2,1],"1":[2,1,0],"0":[1,0,2]}} for path /brokers/topics/topic2 (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2016-11-17 15:46:22,970] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"45":[2,1],"34":[1,2],"12":[1,2],"8":[1,2],"19":[2,1],"23":[2,1],"4":[1,2],"40":[1,2],"15":[2,1],"11":[2,1],"9":[2,1],"44":[1,2],"33":[2,1],"22":[1,2],"26":[1,2],"37":[2,1],"13":[2,1],"46":[1,2],"24":[1,2],"35":[2,1],"16":[1,2],"5":[2,1],"10":[1,2],"48":[1,2],"21":[2,1],"43":[2,1],"32":[1,2],"49":[2,1],"6":[1,2],"36":[1,2],"1":[2,1],"39":[2,1],"17":[2,1],"25":[2,1],"14":[1,2],"47":[2,1],"31":[2,1],"42":[1,2],"0":[1,2],"20":[1,2],"27":[2,1],"2":[1,2],"38":[1,2],"18":[1,2],"30":[1,2],"7":[2,1],"29":[2,1],"41":[2,1],"3":[2,1],"28":[1,2]}} for path /brokers/topics/__consumer_offsets (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2016-11-17 15:46:22,977] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0,1]}} for path /brokers/topics/topic4 (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2016-11-17 15:46:22,978] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2016-11-17 15:46:22,979] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0,1,2 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2016-11-17 15:46:22,982] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0,1,2 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2016-11-17 15:46:22,983] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2016-11-17 15:46:43,304] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2016-11-17 15:46:43,334] DEBUG Sending MetadataRequest to Brokers:ArrayBuffer(0, 1, 2) for TopicAndPartitions:Set([__consumer_offsets,49], [topic2,1], [__consumer_offsets,17], [__consumer_offsets,23], [__consumer_offsets,7], [__consumer_offsets,29], [__consumer_offsets,35], [__consumer_offsets,3], [__consumer_offsets,41], [__consumer_offsets,13], [__consumer_offsets,5], [__consumer_offsets,39], [__consumer_offsets,45], [__consumer_offsets,15], [__consumer_offsets,33], [__consumer_offsets,37], [__consumer_offsets,21], [othertopic,1], [__consumer_offsets,11], [__consumer_offsets,47], [__consumer_offsets,27], [__consumer_offsets,9], [__consumer_offsets,25], [__consumer_offsets,31], [__consumer_offsets,19], [__consumer_offsets,43], [__consumer_offsets,1]) (kafka.controller.IsrChangeNotificationListener)
[2016-11-17 15:46:43,338] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2016-11-17 15:51:22,415] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2016-11-17 15:51:22,431] DEBUG [Controller 0]: preferred replicas by broker Map(2 -> Map([__consumer_offsets,19] -> List(2, 1), [__consumer_offsets,47] -> List(2, 1), [__consumer_offsets,41] -> List(2, 1), [__consumer_offsets,29] -> List(2, 1), [topic2,1] -> List(2, 1, 0), [__consumer_offsets,39] -> List(2, 1), [__consumer_offsets,17] -> List(2, 1), [__consumer_offsets,33] -> List(2, 1), [__consumer_offsets,5] -> List(2, 1), [__consumer_offsets,3] -> List(2, 1), [__consumer_offsets,21] -> List(2, 1), [othertopic,1] -> List(2, 0, 1), [__consumer_offsets,23] -> List(2, 1), [__consumer_offsets,15] -> List(2, 1), [__consumer_offsets,11] -> List(2, 1), [__consumer_offsets,13] -> List(2, 1), [__consumer_offsets,49] -> List(2, 1), [__consumer_offsets,37] -> List(2, 1), [__consumer_offsets,31] -> List(2, 1), [topic1,0] -> List(2), [topic3,2] -> List(2), [__consumer_offsets,25] -> List(2, 1), [__consumer_offsets,45] -> List(2, 1), [__consumer_offsets,27] -> List(2, 1), [__consumer_offsets,43] -> List(2, 1), [__consumer_offsets,35] -> List(2, 1), [__consumer_offsets,7] -> List(2, 1), [__consumer_offsets,9] -> List(2, 1), [__consumer_offsets,1] -> List(2, 1)), 1 -> Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [topic3,1] -> List(1), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [topic2,0] -> List(1, 0, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2)), 0 -> Map([othertopic,2] -> List(0, 1, 2), [topic2,2] -> List(0, 2, 1), [mytopic,0] -> List(0), [topic3,0] -> List(0), [topic4,0] -> List(0, 1))) (kafka.controller.KafkaController)
[2016-11-17 15:51:22,431] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2016-11-17 15:51:22,431] TRACE [Controller 0]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2016-11-17 15:51:22,431] DEBUG [Controller 0]: topics not in preferred replica Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2)) (kafka.controller.KafkaController)
[2016-11-17 15:51:22,431] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 0.928571 (kafka.controller.KafkaController)
[2016-11-17 15:51:22,431] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,30] (kafka.controller.KafkaController)
[2016-11-17 15:51:22,431] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,30] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:51:22,442] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,30] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:51:22,442] WARN [Controller 0]: Partition [__consumer_offsets,30] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:51:22,442] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,10] (kafka.controller.KafkaController)
[2016-11-17 15:51:22,442] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,10] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:51:22,443] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,10] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:51:22,444] WARN [Controller 0]: Partition [__consumer_offsets,10] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:51:22,444] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,14] (kafka.controller.KafkaController)
[2016-11-17 15:51:22,444] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,14] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:51:22,446] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,14] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:51:22,446] WARN [Controller 0]: Partition [__consumer_offsets,14] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:51:22,446] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,40] (kafka.controller.KafkaController)
[2016-11-17 15:51:22,446] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,40] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:51:22,447] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,40] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:51:22,448] WARN [Controller 0]: Partition [__consumer_offsets,40] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:51:22,448] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,18] (kafka.controller.KafkaController)
[2016-11-17 15:51:22,448] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,18] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:51:22,449] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,18] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:51:22,449] WARN [Controller 0]: Partition [__consumer_offsets,18] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:51:22,449] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,0] (kafka.controller.KafkaController)
[2016-11-17 15:51:22,449] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:51:22,450] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:51:22,450] WARN [Controller 0]: Partition [__consumer_offsets,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:51:22,450] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,26] (kafka.controller.KafkaController)
[2016-11-17 15:51:22,451] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,26] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:51:22,452] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,26] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:51:22,452] WARN [Controller 0]: Partition [__consumer_offsets,26] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:51:22,452] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,24] (kafka.controller.KafkaController)
[2016-11-17 15:51:22,452] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,24] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:51:22,453] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,24] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:51:22,453] WARN [Controller 0]: Partition [__consumer_offsets,24] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:51:22,453] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,0] (kafka.controller.KafkaController)
[2016-11-17 15:51:22,453] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:51:22,455] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [othertopic,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:51:22,455] WARN [Controller 0]: Partition [othertopic,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:51:22,455] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,20] (kafka.controller.KafkaController)
[2016-11-17 15:51:22,455] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,20] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:51:22,456] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,20] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:51:22,456] WARN [Controller 0]: Partition [__consumer_offsets,20] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:51:22,456] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,22] (kafka.controller.KafkaController)
[2016-11-17 15:51:22,456] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,22] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:51:22,457] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,22] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:51:22,458] WARN [Controller 0]: Partition [__consumer_offsets,22] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:51:22,458] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,12] (kafka.controller.KafkaController)
[2016-11-17 15:51:22,458] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,12] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:51:22,459] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,12] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:51:22,459] WARN [Controller 0]: Partition [__consumer_offsets,12] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:51:22,459] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,8] (kafka.controller.KafkaController)
[2016-11-17 15:51:22,459] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,8] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:51:22,460] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,8] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:51:22,461] WARN [Controller 0]: Partition [__consumer_offsets,8] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:51:22,461] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,48] (kafka.controller.KafkaController)
[2016-11-17 15:51:22,461] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,48] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:51:22,462] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,48] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:51:22,462] WARN [Controller 0]: Partition [__consumer_offsets,48] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:51:22,462] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,6] (kafka.controller.KafkaController)
[2016-11-17 15:51:22,462] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,6] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:51:22,463] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,6] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:51:22,464] WARN [Controller 0]: Partition [__consumer_offsets,6] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:51:22,464] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,28] (kafka.controller.KafkaController)
[2016-11-17 15:51:22,464] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,28] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:51:22,465] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,28] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:51:22,465] WARN [Controller 0]: Partition [__consumer_offsets,28] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:51:22,465] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,4] (kafka.controller.KafkaController)
[2016-11-17 15:51:22,465] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,4] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:51:22,466] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,4] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:51:22,467] WARN [Controller 0]: Partition [__consumer_offsets,4] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:51:22,467] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,44] (kafka.controller.KafkaController)
[2016-11-17 15:51:22,467] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,44] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:51:22,468] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,44] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:51:22,468] WARN [Controller 0]: Partition [__consumer_offsets,44] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:51:22,468] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,42] (kafka.controller.KafkaController)
[2016-11-17 15:51:22,468] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,42] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:51:22,469] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,42] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:51:22,470] WARN [Controller 0]: Partition [__consumer_offsets,42] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:51:22,470] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,34] (kafka.controller.KafkaController)
[2016-11-17 15:51:22,470] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,34] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:51:22,471] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,34] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:51:22,471] WARN [Controller 0]: Partition [__consumer_offsets,34] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:51:22,472] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,46] (kafka.controller.KafkaController)
[2016-11-17 15:51:22,472] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,46] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:51:22,473] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,46] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:51:22,473] WARN [Controller 0]: Partition [__consumer_offsets,46] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:51:22,474] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,32] (kafka.controller.KafkaController)
[2016-11-17 15:51:22,474] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,32] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:51:22,475] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,32] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:51:22,475] WARN [Controller 0]: Partition [__consumer_offsets,32] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:51:22,475] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,36] (kafka.controller.KafkaController)
[2016-11-17 15:51:22,476] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,36] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:51:22,477] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,36] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:51:22,477] WARN [Controller 0]: Partition [__consumer_offsets,36] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:51:22,477] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,38] (kafka.controller.KafkaController)
[2016-11-17 15:51:22,477] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,38] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:51:22,478] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,38] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:51:22,479] WARN [Controller 0]: Partition [__consumer_offsets,38] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:51:22,479] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,2] (kafka.controller.KafkaController)
[2016-11-17 15:51:22,479] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:51:22,480] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:51:22,480] WARN [Controller 0]: Partition [__consumer_offsets,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:51:22,480] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,16] (kafka.controller.KafkaController)
[2016-11-17 15:51:22,480] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,16] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:51:22,481] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,16] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:51:22,481] WARN [Controller 0]: Partition [__consumer_offsets,16] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:51:22,482] DEBUG [Controller 0]: topics not in preferred replica Map([topic2,2] -> List(0, 2, 1), [othertopic,2] -> List(0, 1, 2), [topic4,0] -> List(0, 1)) (kafka.controller.KafkaController)
[2016-11-17 15:51:22,482] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.600000 (kafka.controller.KafkaController)
[2016-11-17 15:51:22,482] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic2,2] (kafka.controller.KafkaController)
[2016-11-17 15:51:22,482] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic2,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:51:22,483] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [topic2,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:51:22,483] WARN [Controller 0]: Partition [topic2,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:51:22,483] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,2] (kafka.controller.KafkaController)
[2016-11-17 15:51:22,483] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:51:22,484] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [othertopic,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:51:22,484] WARN [Controller 0]: Partition [othertopic,2] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
[2016-11-17 15:51:22,484] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic4,0] (kafka.controller.KafkaController)
[2016-11-17 15:51:22,484] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic4,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:51:22,485] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [topic4,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:51:22,486] WARN [Controller 0]: Partition [topic4,0] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
[2016-11-17 15:56:22,408] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2016-11-17 15:56:22,424] DEBUG [Controller 0]: preferred replicas by broker Map(2 -> Map([__consumer_offsets,19] -> List(2, 1), [__consumer_offsets,47] -> List(2, 1), [__consumer_offsets,41] -> List(2, 1), [__consumer_offsets,29] -> List(2, 1), [topic2,1] -> List(2, 1, 0), [__consumer_offsets,39] -> List(2, 1), [__consumer_offsets,17] -> List(2, 1), [__consumer_offsets,33] -> List(2, 1), [__consumer_offsets,5] -> List(2, 1), [__consumer_offsets,3] -> List(2, 1), [__consumer_offsets,21] -> List(2, 1), [othertopic,1] -> List(2, 0, 1), [__consumer_offsets,23] -> List(2, 1), [__consumer_offsets,15] -> List(2, 1), [__consumer_offsets,11] -> List(2, 1), [__consumer_offsets,13] -> List(2, 1), [__consumer_offsets,49] -> List(2, 1), [__consumer_offsets,37] -> List(2, 1), [__consumer_offsets,31] -> List(2, 1), [topic1,0] -> List(2), [topic3,2] -> List(2), [__consumer_offsets,25] -> List(2, 1), [__consumer_offsets,45] -> List(2, 1), [__consumer_offsets,27] -> List(2, 1), [__consumer_offsets,43] -> List(2, 1), [__consumer_offsets,35] -> List(2, 1), [__consumer_offsets,7] -> List(2, 1), [__consumer_offsets,9] -> List(2, 1), [__consumer_offsets,1] -> List(2, 1)), 1 -> Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [topic3,1] -> List(1), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [topic2,0] -> List(1, 0, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2)), 0 -> Map([othertopic,2] -> List(0, 1, 2), [topic2,2] -> List(0, 2, 1), [mytopic,0] -> List(0), [topic3,0] -> List(0), [topic4,0] -> List(0, 1))) (kafka.controller.KafkaController)
[2016-11-17 15:56:22,424] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2016-11-17 15:56:22,424] TRACE [Controller 0]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2016-11-17 15:56:22,424] DEBUG [Controller 0]: topics not in preferred replica Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2)) (kafka.controller.KafkaController)
[2016-11-17 15:56:22,424] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 0.928571 (kafka.controller.KafkaController)
[2016-11-17 15:56:22,425] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,30] (kafka.controller.KafkaController)
[2016-11-17 15:56:22,425] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,30] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:56:22,445] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,30] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:56:22,446] WARN [Controller 0]: Partition [__consumer_offsets,30] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:56:22,446] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,10] (kafka.controller.KafkaController)
[2016-11-17 15:56:22,446] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,10] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:56:22,447] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,10] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:56:22,447] WARN [Controller 0]: Partition [__consumer_offsets,10] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:56:22,447] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,14] (kafka.controller.KafkaController)
[2016-11-17 15:56:22,447] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,14] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:56:22,448] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,14] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:56:22,449] WARN [Controller 0]: Partition [__consumer_offsets,14] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:56:22,449] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,40] (kafka.controller.KafkaController)
[2016-11-17 15:56:22,449] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,40] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:56:22,450] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,40] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:56:22,450] WARN [Controller 0]: Partition [__consumer_offsets,40] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:56:22,450] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,18] (kafka.controller.KafkaController)
[2016-11-17 15:56:22,450] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,18] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:56:22,451] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,18] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:56:22,452] WARN [Controller 0]: Partition [__consumer_offsets,18] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:56:22,452] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,0] (kafka.controller.KafkaController)
[2016-11-17 15:56:22,452] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:56:22,453] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:56:22,454] WARN [Controller 0]: Partition [__consumer_offsets,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:56:22,454] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,26] (kafka.controller.KafkaController)
[2016-11-17 15:56:22,454] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,26] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:56:22,455] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,26] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:56:22,456] WARN [Controller 0]: Partition [__consumer_offsets,26] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:56:22,456] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,24] (kafka.controller.KafkaController)
[2016-11-17 15:56:22,456] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,24] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:56:22,457] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,24] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:56:22,458] WARN [Controller 0]: Partition [__consumer_offsets,24] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:56:22,458] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,0] (kafka.controller.KafkaController)
[2016-11-17 15:56:22,458] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:56:22,460] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [othertopic,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:56:22,461] WARN [Controller 0]: Partition [othertopic,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:56:22,461] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,20] (kafka.controller.KafkaController)
[2016-11-17 15:56:22,461] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,20] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:56:22,463] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,20] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:56:22,463] WARN [Controller 0]: Partition [__consumer_offsets,20] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:56:22,463] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,22] (kafka.controller.KafkaController)
[2016-11-17 15:56:22,463] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,22] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:56:22,465] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,22] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:56:22,465] WARN [Controller 0]: Partition [__consumer_offsets,22] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:56:22,465] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,12] (kafka.controller.KafkaController)
[2016-11-17 15:56:22,465] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,12] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:56:22,467] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,12] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:56:22,467] WARN [Controller 0]: Partition [__consumer_offsets,12] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:56:22,467] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,8] (kafka.controller.KafkaController)
[2016-11-17 15:56:22,467] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,8] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:56:22,469] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,8] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:56:22,469] WARN [Controller 0]: Partition [__consumer_offsets,8] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:56:22,469] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,48] (kafka.controller.KafkaController)
[2016-11-17 15:56:22,469] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,48] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:56:22,470] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,48] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:56:22,471] WARN [Controller 0]: Partition [__consumer_offsets,48] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:56:22,471] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,6] (kafka.controller.KafkaController)
[2016-11-17 15:56:22,471] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,6] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:56:22,472] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,6] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:56:22,473] WARN [Controller 0]: Partition [__consumer_offsets,6] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:56:22,473] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,28] (kafka.controller.KafkaController)
[2016-11-17 15:56:22,473] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,28] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:56:22,474] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,28] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:56:22,475] WARN [Controller 0]: Partition [__consumer_offsets,28] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:56:22,475] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,4] (kafka.controller.KafkaController)
[2016-11-17 15:56:22,475] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,4] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:56:22,478] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,4] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:56:22,479] WARN [Controller 0]: Partition [__consumer_offsets,4] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:56:22,479] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,44] (kafka.controller.KafkaController)
[2016-11-17 15:56:22,479] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,44] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:56:22,481] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,44] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:56:22,481] WARN [Controller 0]: Partition [__consumer_offsets,44] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:56:22,481] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,42] (kafka.controller.KafkaController)
[2016-11-17 15:56:22,481] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,42] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:56:22,483] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,42] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:56:22,484] WARN [Controller 0]: Partition [__consumer_offsets,42] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:56:22,484] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,34] (kafka.controller.KafkaController)
[2016-11-17 15:56:22,484] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,34] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:56:22,486] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,34] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:56:22,487] WARN [Controller 0]: Partition [__consumer_offsets,34] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:56:22,487] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,46] (kafka.controller.KafkaController)
[2016-11-17 15:56:22,487] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,46] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:56:22,488] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,46] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:56:22,489] WARN [Controller 0]: Partition [__consumer_offsets,46] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:56:22,489] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,32] (kafka.controller.KafkaController)
[2016-11-17 15:56:22,489] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,32] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:56:22,492] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,32] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:56:22,493] WARN [Controller 0]: Partition [__consumer_offsets,32] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:56:22,493] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,36] (kafka.controller.KafkaController)
[2016-11-17 15:56:22,493] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,36] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:56:22,495] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,36] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:56:22,496] WARN [Controller 0]: Partition [__consumer_offsets,36] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:56:22,496] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,38] (kafka.controller.KafkaController)
[2016-11-17 15:56:22,496] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,38] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:56:22,498] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,38] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:56:22,498] WARN [Controller 0]: Partition [__consumer_offsets,38] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:56:22,498] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,2] (kafka.controller.KafkaController)
[2016-11-17 15:56:22,499] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:56:22,500] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:56:22,501] WARN [Controller 0]: Partition [__consumer_offsets,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:56:22,501] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,16] (kafka.controller.KafkaController)
[2016-11-17 15:56:22,501] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,16] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:56:22,503] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,16] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:56:22,504] WARN [Controller 0]: Partition [__consumer_offsets,16] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:56:22,504] DEBUG [Controller 0]: topics not in preferred replica Map([topic2,2] -> List(0, 2, 1), [othertopic,2] -> List(0, 1, 2), [topic4,0] -> List(0, 1)) (kafka.controller.KafkaController)
[2016-11-17 15:56:22,504] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.600000 (kafka.controller.KafkaController)
[2016-11-17 15:56:22,504] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic2,2] (kafka.controller.KafkaController)
[2016-11-17 15:56:22,504] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic2,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:56:22,506] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [topic2,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:56:22,508] WARN [Controller 0]: Partition [topic2,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 15:56:22,508] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,2] (kafka.controller.KafkaController)
[2016-11-17 15:56:22,508] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:56:22,509] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [othertopic,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:56:22,510] WARN [Controller 0]: Partition [othertopic,2] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
[2016-11-17 15:56:22,510] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic4,0] (kafka.controller.KafkaController)
[2016-11-17 15:56:22,510] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic4,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 15:56:22,512] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [topic4,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 15:56:22,513] WARN [Controller 0]: Partition [topic4,0] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
