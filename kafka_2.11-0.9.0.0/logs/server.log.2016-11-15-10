[2016-11-15 11:03:54,627] INFO [ReplicaFetcherManager on broker 2] Removed fetcher for partitions [othertopic,1] (kafka.server.ReplicaFetcherManager)
[2016-11-15 11:03:54,887] INFO Completed load of log othertopic-1 with log end offset 0 (kafka.log.Log)
[2016-11-15 11:03:54,892] INFO Created log for partition [othertopic,1] in /tmp/kafka-logs-2 with properties {compression.type -> producer, file.delete.delay.ms -> 60000, max.message.bytes -> 1000012, min.insync.replicas -> 1, segment.jitter.ms -> 0, preallocate -> false, min.cleanable.dirty.ratio -> 0.5, index.interval.bytes -> 4096, unclean.leader.election.enable -> true, retention.bytes -> -1, delete.retention.ms -> 86400000, cleanup.policy -> delete, flush.ms -> 9223372036854775807, segment.ms -> 604800000, segment.bytes -> 1073741824, retention.ms -> 604800000, segment.index.bytes -> 10485760, flush.messages -> 9223372036854775807}. (kafka.log.LogManager)
[2016-11-15 11:03:54,892] ERROR [KafkaApi-2] error when handling request Name: FetchRequest; Version: 1; CorrelationId: 0; ClientId: ReplicaFetcherThread-0-2; ReplicaId: 0; MaxWait: 500 ms; MinBytes: 1 bytes; RequestInfo: [othertopic,1] -> PartitionFetchInfo(0,1048576) (kafka.server.KafkaApis)
kafka.common.NotAssignedReplicaException: Leader 2 failed to record follower 0's position -1 since the replica is not recognized to be one of the assigned replicas  for partition [othertopic,1].
	at kafka.cluster.Partition.updateReplicaLogReadResult(Partition.scala:250)
	at kafka.server.ReplicaManager$$anonfun$updateFollowerLogReadResults$2.apply(ReplicaManager.scala:852)
	at kafka.server.ReplicaManager$$anonfun$updateFollowerLogReadResults$2.apply(ReplicaManager.scala:849)
	at scala.collection.immutable.Map$Map1.foreach(Map.scala:116)
	at kafka.server.ReplicaManager.updateFollowerLogReadResults(ReplicaManager.scala:849)
	at kafka.server.ReplicaManager.fetchMessages(ReplicaManager.scala:467)
	at kafka.server.KafkaApis.handleFetchRequest(KafkaApis.scala:434)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:69)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
[2016-11-15 11:03:54,896] INFO Partition [othertopic,1] on broker 2: No checkpointed highwatermark is found for partition [othertopic,1] (kafka.cluster.Partition)
[2016-11-15 11:03:54,941] INFO Completed load of log othertopic-2 with log end offset 0 (kafka.log.Log)
[2016-11-15 11:03:54,943] INFO Created log for partition [othertopic,2] in /tmp/kafka-logs-2 with properties {compression.type -> producer, file.delete.delay.ms -> 60000, max.message.bytes -> 1000012, min.insync.replicas -> 1, segment.jitter.ms -> 0, preallocate -> false, min.cleanable.dirty.ratio -> 0.5, index.interval.bytes -> 4096, unclean.leader.election.enable -> true, retention.bytes -> -1, delete.retention.ms -> 86400000, cleanup.policy -> delete, flush.ms -> 9223372036854775807, segment.ms -> 604800000, segment.bytes -> 1073741824, retention.ms -> 604800000, segment.index.bytes -> 10485760, flush.messages -> 9223372036854775807}. (kafka.log.LogManager)
[2016-11-15 11:03:54,944] INFO Partition [othertopic,2] on broker 2: No checkpointed highwatermark is found for partition [othertopic,2] (kafka.cluster.Partition)
[2016-11-15 11:03:54,952] INFO Completed load of log othertopic-0 with log end offset 0 (kafka.log.Log)
[2016-11-15 11:03:54,956] INFO Created log for partition [othertopic,0] in /tmp/kafka-logs-2 with properties {compression.type -> producer, file.delete.delay.ms -> 60000, max.message.bytes -> 1000012, min.insync.replicas -> 1, segment.jitter.ms -> 0, preallocate -> false, min.cleanable.dirty.ratio -> 0.5, index.interval.bytes -> 4096, unclean.leader.election.enable -> true, retention.bytes -> -1, delete.retention.ms -> 86400000, cleanup.policy -> delete, flush.ms -> 9223372036854775807, segment.ms -> 604800000, segment.bytes -> 1073741824, retention.ms -> 604800000, segment.index.bytes -> 10485760, flush.messages -> 9223372036854775807}. (kafka.log.LogManager)
[2016-11-15 11:03:54,956] INFO Partition [othertopic,0] on broker 2: No checkpointed highwatermark is found for partition [othertopic,0] (kafka.cluster.Partition)
[2016-11-15 11:03:54,958] INFO [ReplicaFetcherManager on broker 2] Removed fetcher for partitions [othertopic,0],[othertopic,2] (kafka.server.ReplicaFetcherManager)
[2016-11-15 11:03:54,962] INFO Truncating log othertopic-2 to offset 0. (kafka.log.Log)
[2016-11-15 11:03:54,965] INFO Truncating log othertopic-0 to offset 0. (kafka.log.Log)
[2016-11-15 11:03:55,006] INFO [ReplicaFetcherThread-0-0], Starting  (kafka.server.ReplicaFetcherThread)
[2016-11-15 11:03:55,051] INFO [ReplicaFetcherThread-0-1], Starting  (kafka.server.ReplicaFetcherThread)
[2016-11-15 11:03:55,077] INFO [ReplicaFetcherManager on broker 2] Added fetcher for partitions List([[othertopic,2], initOffset 0 to broker BrokerEndPoint(0,172.16.26.72,9092)] , [[othertopic,0], initOffset 0 to broker BrokerEndPoint(1,172.16.26.72,9093)] ) (kafka.server.ReplicaFetcherManager)
[2016-11-15 11:07:17,836] INFO [Group Metadata Manager on Broker 2]: Removed 0 expired offsets in 1 milliseconds. (kafka.coordinator.GroupMetadataManager)
[2016-11-15 11:15:41,223] WARN [ReplicaFetcherThread-0-1], Error in fetch kafka.server.ReplicaFetcherThread$FetchRequest@5c20cc30. Possible cause: java.io.IOException: Connection to 1 was disconnected before the response was read (kafka.server.ReplicaFetcherThread)
[2016-11-15 11:15:41,481] INFO [ReplicaFetcherManager on broker 2] Removed fetcher for partitions [othertopic,0] (kafka.server.ReplicaFetcherManager)
[2016-11-15 11:15:41,482] INFO [ReplicaFetcherThread-0-1], Shutting down (kafka.server.ReplicaFetcherThread)
[2016-11-15 11:15:41,485] INFO [ReplicaFetcherThread-0-1], Stopped  (kafka.server.ReplicaFetcherThread)
[2016-11-15 11:15:41,485] INFO [ReplicaFetcherThread-0-1], Shutdown completed (kafka.server.ReplicaFetcherThread)
[2016-11-15 11:15:41,490] INFO [ReplicaFetcherManager on broker 2] Removed fetcher for partitions [othertopic,1] (kafka.server.ReplicaFetcherManager)
[2016-11-15 11:15:41,496] INFO [ReplicaFetcherManager on broker 2] Removed fetcher for partitions  (kafka.server.ReplicaFetcherManager)
[2016-11-15 11:15:41,497] INFO [ReplicaFetcherManager on broker 2] Added fetcher for partitions List() (kafka.server.ReplicaFetcherManager)
[2016-11-15 11:15:41,927] INFO Partition [othertopic,1] on broker 2: Expanding ISR for partition [othertopic,1] from 2,0 to 2,0,1 (kafka.cluster.Partition)
[2016-11-15 11:15:44,626] INFO [ReplicaFetcherManager on broker 2] Removed fetcher for partitions [othertopic,1] (kafka.server.ReplicaFetcherManager)
[2016-11-15 11:15:44,627] INFO [ReplicaFetcherManager on broker 2] Removed fetcher for partitions  (kafka.server.ReplicaFetcherManager)
[2016-11-15 11:15:44,629] INFO [ReplicaFetcherManager on broker 2] Added fetcher for partitions List() (kafka.server.ReplicaFetcherManager)
[2016-11-15 11:16:10,425] INFO [ReplicaFetcherManager on broker 2] Removed fetcher for partitions [othertopic,0] (kafka.server.ReplicaFetcherManager)
[2016-11-15 11:16:10,436] INFO [ReplicaFetcherManager on broker 2] Removed fetcher for partitions [othertopic,1] (kafka.server.ReplicaFetcherManager)
[2016-11-15 11:16:10,449] INFO [ReplicaFetcherManager on broker 2] Removed fetcher for partitions [othertopic,2] (kafka.server.ReplicaFetcherManager)
[2016-11-15 11:16:10,450] INFO [ReplicaFetcherThread-0-0], Shutting down (kafka.server.ReplicaFetcherThread)
[2016-11-15 11:16:10,456] INFO [ReplicaFetcherThread-0-0], Stopped  (kafka.server.ReplicaFetcherThread)
[2016-11-15 11:16:10,457] INFO [ReplicaFetcherThread-0-0], Shutdown completed (kafka.server.ReplicaFetcherThread)
[2016-11-15 11:16:12,512] INFO Creating /controller (is it secure? false) (kafka.utils.ZKCheckedEphemeral)
[2016-11-15 11:16:12,514] INFO Result of znode creation is: OK (kafka.utils.ZKCheckedEphemeral)
[2016-11-15 11:16:12,515] INFO 2 successfully elected as leader (kafka.server.ZookeeperLeaderElector)
[2016-11-15 11:16:12,703] INFO New leader is 2 (kafka.server.ZookeeperLeaderElector$LeaderChangeListener)
[2016-11-15 11:17:17,810] INFO [Group Metadata Manager on Broker 2]: Removed 0 expired offsets in 0 milliseconds. (kafka.coordinator.GroupMetadataManager)
[2016-11-15 11:23:22,889] INFO Partition [othertopic,0] on broker 2: Expanding ISR for partition [othertopic,0] from 2 to 2,1 (kafka.cluster.Partition)
[2016-11-15 11:23:22,891] INFO Partition [othertopic,1] on broker 2: Expanding ISR for partition [othertopic,1] from 2 to 2,1 (kafka.cluster.Partition)
[2016-11-15 11:23:22,894] INFO Partition [othertopic,2] on broker 2: Expanding ISR for partition [othertopic,2] from 2 to 2,1 (kafka.cluster.Partition)
[2016-11-15 11:23:43,595] INFO Partition [othertopic,1] on broker 2: Expanding ISR for partition [othertopic,1] from 2,1 to 2,1,0 (kafka.cluster.Partition)
[2016-11-15 11:23:43,657] INFO Partition [othertopic,0] on broker 2: Expanding ISR for partition [othertopic,0] from 2,1 to 2,1,0 (kafka.cluster.Partition)
[2016-11-15 11:23:43,659] INFO Partition [othertopic,2] on broker 2: Expanding ISR for partition [othertopic,2] from 2,1 to 2,1,0 (kafka.cluster.Partition)
[2016-11-15 11:24:34,419] INFO [Kafka Server 2], shutting down (kafka.server.KafkaServer)
[2016-11-15 11:24:34,421] INFO [Kafka Server 2], Starting controlled shutdown (kafka.server.KafkaServer)
[2016-11-15 11:24:34,450] INFO [ReplicaFetcherManager on broker 2] Removed fetcher for partitions [othertopic,0] (kafka.server.ReplicaFetcherManager)
[2016-11-15 11:24:34,450] INFO Truncating log othertopic-0 to offset 3. (kafka.log.Log)
[2016-11-15 11:24:34,506] INFO [ReplicaFetcherManager on broker 2] Removed fetcher for partitions [othertopic,1] (kafka.server.ReplicaFetcherManager)
[2016-11-15 11:24:34,507] INFO Truncating log othertopic-1 to offset 2. (kafka.log.Log)
[2016-11-15 11:24:34,585] INFO [ReplicaFetcherManager on broker 2] Removed fetcher for partitions [othertopic,2] (kafka.server.ReplicaFetcherManager)
[2016-11-15 11:24:34,586] INFO Truncating log othertopic-2 to offset 3. (kafka.log.Log)
[2016-11-15 11:24:34,619] INFO [Kafka Server 2], Controlled shutdown succeeded (kafka.server.KafkaServer)
[2016-11-15 11:24:34,624] INFO [Socket Server on Broker 2], Shutting down (kafka.network.SocketServer)
[2016-11-15 11:24:34,661] INFO [Socket Server on Broker 2], Shutdown completed (kafka.network.SocketServer)
[2016-11-15 11:24:34,663] INFO [Kafka Request Handler on Broker 2], shutting down (kafka.server.KafkaRequestHandlerPool)
[2016-11-15 11:24:34,667] INFO [Kafka Request Handler on Broker 2], shut down completely (kafka.server.KafkaRequestHandlerPool)
[2016-11-15 11:24:34,672] INFO [ThrottledRequestReaper-Produce], Shutting down (kafka.server.ClientQuotaManager$ThrottledRequestReaper)
[2016-11-15 11:24:35,368] INFO [ThrottledRequestReaper-Produce], Stopped  (kafka.server.ClientQuotaManager$ThrottledRequestReaper)
[2016-11-15 11:24:35,368] INFO [ThrottledRequestReaper-Produce], Shutdown completed (kafka.server.ClientQuotaManager$ThrottledRequestReaper)
[2016-11-15 11:24:35,368] INFO [ThrottledRequestReaper-Fetch], Shutting down (kafka.server.ClientQuotaManager$ThrottledRequestReaper)
[2016-11-15 11:24:36,371] INFO [ThrottledRequestReaper-Fetch], Stopped  (kafka.server.ClientQuotaManager$ThrottledRequestReaper)
[2016-11-15 11:24:36,371] INFO [ThrottledRequestReaper-Fetch], Shutdown completed (kafka.server.ClientQuotaManager$ThrottledRequestReaper)
[2016-11-15 11:24:36,372] INFO [KafkaApi-2] Shutdown complete. (kafka.server.KafkaApis)
[2016-11-15 11:24:36,373] INFO [Replica Manager on Broker 2]: Shutting down (kafka.server.ReplicaManager)
[2016-11-15 11:24:36,374] INFO [ReplicaFetcherManager on broker 2] shutting down (kafka.server.ReplicaFetcherManager)
[2016-11-15 11:24:36,375] INFO [ReplicaFetcherManager on broker 2] shutdown completed (kafka.server.ReplicaFetcherManager)
[2016-11-15 11:24:36,375] INFO [ExpirationReaper-2], Shutting down (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2016-11-15 11:24:36,463] INFO [ExpirationReaper-2], Stopped  (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2016-11-15 11:24:36,463] INFO [ExpirationReaper-2], Shutdown completed (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2016-11-15 11:24:36,464] INFO [ExpirationReaper-2], Shutting down (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2016-11-15 11:24:36,476] INFO [ExpirationReaper-2], Stopped  (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2016-11-15 11:24:36,477] INFO [ExpirationReaper-2], Shutdown completed (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2016-11-15 11:24:36,478] INFO [Replica Manager on Broker 2]: Shut down completely (kafka.server.ReplicaManager)
[2016-11-15 11:24:36,480] INFO Shutting down. (kafka.log.LogManager)
[2016-11-15 11:24:36,501] INFO Shutdown complete. (kafka.log.LogManager)
[2016-11-15 11:24:36,502] INFO [GroupCoordinator 2]: Shutting down. (kafka.coordinator.GroupCoordinator)
[2016-11-15 11:24:36,503] INFO [ExpirationReaper-2], Shutting down (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2016-11-15 11:24:36,679] INFO [ExpirationReaper-2], Stopped  (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2016-11-15 11:24:36,679] INFO [ExpirationReaper-2], Shutdown completed (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2016-11-15 11:24:36,679] INFO [ExpirationReaper-2], Shutting down (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2016-11-15 11:24:36,882] INFO [ExpirationReaper-2], Stopped  (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2016-11-15 11:24:36,882] INFO [ExpirationReaper-2], Shutdown completed (kafka.server.DelayedOperationPurgatory$ExpiredOperationReaper)
[2016-11-15 11:24:36,883] INFO [GroupCoordinator 2]: Shutdown complete. (kafka.coordinator.GroupCoordinator)
[2016-11-15 11:24:36,907] INFO [Kafka Server 2], shut down completed (kafka.server.KafkaServer)
