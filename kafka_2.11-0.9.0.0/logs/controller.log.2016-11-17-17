[2016-11-17 17:01:22,617] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2016-11-17 17:01:22,618] DEBUG [Controller 0]: preferred replicas by broker Map(2 -> Map([__consumer_offsets,19] -> List(2, 1), [__consumer_offsets,47] -> List(2, 1), [__consumer_offsets,41] -> List(2, 1), [__consumer_offsets,29] -> List(2, 1), [topic2,1] -> List(2, 1, 0), [__consumer_offsets,39] -> List(2, 1), [__consumer_offsets,17] -> List(2, 1), [__consumer_offsets,33] -> List(2, 1), [__consumer_offsets,5] -> List(2, 1), [__consumer_offsets,3] -> List(2, 1), [__consumer_offsets,21] -> List(2, 1), [othertopic,1] -> List(2, 0, 1), [__consumer_offsets,23] -> List(2, 1), [__consumer_offsets,15] -> List(2, 1), [__consumer_offsets,11] -> List(2, 1), [__consumer_offsets,13] -> List(2, 1), [__consumer_offsets,49] -> List(2, 1), [__consumer_offsets,37] -> List(2, 1), [__consumer_offsets,31] -> List(2, 1), [topic1,0] -> List(2), [topic3,2] -> List(2), [__consumer_offsets,25] -> List(2, 1), [__consumer_offsets,45] -> List(2, 1), [__consumer_offsets,27] -> List(2, 1), [__consumer_offsets,43] -> List(2, 1), [__consumer_offsets,35] -> List(2, 1), [__consumer_offsets,7] -> List(2, 1), [__consumer_offsets,9] -> List(2, 1), [__consumer_offsets,1] -> List(2, 1)), 1 -> Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [topic3,1] -> List(1), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [topic2,0] -> List(1, 0, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2)), 0 -> Map([othertopic,2] -> List(0, 1, 2), [topic2,2] -> List(0, 2, 1), [mytopic,0] -> List(0), [topic3,0] -> List(0), [topic4,0] -> List(0, 1))) (kafka.controller.KafkaController)
[2016-11-17 17:01:22,618] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2016-11-17 17:01:22,618] TRACE [Controller 0]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2016-11-17 17:01:22,618] DEBUG [Controller 0]: topics not in preferred replica Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2)) (kafka.controller.KafkaController)
[2016-11-17 17:01:22,618] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 0.928571 (kafka.controller.KafkaController)
[2016-11-17 17:01:22,619] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,30] (kafka.controller.KafkaController)
[2016-11-17 17:01:22,619] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,30] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:01:22,637] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,30] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:01:22,637] WARN [Controller 0]: Partition [__consumer_offsets,30] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:01:22,637] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,10] (kafka.controller.KafkaController)
[2016-11-17 17:01:22,637] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,10] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:01:22,639] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,10] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:01:22,639] WARN [Controller 0]: Partition [__consumer_offsets,10] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:01:22,639] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,14] (kafka.controller.KafkaController)
[2016-11-17 17:01:22,639] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,14] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:01:22,641] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,14] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:01:22,641] WARN [Controller 0]: Partition [__consumer_offsets,14] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:01:22,641] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,40] (kafka.controller.KafkaController)
[2016-11-17 17:01:22,641] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,40] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:01:22,642] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,40] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:01:22,643] WARN [Controller 0]: Partition [__consumer_offsets,40] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:01:22,643] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,18] (kafka.controller.KafkaController)
[2016-11-17 17:01:22,643] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,18] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:01:22,644] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,18] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:01:22,644] WARN [Controller 0]: Partition [__consumer_offsets,18] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:01:22,644] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,0] (kafka.controller.KafkaController)
[2016-11-17 17:01:22,644] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:01:22,646] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:01:22,646] WARN [Controller 0]: Partition [__consumer_offsets,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:01:22,646] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,26] (kafka.controller.KafkaController)
[2016-11-17 17:01:22,646] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,26] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:01:22,648] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,26] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:01:22,648] WARN [Controller 0]: Partition [__consumer_offsets,26] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:01:22,648] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,24] (kafka.controller.KafkaController)
[2016-11-17 17:01:22,648] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,24] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:01:22,649] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,24] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:01:22,650] WARN [Controller 0]: Partition [__consumer_offsets,24] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:01:22,650] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,0] (kafka.controller.KafkaController)
[2016-11-17 17:01:22,650] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:01:22,651] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [othertopic,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:01:22,651] WARN [Controller 0]: Partition [othertopic,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:01:22,651] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,20] (kafka.controller.KafkaController)
[2016-11-17 17:01:22,651] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,20] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:01:22,652] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,20] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:01:22,653] WARN [Controller 0]: Partition [__consumer_offsets,20] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:01:22,653] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,22] (kafka.controller.KafkaController)
[2016-11-17 17:01:22,653] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,22] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:01:22,654] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,22] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:01:22,654] WARN [Controller 0]: Partition [__consumer_offsets,22] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:01:22,654] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,12] (kafka.controller.KafkaController)
[2016-11-17 17:01:22,654] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,12] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:01:22,655] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,12] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:01:22,656] WARN [Controller 0]: Partition [__consumer_offsets,12] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:01:22,656] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,8] (kafka.controller.KafkaController)
[2016-11-17 17:01:22,656] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,8] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:01:22,657] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,8] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:01:22,657] WARN [Controller 0]: Partition [__consumer_offsets,8] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:01:22,657] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,48] (kafka.controller.KafkaController)
[2016-11-17 17:01:22,657] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,48] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:01:22,658] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,48] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:01:22,658] WARN [Controller 0]: Partition [__consumer_offsets,48] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:01:22,658] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,6] (kafka.controller.KafkaController)
[2016-11-17 17:01:22,658] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,6] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:01:22,659] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,6] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:01:22,660] WARN [Controller 0]: Partition [__consumer_offsets,6] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:01:22,660] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,28] (kafka.controller.KafkaController)
[2016-11-17 17:01:22,660] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,28] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:01:22,661] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,28] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:01:22,661] WARN [Controller 0]: Partition [__consumer_offsets,28] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:01:22,661] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,4] (kafka.controller.KafkaController)
[2016-11-17 17:01:22,661] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,4] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:01:22,662] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,4] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:01:22,663] WARN [Controller 0]: Partition [__consumer_offsets,4] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:01:22,663] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,44] (kafka.controller.KafkaController)
[2016-11-17 17:01:22,663] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,44] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:01:22,664] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,44] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:01:22,664] WARN [Controller 0]: Partition [__consumer_offsets,44] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:01:22,664] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,42] (kafka.controller.KafkaController)
[2016-11-17 17:01:22,664] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,42] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:01:22,665] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,42] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:01:22,665] WARN [Controller 0]: Partition [__consumer_offsets,42] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:01:22,665] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,34] (kafka.controller.KafkaController)
[2016-11-17 17:01:22,665] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,34] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:01:22,666] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,34] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:01:22,667] WARN [Controller 0]: Partition [__consumer_offsets,34] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:01:22,667] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,46] (kafka.controller.KafkaController)
[2016-11-17 17:01:22,667] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,46] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:01:22,668] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,46] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:01:22,668] WARN [Controller 0]: Partition [__consumer_offsets,46] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:01:22,668] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,32] (kafka.controller.KafkaController)
[2016-11-17 17:01:22,668] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,32] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:01:22,669] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,32] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:01:22,670] WARN [Controller 0]: Partition [__consumer_offsets,32] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:01:22,670] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,36] (kafka.controller.KafkaController)
[2016-11-17 17:01:22,670] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,36] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:01:22,671] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,36] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:01:22,671] WARN [Controller 0]: Partition [__consumer_offsets,36] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:01:22,671] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,38] (kafka.controller.KafkaController)
[2016-11-17 17:01:22,671] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,38] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:01:22,672] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,38] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:01:22,672] WARN [Controller 0]: Partition [__consumer_offsets,38] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:01:22,672] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,2] (kafka.controller.KafkaController)
[2016-11-17 17:01:22,672] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:01:22,673] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:01:22,674] WARN [Controller 0]: Partition [__consumer_offsets,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:01:22,674] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,16] (kafka.controller.KafkaController)
[2016-11-17 17:01:22,674] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,16] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:01:22,675] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,16] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:01:22,675] WARN [Controller 0]: Partition [__consumer_offsets,16] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:01:22,675] DEBUG [Controller 0]: topics not in preferred replica Map([topic2,2] -> List(0, 2, 1), [othertopic,2] -> List(0, 1, 2), [topic4,0] -> List(0, 1)) (kafka.controller.KafkaController)
[2016-11-17 17:01:22,675] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.600000 (kafka.controller.KafkaController)
[2016-11-17 17:01:22,675] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic2,2] (kafka.controller.KafkaController)
[2016-11-17 17:01:22,675] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic2,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:01:22,676] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [topic2,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:01:22,677] WARN [Controller 0]: Partition [topic2,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:01:22,677] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,2] (kafka.controller.KafkaController)
[2016-11-17 17:01:22,677] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:01:22,678] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [othertopic,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:01:22,678] WARN [Controller 0]: Partition [othertopic,2] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
[2016-11-17 17:01:22,678] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic4,0] (kafka.controller.KafkaController)
[2016-11-17 17:01:22,678] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic4,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:01:22,679] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [topic4,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:01:22,679] WARN [Controller 0]: Partition [topic4,0] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
[2016-11-17 17:05:32,746] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2016-11-17 17:06:22,606] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2016-11-17 17:06:22,606] DEBUG [Controller 0]: preferred replicas by broker Map(2 -> Map([__consumer_offsets,19] -> List(2, 1), [__consumer_offsets,47] -> List(2, 1), [__consumer_offsets,41] -> List(2, 1), [__consumer_offsets,29] -> List(2, 1), [topic2,1] -> List(2, 1, 0), [__consumer_offsets,39] -> List(2, 1), [__consumer_offsets,17] -> List(2, 1), [__consumer_offsets,33] -> List(2, 1), [__consumer_offsets,5] -> List(2, 1), [__consumer_offsets,3] -> List(2, 1), [__consumer_offsets,21] -> List(2, 1), [othertopic,1] -> List(2, 0, 1), [__consumer_offsets,23] -> List(2, 1), [__consumer_offsets,15] -> List(2, 1), [__consumer_offsets,11] -> List(2, 1), [__consumer_offsets,13] -> List(2, 1), [__consumer_offsets,49] -> List(2, 1), [__consumer_offsets,37] -> List(2, 1), [__consumer_offsets,31] -> List(2, 1), [topic1,0] -> List(2), [topic3,2] -> List(2), [__consumer_offsets,25] -> List(2, 1), [__consumer_offsets,45] -> List(2, 1), [__consumer_offsets,27] -> List(2, 1), [__consumer_offsets,43] -> List(2, 1), [__consumer_offsets,35] -> List(2, 1), [__consumer_offsets,7] -> List(2, 1), [__consumer_offsets,9] -> List(2, 1), [__consumer_offsets,1] -> List(2, 1)), 1 -> Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [topic3,1] -> List(1), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [topic2,0] -> List(1, 0, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2)), 0 -> Map([othertopic,2] -> List(0, 1, 2), [topic2,2] -> List(0, 2, 1), [mytopic,0] -> List(0), [topic3,0] -> List(0), [topic4,0] -> List(0, 1))) (kafka.controller.KafkaController)
[2016-11-17 17:06:22,606] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2016-11-17 17:06:22,606] TRACE [Controller 0]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2016-11-17 17:06:22,607] DEBUG [Controller 0]: topics not in preferred replica Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2)) (kafka.controller.KafkaController)
[2016-11-17 17:06:22,607] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 0.928571 (kafka.controller.KafkaController)
[2016-11-17 17:06:22,607] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,30] (kafka.controller.KafkaController)
[2016-11-17 17:06:22,607] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,30] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:06:22,608] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,30] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:06:22,609] WARN [Controller 0]: Partition [__consumer_offsets,30] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:06:22,609] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,10] (kafka.controller.KafkaController)
[2016-11-17 17:06:22,609] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,10] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:06:22,610] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,10] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:06:22,611] WARN [Controller 0]: Partition [__consumer_offsets,10] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:06:22,611] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,14] (kafka.controller.KafkaController)
[2016-11-17 17:06:22,611] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,14] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:06:22,612] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,14] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:06:22,612] WARN [Controller 0]: Partition [__consumer_offsets,14] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:06:22,613] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,40] (kafka.controller.KafkaController)
[2016-11-17 17:06:22,613] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,40] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:06:22,614] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,40] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:06:22,614] WARN [Controller 0]: Partition [__consumer_offsets,40] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:06:22,614] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,18] (kafka.controller.KafkaController)
[2016-11-17 17:06:22,614] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,18] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:06:22,615] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,18] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:06:22,616] WARN [Controller 0]: Partition [__consumer_offsets,18] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:06:22,616] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,0] (kafka.controller.KafkaController)
[2016-11-17 17:06:22,616] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:06:22,617] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:06:22,617] WARN [Controller 0]: Partition [__consumer_offsets,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:06:22,617] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,26] (kafka.controller.KafkaController)
[2016-11-17 17:06:22,617] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,26] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:06:22,618] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,26] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:06:22,619] WARN [Controller 0]: Partition [__consumer_offsets,26] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:06:22,619] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,24] (kafka.controller.KafkaController)
[2016-11-17 17:06:22,619] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,24] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:06:22,620] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,24] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:06:22,620] WARN [Controller 0]: Partition [__consumer_offsets,24] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:06:22,620] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,0] (kafka.controller.KafkaController)
[2016-11-17 17:06:22,620] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:06:22,621] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [othertopic,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:06:22,622] WARN [Controller 0]: Partition [othertopic,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:06:22,622] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,20] (kafka.controller.KafkaController)
[2016-11-17 17:06:22,622] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,20] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:06:22,623] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,20] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:06:22,623] WARN [Controller 0]: Partition [__consumer_offsets,20] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:06:22,623] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,22] (kafka.controller.KafkaController)
[2016-11-17 17:06:22,623] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,22] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:06:22,624] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,22] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:06:22,625] WARN [Controller 0]: Partition [__consumer_offsets,22] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:06:22,625] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,12] (kafka.controller.KafkaController)
[2016-11-17 17:06:22,625] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,12] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:06:22,626] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,12] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:06:22,626] WARN [Controller 0]: Partition [__consumer_offsets,12] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:06:22,626] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,8] (kafka.controller.KafkaController)
[2016-11-17 17:06:22,626] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,8] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:06:22,627] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,8] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:06:22,627] WARN [Controller 0]: Partition [__consumer_offsets,8] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:06:22,627] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,48] (kafka.controller.KafkaController)
[2016-11-17 17:06:22,627] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,48] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:06:22,628] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,48] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:06:22,629] WARN [Controller 0]: Partition [__consumer_offsets,48] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:06:22,629] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,6] (kafka.controller.KafkaController)
[2016-11-17 17:06:22,629] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,6] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:06:22,630] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,6] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:06:22,630] WARN [Controller 0]: Partition [__consumer_offsets,6] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:06:22,630] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,28] (kafka.controller.KafkaController)
[2016-11-17 17:06:22,630] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,28] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:06:22,631] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,28] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:06:22,632] WARN [Controller 0]: Partition [__consumer_offsets,28] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:06:22,632] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,4] (kafka.controller.KafkaController)
[2016-11-17 17:06:22,632] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,4] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:06:22,632] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,4] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:06:22,633] WARN [Controller 0]: Partition [__consumer_offsets,4] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:06:22,633] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,44] (kafka.controller.KafkaController)
[2016-11-17 17:06:22,633] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,44] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:06:22,634] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,44] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:06:22,634] WARN [Controller 0]: Partition [__consumer_offsets,44] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:06:22,634] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,42] (kafka.controller.KafkaController)
[2016-11-17 17:06:22,634] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,42] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:06:22,635] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,42] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:06:22,636] WARN [Controller 0]: Partition [__consumer_offsets,42] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:06:22,636] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,34] (kafka.controller.KafkaController)
[2016-11-17 17:06:22,636] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,34] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:06:22,637] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,34] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:06:22,637] WARN [Controller 0]: Partition [__consumer_offsets,34] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:06:22,637] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,46] (kafka.controller.KafkaController)
[2016-11-17 17:06:22,637] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,46] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:06:22,638] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,46] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:06:22,638] WARN [Controller 0]: Partition [__consumer_offsets,46] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:06:22,638] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,32] (kafka.controller.KafkaController)
[2016-11-17 17:06:22,638] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,32] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:06:22,639] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,32] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:06:22,640] WARN [Controller 0]: Partition [__consumer_offsets,32] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:06:22,640] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,36] (kafka.controller.KafkaController)
[2016-11-17 17:06:22,640] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,36] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:06:22,641] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,36] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:06:22,641] WARN [Controller 0]: Partition [__consumer_offsets,36] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:06:22,641] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,38] (kafka.controller.KafkaController)
[2016-11-17 17:06:22,641] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,38] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:06:22,642] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,38] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:06:22,642] WARN [Controller 0]: Partition [__consumer_offsets,38] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:06:22,642] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,2] (kafka.controller.KafkaController)
[2016-11-17 17:06:22,642] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:06:22,643] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:06:22,644] WARN [Controller 0]: Partition [__consumer_offsets,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:06:22,644] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,16] (kafka.controller.KafkaController)
[2016-11-17 17:06:22,644] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,16] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:06:22,645] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,16] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:06:22,645] WARN [Controller 0]: Partition [__consumer_offsets,16] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:06:22,645] DEBUG [Controller 0]: topics not in preferred replica Map([topic2,2] -> List(0, 2, 1), [othertopic,2] -> List(0, 1, 2), [topic4,0] -> List(0, 1)) (kafka.controller.KafkaController)
[2016-11-17 17:06:22,645] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.600000 (kafka.controller.KafkaController)
[2016-11-17 17:06:22,645] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic2,2] (kafka.controller.KafkaController)
[2016-11-17 17:06:22,645] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic2,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:06:22,646] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [topic2,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:06:22,646] WARN [Controller 0]: Partition [topic2,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:06:22,646] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,2] (kafka.controller.KafkaController)
[2016-11-17 17:06:22,646] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:06:22,647] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [othertopic,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:06:22,648] WARN [Controller 0]: Partition [othertopic,2] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
[2016-11-17 17:06:22,648] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic4,0] (kafka.controller.KafkaController)
[2016-11-17 17:06:22,648] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic4,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:06:22,649] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [topic4,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:06:22,649] WARN [Controller 0]: Partition [topic4,0] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
[2016-11-17 17:11:22,594] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2016-11-17 17:11:22,608] DEBUG [Controller 0]: preferred replicas by broker Map(2 -> Map([__consumer_offsets,19] -> List(2, 1), [__consumer_offsets,47] -> List(2, 1), [__consumer_offsets,41] -> List(2, 1), [__consumer_offsets,29] -> List(2, 1), [topic2,1] -> List(2, 1, 0), [__consumer_offsets,39] -> List(2, 1), [__consumer_offsets,17] -> List(2, 1), [__consumer_offsets,33] -> List(2, 1), [__consumer_offsets,5] -> List(2, 1), [__consumer_offsets,3] -> List(2, 1), [__consumer_offsets,21] -> List(2, 1), [othertopic,1] -> List(2, 0, 1), [__consumer_offsets,23] -> List(2, 1), [__consumer_offsets,15] -> List(2, 1), [__consumer_offsets,11] -> List(2, 1), [__consumer_offsets,13] -> List(2, 1), [__consumer_offsets,49] -> List(2, 1), [__consumer_offsets,37] -> List(2, 1), [__consumer_offsets,31] -> List(2, 1), [topic1,0] -> List(2), [topic3,2] -> List(2), [__consumer_offsets,25] -> List(2, 1), [__consumer_offsets,45] -> List(2, 1), [__consumer_offsets,27] -> List(2, 1), [__consumer_offsets,43] -> List(2, 1), [__consumer_offsets,35] -> List(2, 1), [__consumer_offsets,7] -> List(2, 1), [__consumer_offsets,9] -> List(2, 1), [__consumer_offsets,1] -> List(2, 1)), 1 -> Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [topic3,1] -> List(1), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [topic2,0] -> List(1, 0, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2)), 0 -> Map([othertopic,2] -> List(0, 1, 2), [topic2,2] -> List(0, 2, 1), [mytopic,0] -> List(0), [topic3,0] -> List(0), [topic4,0] -> List(0, 1))) (kafka.controller.KafkaController)
[2016-11-17 17:11:22,608] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2016-11-17 17:11:22,608] TRACE [Controller 0]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2016-11-17 17:11:22,608] DEBUG [Controller 0]: topics not in preferred replica Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2)) (kafka.controller.KafkaController)
[2016-11-17 17:11:22,608] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 0.928571 (kafka.controller.KafkaController)
[2016-11-17 17:11:22,608] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,30] (kafka.controller.KafkaController)
[2016-11-17 17:11:22,609] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,30] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:11:22,611] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,30] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:11:22,612] WARN [Controller 0]: Partition [__consumer_offsets,30] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:11:22,612] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,10] (kafka.controller.KafkaController)
[2016-11-17 17:11:22,612] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,10] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:11:22,614] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,10] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:11:22,615] WARN [Controller 0]: Partition [__consumer_offsets,10] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:11:22,615] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,14] (kafka.controller.KafkaController)
[2016-11-17 17:11:22,615] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,14] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:11:22,616] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,14] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:11:22,616] WARN [Controller 0]: Partition [__consumer_offsets,14] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:11:22,617] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,40] (kafka.controller.KafkaController)
[2016-11-17 17:11:22,617] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,40] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:11:22,618] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,40] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:11:22,619] WARN [Controller 0]: Partition [__consumer_offsets,40] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:11:22,619] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,18] (kafka.controller.KafkaController)
[2016-11-17 17:11:22,619] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,18] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:11:22,620] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,18] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:11:22,621] WARN [Controller 0]: Partition [__consumer_offsets,18] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:11:22,621] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,0] (kafka.controller.KafkaController)
[2016-11-17 17:11:22,621] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:11:22,623] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:11:22,624] WARN [Controller 0]: Partition [__consumer_offsets,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:11:22,624] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,26] (kafka.controller.KafkaController)
[2016-11-17 17:11:22,625] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,26] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:11:22,626] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,26] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:11:22,626] WARN [Controller 0]: Partition [__consumer_offsets,26] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:11:22,626] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,24] (kafka.controller.KafkaController)
[2016-11-17 17:11:22,626] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,24] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:11:22,627] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,24] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:11:22,628] WARN [Controller 0]: Partition [__consumer_offsets,24] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:11:22,628] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,0] (kafka.controller.KafkaController)
[2016-11-17 17:11:22,628] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:11:22,629] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [othertopic,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:11:22,629] WARN [Controller 0]: Partition [othertopic,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:11:22,629] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,20] (kafka.controller.KafkaController)
[2016-11-17 17:11:22,629] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,20] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:11:22,630] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,20] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:11:22,631] WARN [Controller 0]: Partition [__consumer_offsets,20] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:11:22,631] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,22] (kafka.controller.KafkaController)
[2016-11-17 17:11:22,631] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,22] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:11:22,632] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,22] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:11:22,632] WARN [Controller 0]: Partition [__consumer_offsets,22] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:11:22,633] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,12] (kafka.controller.KafkaController)
[2016-11-17 17:11:22,633] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,12] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:11:22,636] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,12] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:11:22,637] WARN [Controller 0]: Partition [__consumer_offsets,12] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:11:22,637] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,8] (kafka.controller.KafkaController)
[2016-11-17 17:11:22,637] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,8] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:11:22,639] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,8] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:11:22,639] WARN [Controller 0]: Partition [__consumer_offsets,8] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:11:22,639] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,48] (kafka.controller.KafkaController)
[2016-11-17 17:11:22,639] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,48] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:11:22,640] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,48] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:11:22,641] WARN [Controller 0]: Partition [__consumer_offsets,48] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:11:22,641] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,6] (kafka.controller.KafkaController)
[2016-11-17 17:11:22,641] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,6] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:11:22,642] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,6] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:11:22,643] WARN [Controller 0]: Partition [__consumer_offsets,6] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:11:22,643] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,28] (kafka.controller.KafkaController)
[2016-11-17 17:11:22,643] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,28] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:11:22,644] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,28] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:11:22,644] WARN [Controller 0]: Partition [__consumer_offsets,28] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:11:22,644] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,4] (kafka.controller.KafkaController)
[2016-11-17 17:11:22,644] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,4] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:11:22,645] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,4] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:11:22,645] WARN [Controller 0]: Partition [__consumer_offsets,4] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:11:22,646] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,44] (kafka.controller.KafkaController)
[2016-11-17 17:11:22,646] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,44] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:11:22,647] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,44] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:11:22,647] WARN [Controller 0]: Partition [__consumer_offsets,44] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:11:22,647] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,42] (kafka.controller.KafkaController)
[2016-11-17 17:11:22,647] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,42] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:11:22,648] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,42] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:11:22,648] WARN [Controller 0]: Partition [__consumer_offsets,42] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:11:22,648] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,34] (kafka.controller.KafkaController)
[2016-11-17 17:11:22,648] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,34] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:11:22,650] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,34] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:11:22,651] WARN [Controller 0]: Partition [__consumer_offsets,34] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:11:22,651] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,46] (kafka.controller.KafkaController)
[2016-11-17 17:11:22,651] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,46] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:11:22,652] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,46] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:11:22,653] WARN [Controller 0]: Partition [__consumer_offsets,46] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:11:22,653] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,32] (kafka.controller.KafkaController)
[2016-11-17 17:11:22,653] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,32] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:11:22,654] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,32] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:11:22,654] WARN [Controller 0]: Partition [__consumer_offsets,32] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:11:22,654] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,36] (kafka.controller.KafkaController)
[2016-11-17 17:11:22,654] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,36] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:11:22,655] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,36] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:11:22,655] WARN [Controller 0]: Partition [__consumer_offsets,36] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:11:22,655] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,38] (kafka.controller.KafkaController)
[2016-11-17 17:11:22,656] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,38] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:11:22,656] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,38] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:11:22,657] WARN [Controller 0]: Partition [__consumer_offsets,38] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:11:22,657] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,2] (kafka.controller.KafkaController)
[2016-11-17 17:11:22,657] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:11:22,658] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:11:22,658] WARN [Controller 0]: Partition [__consumer_offsets,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:11:22,658] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,16] (kafka.controller.KafkaController)
[2016-11-17 17:11:22,658] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,16] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:11:22,659] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,16] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:11:22,660] WARN [Controller 0]: Partition [__consumer_offsets,16] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:11:22,660] DEBUG [Controller 0]: topics not in preferred replica Map([topic2,2] -> List(0, 2, 1), [othertopic,2] -> List(0, 1, 2), [topic4,0] -> List(0, 1)) (kafka.controller.KafkaController)
[2016-11-17 17:11:22,660] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.600000 (kafka.controller.KafkaController)
[2016-11-17 17:11:22,660] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic2,2] (kafka.controller.KafkaController)
[2016-11-17 17:11:22,660] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic2,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:11:22,661] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [topic2,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:11:22,661] WARN [Controller 0]: Partition [topic2,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:11:22,661] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,2] (kafka.controller.KafkaController)
[2016-11-17 17:11:22,661] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:11:22,662] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [othertopic,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:11:22,663] WARN [Controller 0]: Partition [othertopic,2] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
[2016-11-17 17:11:22,663] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic4,0] (kafka.controller.KafkaController)
[2016-11-17 17:11:22,663] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic4,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:11:22,664] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [topic4,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:11:22,664] WARN [Controller 0]: Partition [topic4,0] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
[2016-11-17 17:16:22,576] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2016-11-17 17:16:22,577] DEBUG [Controller 0]: preferred replicas by broker Map(2 -> Map([__consumer_offsets,19] -> List(2, 1), [__consumer_offsets,47] -> List(2, 1), [__consumer_offsets,41] -> List(2, 1), [__consumer_offsets,29] -> List(2, 1), [topic2,1] -> List(2, 1, 0), [__consumer_offsets,39] -> List(2, 1), [__consumer_offsets,17] -> List(2, 1), [__consumer_offsets,33] -> List(2, 1), [__consumer_offsets,5] -> List(2, 1), [__consumer_offsets,3] -> List(2, 1), [__consumer_offsets,21] -> List(2, 1), [othertopic,1] -> List(2, 0, 1), [__consumer_offsets,23] -> List(2, 1), [__consumer_offsets,15] -> List(2, 1), [__consumer_offsets,11] -> List(2, 1), [__consumer_offsets,13] -> List(2, 1), [__consumer_offsets,49] -> List(2, 1), [__consumer_offsets,37] -> List(2, 1), [__consumer_offsets,31] -> List(2, 1), [topic1,0] -> List(2), [topic3,2] -> List(2), [__consumer_offsets,25] -> List(2, 1), [__consumer_offsets,45] -> List(2, 1), [__consumer_offsets,27] -> List(2, 1), [__consumer_offsets,43] -> List(2, 1), [__consumer_offsets,35] -> List(2, 1), [__consumer_offsets,7] -> List(2, 1), [__consumer_offsets,9] -> List(2, 1), [__consumer_offsets,1] -> List(2, 1)), 1 -> Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [topic3,1] -> List(1), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [topic2,0] -> List(1, 0, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2)), 0 -> Map([othertopic,2] -> List(0, 1, 2), [topic2,2] -> List(0, 2, 1), [mytopic,0] -> List(0), [topic3,0] -> List(0), [topic4,0] -> List(0, 1))) (kafka.controller.KafkaController)
[2016-11-17 17:16:22,577] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2016-11-17 17:16:22,577] TRACE [Controller 0]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2016-11-17 17:16:22,577] DEBUG [Controller 0]: topics not in preferred replica Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2)) (kafka.controller.KafkaController)
[2016-11-17 17:16:22,577] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 0.928571 (kafka.controller.KafkaController)
[2016-11-17 17:16:22,577] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,30] (kafka.controller.KafkaController)
[2016-11-17 17:16:22,577] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,30] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:16:22,579] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,30] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:16:22,579] WARN [Controller 0]: Partition [__consumer_offsets,30] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:16:22,579] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,10] (kafka.controller.KafkaController)
[2016-11-17 17:16:22,579] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,10] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:16:22,581] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,10] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:16:22,581] WARN [Controller 0]: Partition [__consumer_offsets,10] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:16:22,581] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,14] (kafka.controller.KafkaController)
[2016-11-17 17:16:22,581] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,14] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:16:22,582] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,14] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:16:22,583] WARN [Controller 0]: Partition [__consumer_offsets,14] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:16:22,583] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,40] (kafka.controller.KafkaController)
[2016-11-17 17:16:22,583] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,40] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:16:22,584] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,40] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:16:22,584] WARN [Controller 0]: Partition [__consumer_offsets,40] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:16:22,585] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,18] (kafka.controller.KafkaController)
[2016-11-17 17:16:22,585] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,18] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:16:22,586] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,18] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:16:22,586] WARN [Controller 0]: Partition [__consumer_offsets,18] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:16:22,587] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,0] (kafka.controller.KafkaController)
[2016-11-17 17:16:22,587] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:16:22,588] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:16:22,588] WARN [Controller 0]: Partition [__consumer_offsets,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:16:22,588] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,26] (kafka.controller.KafkaController)
[2016-11-17 17:16:22,588] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,26] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:16:22,589] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,26] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:16:22,589] WARN [Controller 0]: Partition [__consumer_offsets,26] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:16:22,589] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,24] (kafka.controller.KafkaController)
[2016-11-17 17:16:22,590] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,24] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:16:22,591] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,24] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:16:22,591] WARN [Controller 0]: Partition [__consumer_offsets,24] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:16:22,591] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,0] (kafka.controller.KafkaController)
[2016-11-17 17:16:22,591] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:16:22,592] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [othertopic,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:16:22,592] WARN [Controller 0]: Partition [othertopic,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:16:22,592] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,20] (kafka.controller.KafkaController)
[2016-11-17 17:16:22,592] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,20] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:16:22,594] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,20] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:16:22,594] WARN [Controller 0]: Partition [__consumer_offsets,20] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:16:22,594] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,22] (kafka.controller.KafkaController)
[2016-11-17 17:16:22,594] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,22] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:16:22,595] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,22] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:16:22,596] WARN [Controller 0]: Partition [__consumer_offsets,22] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:16:22,596] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,12] (kafka.controller.KafkaController)
[2016-11-17 17:16:22,596] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,12] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:16:22,597] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,12] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:16:22,597] WARN [Controller 0]: Partition [__consumer_offsets,12] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:16:22,597] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,8] (kafka.controller.KafkaController)
[2016-11-17 17:16:22,597] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,8] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:16:22,598] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,8] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:16:22,598] WARN [Controller 0]: Partition [__consumer_offsets,8] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:16:22,599] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,48] (kafka.controller.KafkaController)
[2016-11-17 17:16:22,599] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,48] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:16:22,600] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,48] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:16:22,600] WARN [Controller 0]: Partition [__consumer_offsets,48] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:16:22,600] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,6] (kafka.controller.KafkaController)
[2016-11-17 17:16:22,600] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,6] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:16:22,601] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,6] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:16:22,601] WARN [Controller 0]: Partition [__consumer_offsets,6] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:16:22,602] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,28] (kafka.controller.KafkaController)
[2016-11-17 17:16:22,602] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,28] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:16:22,603] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,28] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:16:22,603] WARN [Controller 0]: Partition [__consumer_offsets,28] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:16:22,603] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,4] (kafka.controller.KafkaController)
[2016-11-17 17:16:22,603] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,4] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:16:22,604] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,4] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:16:22,604] WARN [Controller 0]: Partition [__consumer_offsets,4] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:16:22,604] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,44] (kafka.controller.KafkaController)
[2016-11-17 17:16:22,604] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,44] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:16:22,605] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,44] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:16:22,606] WARN [Controller 0]: Partition [__consumer_offsets,44] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:16:22,606] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,42] (kafka.controller.KafkaController)
[2016-11-17 17:16:22,606] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,42] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:16:22,607] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,42] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:16:22,607] WARN [Controller 0]: Partition [__consumer_offsets,42] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:16:22,607] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,34] (kafka.controller.KafkaController)
[2016-11-17 17:16:22,607] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,34] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:16:22,608] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,34] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:16:22,609] WARN [Controller 0]: Partition [__consumer_offsets,34] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:16:22,609] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,46] (kafka.controller.KafkaController)
[2016-11-17 17:16:22,609] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,46] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:16:22,610] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,46] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:16:22,610] WARN [Controller 0]: Partition [__consumer_offsets,46] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:16:22,610] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,32] (kafka.controller.KafkaController)
[2016-11-17 17:16:22,610] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,32] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:16:22,611] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,32] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:16:22,611] WARN [Controller 0]: Partition [__consumer_offsets,32] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:16:22,611] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,36] (kafka.controller.KafkaController)
[2016-11-17 17:16:22,611] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,36] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:16:22,612] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,36] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:16:22,613] WARN [Controller 0]: Partition [__consumer_offsets,36] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:16:22,613] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,38] (kafka.controller.KafkaController)
[2016-11-17 17:16:22,613] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,38] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:16:22,614] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,38] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:16:22,614] WARN [Controller 0]: Partition [__consumer_offsets,38] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:16:22,614] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,2] (kafka.controller.KafkaController)
[2016-11-17 17:16:22,614] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:16:22,615] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:16:22,616] WARN [Controller 0]: Partition [__consumer_offsets,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:16:22,616] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,16] (kafka.controller.KafkaController)
[2016-11-17 17:16:22,616] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,16] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:16:22,617] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,16] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:16:22,617] WARN [Controller 0]: Partition [__consumer_offsets,16] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:16:22,617] DEBUG [Controller 0]: topics not in preferred replica Map([topic2,2] -> List(0, 2, 1), [othertopic,2] -> List(0, 1, 2), [topic4,0] -> List(0, 1)) (kafka.controller.KafkaController)
[2016-11-17 17:16:22,617] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.600000 (kafka.controller.KafkaController)
[2016-11-17 17:16:22,617] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic2,2] (kafka.controller.KafkaController)
[2016-11-17 17:16:22,617] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic2,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:16:22,618] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [topic2,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:16:22,619] WARN [Controller 0]: Partition [topic2,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:16:22,619] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,2] (kafka.controller.KafkaController)
[2016-11-17 17:16:22,619] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:16:22,620] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [othertopic,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:16:22,620] WARN [Controller 0]: Partition [othertopic,2] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
[2016-11-17 17:16:22,620] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic4,0] (kafka.controller.KafkaController)
[2016-11-17 17:16:22,620] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic4,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:16:22,621] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [topic4,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:16:22,622] WARN [Controller 0]: Partition [topic4,0] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
[2016-11-17 17:21:22,567] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2016-11-17 17:21:22,567] DEBUG [Controller 0]: preferred replicas by broker Map(2 -> Map([__consumer_offsets,19] -> List(2, 1), [__consumer_offsets,47] -> List(2, 1), [__consumer_offsets,41] -> List(2, 1), [__consumer_offsets,29] -> List(2, 1), [topic2,1] -> List(2, 1, 0), [__consumer_offsets,39] -> List(2, 1), [__consumer_offsets,17] -> List(2, 1), [__consumer_offsets,33] -> List(2, 1), [__consumer_offsets,5] -> List(2, 1), [__consumer_offsets,3] -> List(2, 1), [__consumer_offsets,21] -> List(2, 1), [othertopic,1] -> List(2, 0, 1), [__consumer_offsets,23] -> List(2, 1), [__consumer_offsets,15] -> List(2, 1), [__consumer_offsets,11] -> List(2, 1), [__consumer_offsets,13] -> List(2, 1), [__consumer_offsets,49] -> List(2, 1), [__consumer_offsets,37] -> List(2, 1), [__consumer_offsets,31] -> List(2, 1), [topic1,0] -> List(2), [topic3,2] -> List(2), [__consumer_offsets,25] -> List(2, 1), [__consumer_offsets,45] -> List(2, 1), [__consumer_offsets,27] -> List(2, 1), [__consumer_offsets,43] -> List(2, 1), [__consumer_offsets,35] -> List(2, 1), [__consumer_offsets,7] -> List(2, 1), [__consumer_offsets,9] -> List(2, 1), [__consumer_offsets,1] -> List(2, 1)), 1 -> Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [topic3,1] -> List(1), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [topic2,0] -> List(1, 0, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2)), 0 -> Map([othertopic,2] -> List(0, 1, 2), [topic2,2] -> List(0, 2, 1), [mytopic,0] -> List(0), [topic3,0] -> List(0), [topic4,0] -> List(0, 1))) (kafka.controller.KafkaController)
[2016-11-17 17:21:22,568] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2016-11-17 17:21:22,568] TRACE [Controller 0]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2016-11-17 17:21:22,568] DEBUG [Controller 0]: topics not in preferred replica Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2)) (kafka.controller.KafkaController)
[2016-11-17 17:21:22,568] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 0.928571 (kafka.controller.KafkaController)
[2016-11-17 17:21:22,568] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,30] (kafka.controller.KafkaController)
[2016-11-17 17:21:22,568] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,30] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:21:22,569] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,30] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:21:22,570] WARN [Controller 0]: Partition [__consumer_offsets,30] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:21:22,570] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,10] (kafka.controller.KafkaController)
[2016-11-17 17:21:22,570] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,10] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:21:22,571] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,10] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:21:22,572] WARN [Controller 0]: Partition [__consumer_offsets,10] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:21:22,572] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,14] (kafka.controller.KafkaController)
[2016-11-17 17:21:22,572] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,14] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:21:22,573] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,14] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:21:22,574] WARN [Controller 0]: Partition [__consumer_offsets,14] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:21:22,574] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,40] (kafka.controller.KafkaController)
[2016-11-17 17:21:22,574] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,40] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:21:22,575] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,40] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:21:22,575] WARN [Controller 0]: Partition [__consumer_offsets,40] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:21:22,575] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,18] (kafka.controller.KafkaController)
[2016-11-17 17:21:22,576] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,18] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:21:22,577] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,18] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:21:22,577] WARN [Controller 0]: Partition [__consumer_offsets,18] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:21:22,577] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,0] (kafka.controller.KafkaController)
[2016-11-17 17:21:22,577] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:21:22,578] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:21:22,579] WARN [Controller 0]: Partition [__consumer_offsets,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:21:22,579] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,26] (kafka.controller.KafkaController)
[2016-11-17 17:21:22,579] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,26] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:21:22,580] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,26] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:21:22,580] WARN [Controller 0]: Partition [__consumer_offsets,26] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:21:22,580] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,24] (kafka.controller.KafkaController)
[2016-11-17 17:21:22,580] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,24] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:21:22,582] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,24] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:21:22,582] WARN [Controller 0]: Partition [__consumer_offsets,24] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:21:22,582] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,0] (kafka.controller.KafkaController)
[2016-11-17 17:21:22,582] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:21:22,584] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [othertopic,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:21:22,584] WARN [Controller 0]: Partition [othertopic,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:21:22,584] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,20] (kafka.controller.KafkaController)
[2016-11-17 17:21:22,584] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,20] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:21:22,585] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,20] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:21:22,586] WARN [Controller 0]: Partition [__consumer_offsets,20] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:21:22,586] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,22] (kafka.controller.KafkaController)
[2016-11-17 17:21:22,586] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,22] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:21:22,587] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,22] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:21:22,588] WARN [Controller 0]: Partition [__consumer_offsets,22] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:21:22,588] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,12] (kafka.controller.KafkaController)
[2016-11-17 17:21:22,588] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,12] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:21:22,590] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,12] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:21:22,590] WARN [Controller 0]: Partition [__consumer_offsets,12] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:21:22,590] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,8] (kafka.controller.KafkaController)
[2016-11-17 17:21:22,590] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,8] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:21:22,591] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,8] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:21:22,592] WARN [Controller 0]: Partition [__consumer_offsets,8] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:21:22,592] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,48] (kafka.controller.KafkaController)
[2016-11-17 17:21:22,592] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,48] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:21:22,594] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,48] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:21:22,594] WARN [Controller 0]: Partition [__consumer_offsets,48] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:21:22,594] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,6] (kafka.controller.KafkaController)
[2016-11-17 17:21:22,594] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,6] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:21:22,595] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,6] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:21:22,596] WARN [Controller 0]: Partition [__consumer_offsets,6] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:21:22,596] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,28] (kafka.controller.KafkaController)
[2016-11-17 17:21:22,596] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,28] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:21:22,597] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,28] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:21:22,598] WARN [Controller 0]: Partition [__consumer_offsets,28] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:21:22,598] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,4] (kafka.controller.KafkaController)
[2016-11-17 17:21:22,598] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,4] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:21:22,599] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,4] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:21:22,599] WARN [Controller 0]: Partition [__consumer_offsets,4] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:21:22,599] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,44] (kafka.controller.KafkaController)
[2016-11-17 17:21:22,599] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,44] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:21:22,600] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,44] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:21:22,601] WARN [Controller 0]: Partition [__consumer_offsets,44] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:21:22,601] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,42] (kafka.controller.KafkaController)
[2016-11-17 17:21:22,601] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,42] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:21:22,602] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,42] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:21:22,603] WARN [Controller 0]: Partition [__consumer_offsets,42] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:21:22,603] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,34] (kafka.controller.KafkaController)
[2016-11-17 17:21:22,603] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,34] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:21:22,604] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,34] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:21:22,604] WARN [Controller 0]: Partition [__consumer_offsets,34] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:21:22,605] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,46] (kafka.controller.KafkaController)
[2016-11-17 17:21:22,605] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,46] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:21:22,606] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,46] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:21:22,606] WARN [Controller 0]: Partition [__consumer_offsets,46] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:21:22,607] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,32] (kafka.controller.KafkaController)
[2016-11-17 17:21:22,607] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,32] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:21:22,608] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,32] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:21:22,608] WARN [Controller 0]: Partition [__consumer_offsets,32] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:21:22,608] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,36] (kafka.controller.KafkaController)
[2016-11-17 17:21:22,608] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,36] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:21:22,609] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,36] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:21:22,610] WARN [Controller 0]: Partition [__consumer_offsets,36] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:21:22,610] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,38] (kafka.controller.KafkaController)
[2016-11-17 17:21:22,610] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,38] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:21:22,612] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,38] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:21:22,612] WARN [Controller 0]: Partition [__consumer_offsets,38] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:21:22,612] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,2] (kafka.controller.KafkaController)
[2016-11-17 17:21:22,612] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:21:22,613] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:21:22,614] WARN [Controller 0]: Partition [__consumer_offsets,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:21:22,614] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,16] (kafka.controller.KafkaController)
[2016-11-17 17:21:22,614] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,16] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:21:22,615] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,16] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:21:22,616] WARN [Controller 0]: Partition [__consumer_offsets,16] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:21:22,616] DEBUG [Controller 0]: topics not in preferred replica Map([topic2,2] -> List(0, 2, 1), [othertopic,2] -> List(0, 1, 2), [topic4,0] -> List(0, 1)) (kafka.controller.KafkaController)
[2016-11-17 17:21:22,616] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.600000 (kafka.controller.KafkaController)
[2016-11-17 17:21:22,616] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic2,2] (kafka.controller.KafkaController)
[2016-11-17 17:21:22,616] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic2,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:21:22,617] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [topic2,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:21:22,618] WARN [Controller 0]: Partition [topic2,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:21:22,618] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,2] (kafka.controller.KafkaController)
[2016-11-17 17:21:22,618] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:21:22,619] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [othertopic,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:21:22,619] WARN [Controller 0]: Partition [othertopic,2] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
[2016-11-17 17:21:22,619] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic4,0] (kafka.controller.KafkaController)
[2016-11-17 17:21:22,619] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic4,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:21:22,621] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [topic4,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:21:22,621] WARN [Controller 0]: Partition [topic4,0] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
[2016-11-17 17:26:22,550] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2016-11-17 17:26:22,551] DEBUG [Controller 0]: preferred replicas by broker Map(2 -> Map([__consumer_offsets,19] -> List(2, 1), [__consumer_offsets,47] -> List(2, 1), [__consumer_offsets,41] -> List(2, 1), [__consumer_offsets,29] -> List(2, 1), [topic2,1] -> List(2, 1, 0), [__consumer_offsets,39] -> List(2, 1), [__consumer_offsets,17] -> List(2, 1), [__consumer_offsets,33] -> List(2, 1), [__consumer_offsets,5] -> List(2, 1), [__consumer_offsets,3] -> List(2, 1), [__consumer_offsets,21] -> List(2, 1), [othertopic,1] -> List(2, 0, 1), [__consumer_offsets,23] -> List(2, 1), [__consumer_offsets,15] -> List(2, 1), [__consumer_offsets,11] -> List(2, 1), [__consumer_offsets,13] -> List(2, 1), [__consumer_offsets,49] -> List(2, 1), [__consumer_offsets,37] -> List(2, 1), [__consumer_offsets,31] -> List(2, 1), [topic1,0] -> List(2), [topic3,2] -> List(2), [__consumer_offsets,25] -> List(2, 1), [__consumer_offsets,45] -> List(2, 1), [__consumer_offsets,27] -> List(2, 1), [__consumer_offsets,43] -> List(2, 1), [__consumer_offsets,35] -> List(2, 1), [__consumer_offsets,7] -> List(2, 1), [__consumer_offsets,9] -> List(2, 1), [__consumer_offsets,1] -> List(2, 1)), 1 -> Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [topic3,1] -> List(1), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [topic2,0] -> List(1, 0, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2)), 0 -> Map([othertopic,2] -> List(0, 1, 2), [topic2,2] -> List(0, 2, 1), [mytopic,0] -> List(0), [topic3,0] -> List(0), [topic4,0] -> List(0, 1))) (kafka.controller.KafkaController)
[2016-11-17 17:26:22,551] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2016-11-17 17:26:22,551] TRACE [Controller 0]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2016-11-17 17:26:22,552] DEBUG [Controller 0]: topics not in preferred replica Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2)) (kafka.controller.KafkaController)
[2016-11-17 17:26:22,552] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 0.928571 (kafka.controller.KafkaController)
[2016-11-17 17:26:22,552] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,30] (kafka.controller.KafkaController)
[2016-11-17 17:26:22,552] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,30] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:26:22,554] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,30] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:26:22,554] WARN [Controller 0]: Partition [__consumer_offsets,30] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:26:22,554] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,10] (kafka.controller.KafkaController)
[2016-11-17 17:26:22,554] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,10] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:26:22,556] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,10] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:26:22,557] WARN [Controller 0]: Partition [__consumer_offsets,10] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:26:22,557] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,14] (kafka.controller.KafkaController)
[2016-11-17 17:26:22,557] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,14] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:26:22,558] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,14] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:26:22,559] WARN [Controller 0]: Partition [__consumer_offsets,14] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:26:22,559] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,40] (kafka.controller.KafkaController)
[2016-11-17 17:26:22,559] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,40] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:26:22,560] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,40] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:26:22,560] WARN [Controller 0]: Partition [__consumer_offsets,40] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:26:22,560] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,18] (kafka.controller.KafkaController)
[2016-11-17 17:26:22,560] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,18] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:26:22,562] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,18] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:26:22,562] WARN [Controller 0]: Partition [__consumer_offsets,18] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:26:22,562] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,0] (kafka.controller.KafkaController)
[2016-11-17 17:26:22,562] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:26:22,564] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:26:22,564] WARN [Controller 0]: Partition [__consumer_offsets,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:26:22,564] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,26] (kafka.controller.KafkaController)
[2016-11-17 17:26:22,564] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,26] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:26:22,565] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,26] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:26:22,566] WARN [Controller 0]: Partition [__consumer_offsets,26] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:26:22,566] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,24] (kafka.controller.KafkaController)
[2016-11-17 17:26:22,566] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,24] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:26:22,568] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,24] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:26:22,569] WARN [Controller 0]: Partition [__consumer_offsets,24] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:26:22,569] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,0] (kafka.controller.KafkaController)
[2016-11-17 17:26:22,569] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:26:22,570] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [othertopic,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:26:22,570] WARN [Controller 0]: Partition [othertopic,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:26:22,570] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,20] (kafka.controller.KafkaController)
[2016-11-17 17:26:22,570] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,20] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:26:22,571] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,20] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:26:22,572] WARN [Controller 0]: Partition [__consumer_offsets,20] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:26:22,572] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,22] (kafka.controller.KafkaController)
[2016-11-17 17:26:22,572] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,22] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:26:22,573] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,22] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:26:22,574] WARN [Controller 0]: Partition [__consumer_offsets,22] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:26:22,574] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,12] (kafka.controller.KafkaController)
[2016-11-17 17:26:22,574] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,12] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:26:22,575] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,12] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:26:22,575] WARN [Controller 0]: Partition [__consumer_offsets,12] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:26:22,575] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,8] (kafka.controller.KafkaController)
[2016-11-17 17:26:22,576] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,8] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:26:22,577] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,8] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:26:22,577] WARN [Controller 0]: Partition [__consumer_offsets,8] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:26:22,577] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,48] (kafka.controller.KafkaController)
[2016-11-17 17:26:22,577] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,48] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:26:22,578] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,48] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:26:22,579] WARN [Controller 0]: Partition [__consumer_offsets,48] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:26:22,579] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,6] (kafka.controller.KafkaController)
[2016-11-17 17:26:22,579] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,6] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:26:22,581] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,6] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:26:22,581] WARN [Controller 0]: Partition [__consumer_offsets,6] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:26:22,581] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,28] (kafka.controller.KafkaController)
[2016-11-17 17:26:22,581] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,28] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:26:22,582] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,28] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:26:22,582] WARN [Controller 0]: Partition [__consumer_offsets,28] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:26:22,582] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,4] (kafka.controller.KafkaController)
[2016-11-17 17:26:22,582] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,4] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:26:22,585] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,4] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:26:22,585] WARN [Controller 0]: Partition [__consumer_offsets,4] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:26:22,585] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,44] (kafka.controller.KafkaController)
[2016-11-17 17:26:22,586] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,44] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:26:22,588] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,44] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:26:22,588] WARN [Controller 0]: Partition [__consumer_offsets,44] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:26:22,588] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,42] (kafka.controller.KafkaController)
[2016-11-17 17:26:22,588] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,42] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:26:22,591] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,42] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:26:22,592] WARN [Controller 0]: Partition [__consumer_offsets,42] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:26:22,592] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,34] (kafka.controller.KafkaController)
[2016-11-17 17:26:22,592] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,34] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:26:22,593] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,34] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:26:22,594] WARN [Controller 0]: Partition [__consumer_offsets,34] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:26:22,594] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,46] (kafka.controller.KafkaController)
[2016-11-17 17:26:22,594] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,46] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:26:22,595] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,46] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:26:22,595] WARN [Controller 0]: Partition [__consumer_offsets,46] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:26:22,595] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,32] (kafka.controller.KafkaController)
[2016-11-17 17:26:22,595] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,32] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:26:22,597] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,32] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:26:22,597] WARN [Controller 0]: Partition [__consumer_offsets,32] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:26:22,597] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,36] (kafka.controller.KafkaController)
[2016-11-17 17:26:22,597] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,36] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:26:22,599] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,36] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:26:22,599] WARN [Controller 0]: Partition [__consumer_offsets,36] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:26:22,599] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,38] (kafka.controller.KafkaController)
[2016-11-17 17:26:22,599] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,38] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:26:22,600] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,38] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:26:22,601] WARN [Controller 0]: Partition [__consumer_offsets,38] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:26:22,601] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,2] (kafka.controller.KafkaController)
[2016-11-17 17:26:22,601] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:26:22,603] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:26:22,603] WARN [Controller 0]: Partition [__consumer_offsets,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:26:22,603] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,16] (kafka.controller.KafkaController)
[2016-11-17 17:26:22,603] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,16] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:26:22,605] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,16] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:26:22,606] WARN [Controller 0]: Partition [__consumer_offsets,16] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:26:22,606] DEBUG [Controller 0]: topics not in preferred replica Map([topic2,2] -> List(0, 2, 1), [othertopic,2] -> List(0, 1, 2), [topic4,0] -> List(0, 1)) (kafka.controller.KafkaController)
[2016-11-17 17:26:22,606] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.600000 (kafka.controller.KafkaController)
[2016-11-17 17:26:22,606] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic2,2] (kafka.controller.KafkaController)
[2016-11-17 17:26:22,606] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic2,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:26:22,607] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [topic2,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:26:22,608] WARN [Controller 0]: Partition [topic2,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:26:22,608] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,2] (kafka.controller.KafkaController)
[2016-11-17 17:26:22,608] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:26:22,609] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [othertopic,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:26:22,610] WARN [Controller 0]: Partition [othertopic,2] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
[2016-11-17 17:26:22,610] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic4,0] (kafka.controller.KafkaController)
[2016-11-17 17:26:22,610] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic4,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:26:22,611] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [topic4,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:26:22,612] WARN [Controller 0]: Partition [topic4,0] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
[2016-11-17 17:31:22,542] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2016-11-17 17:31:22,543] DEBUG [Controller 0]: preferred replicas by broker Map(2 -> Map([__consumer_offsets,19] -> List(2, 1), [__consumer_offsets,47] -> List(2, 1), [__consumer_offsets,41] -> List(2, 1), [__consumer_offsets,29] -> List(2, 1), [topic2,1] -> List(2, 1, 0), [__consumer_offsets,39] -> List(2, 1), [__consumer_offsets,17] -> List(2, 1), [__consumer_offsets,33] -> List(2, 1), [__consumer_offsets,5] -> List(2, 1), [__consumer_offsets,3] -> List(2, 1), [__consumer_offsets,21] -> List(2, 1), [othertopic,1] -> List(2, 0, 1), [__consumer_offsets,23] -> List(2, 1), [__consumer_offsets,15] -> List(2, 1), [__consumer_offsets,11] -> List(2, 1), [__consumer_offsets,13] -> List(2, 1), [__consumer_offsets,49] -> List(2, 1), [__consumer_offsets,37] -> List(2, 1), [__consumer_offsets,31] -> List(2, 1), [topic1,0] -> List(2), [topic3,2] -> List(2), [__consumer_offsets,25] -> List(2, 1), [__consumer_offsets,45] -> List(2, 1), [__consumer_offsets,27] -> List(2, 1), [__consumer_offsets,43] -> List(2, 1), [__consumer_offsets,35] -> List(2, 1), [__consumer_offsets,7] -> List(2, 1), [__consumer_offsets,9] -> List(2, 1), [__consumer_offsets,1] -> List(2, 1)), 1 -> Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [topic3,1] -> List(1), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [topic2,0] -> List(1, 0, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2)), 0 -> Map([othertopic,2] -> List(0, 1, 2), [topic2,2] -> List(0, 2, 1), [mytopic,0] -> List(0), [topic3,0] -> List(0), [topic4,0] -> List(0, 1))) (kafka.controller.KafkaController)
[2016-11-17 17:31:22,543] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2016-11-17 17:31:22,543] TRACE [Controller 0]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2016-11-17 17:31:22,543] DEBUG [Controller 0]: topics not in preferred replica Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2)) (kafka.controller.KafkaController)
[2016-11-17 17:31:22,544] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 0.928571 (kafka.controller.KafkaController)
[2016-11-17 17:31:22,544] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,30] (kafka.controller.KafkaController)
[2016-11-17 17:31:22,544] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,30] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:31:22,545] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,30] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:31:22,546] WARN [Controller 0]: Partition [__consumer_offsets,30] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:31:22,546] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,10] (kafka.controller.KafkaController)
[2016-11-17 17:31:22,546] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,10] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:31:22,547] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,10] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:31:22,547] WARN [Controller 0]: Partition [__consumer_offsets,10] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:31:22,547] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,14] (kafka.controller.KafkaController)
[2016-11-17 17:31:22,547] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,14] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:31:22,548] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,14] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:31:22,549] WARN [Controller 0]: Partition [__consumer_offsets,14] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:31:22,549] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,40] (kafka.controller.KafkaController)
[2016-11-17 17:31:22,549] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,40] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:31:22,550] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,40] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:31:22,550] WARN [Controller 0]: Partition [__consumer_offsets,40] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:31:22,550] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,18] (kafka.controller.KafkaController)
[2016-11-17 17:31:22,550] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,18] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:31:22,552] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,18] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:31:22,552] WARN [Controller 0]: Partition [__consumer_offsets,18] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:31:22,552] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,0] (kafka.controller.KafkaController)
[2016-11-17 17:31:22,552] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:31:22,554] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:31:22,554] WARN [Controller 0]: Partition [__consumer_offsets,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:31:22,554] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,26] (kafka.controller.KafkaController)
[2016-11-17 17:31:22,554] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,26] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:31:22,555] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,26] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:31:22,555] WARN [Controller 0]: Partition [__consumer_offsets,26] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:31:22,556] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,24] (kafka.controller.KafkaController)
[2016-11-17 17:31:22,556] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,24] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:31:22,557] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,24] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:31:22,557] WARN [Controller 0]: Partition [__consumer_offsets,24] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:31:22,557] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,0] (kafka.controller.KafkaController)
[2016-11-17 17:31:22,557] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:31:22,558] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [othertopic,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:31:22,558] WARN [Controller 0]: Partition [othertopic,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:31:22,558] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,20] (kafka.controller.KafkaController)
[2016-11-17 17:31:22,559] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,20] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:31:22,559] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,20] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:31:22,560] WARN [Controller 0]: Partition [__consumer_offsets,20] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:31:22,560] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,22] (kafka.controller.KafkaController)
[2016-11-17 17:31:22,560] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,22] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:31:22,561] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,22] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:31:22,561] WARN [Controller 0]: Partition [__consumer_offsets,22] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:31:22,561] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,12] (kafka.controller.KafkaController)
[2016-11-17 17:31:22,561] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,12] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:31:22,562] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,12] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:31:22,563] WARN [Controller 0]: Partition [__consumer_offsets,12] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:31:22,563] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,8] (kafka.controller.KafkaController)
[2016-11-17 17:31:22,563] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,8] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:31:22,564] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,8] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:31:22,564] WARN [Controller 0]: Partition [__consumer_offsets,8] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:31:22,564] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,48] (kafka.controller.KafkaController)
[2016-11-17 17:31:22,564] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,48] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:31:22,565] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,48] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:31:22,565] WARN [Controller 0]: Partition [__consumer_offsets,48] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:31:22,565] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,6] (kafka.controller.KafkaController)
[2016-11-17 17:31:22,565] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,6] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:31:22,567] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,6] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:31:22,567] WARN [Controller 0]: Partition [__consumer_offsets,6] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:31:22,567] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,28] (kafka.controller.KafkaController)
[2016-11-17 17:31:22,567] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,28] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:31:22,568] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,28] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:31:22,568] WARN [Controller 0]: Partition [__consumer_offsets,28] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:31:22,568] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,4] (kafka.controller.KafkaController)
[2016-11-17 17:31:22,568] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,4] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:31:22,569] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,4] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:31:22,570] WARN [Controller 0]: Partition [__consumer_offsets,4] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:31:22,570] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,44] (kafka.controller.KafkaController)
[2016-11-17 17:31:22,570] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,44] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:31:22,571] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,44] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:31:22,571] WARN [Controller 0]: Partition [__consumer_offsets,44] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:31:22,571] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,42] (kafka.controller.KafkaController)
[2016-11-17 17:31:22,571] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,42] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:31:22,572] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,42] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:31:22,572] WARN [Controller 0]: Partition [__consumer_offsets,42] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:31:22,572] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,34] (kafka.controller.KafkaController)
[2016-11-17 17:31:22,572] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,34] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:31:22,573] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,34] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:31:22,574] WARN [Controller 0]: Partition [__consumer_offsets,34] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:31:22,574] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,46] (kafka.controller.KafkaController)
[2016-11-17 17:31:22,574] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,46] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:31:22,575] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,46] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:31:22,575] WARN [Controller 0]: Partition [__consumer_offsets,46] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:31:22,575] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,32] (kafka.controller.KafkaController)
[2016-11-17 17:31:22,575] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,32] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:31:22,576] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,32] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:31:22,576] WARN [Controller 0]: Partition [__consumer_offsets,32] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:31:22,576] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,36] (kafka.controller.KafkaController)
[2016-11-17 17:31:22,576] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,36] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:31:22,577] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,36] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:31:22,577] WARN [Controller 0]: Partition [__consumer_offsets,36] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:31:22,577] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,38] (kafka.controller.KafkaController)
[2016-11-17 17:31:22,578] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,38] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:31:22,578] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,38] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:31:22,579] WARN [Controller 0]: Partition [__consumer_offsets,38] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:31:22,579] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,2] (kafka.controller.KafkaController)
[2016-11-17 17:31:22,579] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:31:22,580] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:31:22,580] WARN [Controller 0]: Partition [__consumer_offsets,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:31:22,580] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,16] (kafka.controller.KafkaController)
[2016-11-17 17:31:22,580] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,16] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:31:22,581] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,16] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:31:22,581] WARN [Controller 0]: Partition [__consumer_offsets,16] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:31:22,581] DEBUG [Controller 0]: topics not in preferred replica Map([topic2,2] -> List(0, 2, 1), [othertopic,2] -> List(0, 1, 2), [topic4,0] -> List(0, 1)) (kafka.controller.KafkaController)
[2016-11-17 17:31:22,581] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.600000 (kafka.controller.KafkaController)
[2016-11-17 17:31:22,582] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic2,2] (kafka.controller.KafkaController)
[2016-11-17 17:31:22,582] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic2,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:31:22,582] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [topic2,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:31:22,583] WARN [Controller 0]: Partition [topic2,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:31:22,583] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,2] (kafka.controller.KafkaController)
[2016-11-17 17:31:22,583] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:31:22,584] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [othertopic,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:31:22,584] WARN [Controller 0]: Partition [othertopic,2] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
[2016-11-17 17:31:22,584] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic4,0] (kafka.controller.KafkaController)
[2016-11-17 17:31:22,584] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic4,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:31:22,585] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [topic4,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:31:22,586] WARN [Controller 0]: Partition [topic4,0] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
[2016-11-17 17:36:22,528] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2016-11-17 17:36:22,528] DEBUG [Controller 0]: preferred replicas by broker Map(2 -> Map([__consumer_offsets,19] -> List(2, 1), [__consumer_offsets,47] -> List(2, 1), [__consumer_offsets,41] -> List(2, 1), [__consumer_offsets,29] -> List(2, 1), [topic2,1] -> List(2, 1, 0), [__consumer_offsets,39] -> List(2, 1), [__consumer_offsets,17] -> List(2, 1), [__consumer_offsets,33] -> List(2, 1), [__consumer_offsets,5] -> List(2, 1), [__consumer_offsets,3] -> List(2, 1), [__consumer_offsets,21] -> List(2, 1), [othertopic,1] -> List(2, 0, 1), [__consumer_offsets,23] -> List(2, 1), [__consumer_offsets,15] -> List(2, 1), [__consumer_offsets,11] -> List(2, 1), [__consumer_offsets,13] -> List(2, 1), [__consumer_offsets,49] -> List(2, 1), [__consumer_offsets,37] -> List(2, 1), [__consumer_offsets,31] -> List(2, 1), [topic1,0] -> List(2), [topic3,2] -> List(2), [__consumer_offsets,25] -> List(2, 1), [__consumer_offsets,45] -> List(2, 1), [__consumer_offsets,27] -> List(2, 1), [__consumer_offsets,43] -> List(2, 1), [__consumer_offsets,35] -> List(2, 1), [__consumer_offsets,7] -> List(2, 1), [__consumer_offsets,9] -> List(2, 1), [__consumer_offsets,1] -> List(2, 1)), 1 -> Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [topic3,1] -> List(1), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [topic2,0] -> List(1, 0, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2)), 0 -> Map([othertopic,2] -> List(0, 1, 2), [topic2,2] -> List(0, 2, 1), [mytopic,0] -> List(0), [topic3,0] -> List(0), [topic4,0] -> List(0, 1))) (kafka.controller.KafkaController)
[2016-11-17 17:36:22,528] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2016-11-17 17:36:22,528] TRACE [Controller 0]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2016-11-17 17:36:22,529] DEBUG [Controller 0]: topics not in preferred replica Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2)) (kafka.controller.KafkaController)
[2016-11-17 17:36:22,529] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 0.928571 (kafka.controller.KafkaController)
[2016-11-17 17:36:22,529] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,30] (kafka.controller.KafkaController)
[2016-11-17 17:36:22,529] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,30] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:36:22,530] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,30] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:36:22,531] WARN [Controller 0]: Partition [__consumer_offsets,30] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:36:22,531] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,10] (kafka.controller.KafkaController)
[2016-11-17 17:36:22,531] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,10] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:36:22,532] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,10] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:36:22,532] WARN [Controller 0]: Partition [__consumer_offsets,10] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:36:22,532] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,14] (kafka.controller.KafkaController)
[2016-11-17 17:36:22,532] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,14] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:36:22,534] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,14] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:36:22,534] WARN [Controller 0]: Partition [__consumer_offsets,14] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:36:22,534] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,40] (kafka.controller.KafkaController)
[2016-11-17 17:36:22,534] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,40] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:36:22,535] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,40] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:36:22,536] WARN [Controller 0]: Partition [__consumer_offsets,40] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:36:22,536] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,18] (kafka.controller.KafkaController)
[2016-11-17 17:36:22,536] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,18] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:36:22,537] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,18] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:36:22,538] WARN [Controller 0]: Partition [__consumer_offsets,18] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:36:22,538] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,0] (kafka.controller.KafkaController)
[2016-11-17 17:36:22,538] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:36:22,539] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:36:22,539] WARN [Controller 0]: Partition [__consumer_offsets,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:36:22,539] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,26] (kafka.controller.KafkaController)
[2016-11-17 17:36:22,539] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,26] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:36:22,541] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,26] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:36:22,541] WARN [Controller 0]: Partition [__consumer_offsets,26] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:36:22,541] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,24] (kafka.controller.KafkaController)
[2016-11-17 17:36:22,541] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,24] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:36:22,542] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,24] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:36:22,543] WARN [Controller 0]: Partition [__consumer_offsets,24] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:36:22,543] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,0] (kafka.controller.KafkaController)
[2016-11-17 17:36:22,543] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:36:22,544] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [othertopic,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:36:22,544] WARN [Controller 0]: Partition [othertopic,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:36:22,544] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,20] (kafka.controller.KafkaController)
[2016-11-17 17:36:22,544] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,20] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:36:22,545] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,20] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:36:22,546] WARN [Controller 0]: Partition [__consumer_offsets,20] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:36:22,546] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,22] (kafka.controller.KafkaController)
[2016-11-17 17:36:22,546] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,22] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:36:22,547] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,22] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:36:22,547] WARN [Controller 0]: Partition [__consumer_offsets,22] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:36:22,547] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,12] (kafka.controller.KafkaController)
[2016-11-17 17:36:22,547] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,12] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:36:22,548] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,12] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:36:22,548] WARN [Controller 0]: Partition [__consumer_offsets,12] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:36:22,548] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,8] (kafka.controller.KafkaController)
[2016-11-17 17:36:22,548] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,8] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:36:22,549] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,8] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:36:22,550] WARN [Controller 0]: Partition [__consumer_offsets,8] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:36:22,550] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,48] (kafka.controller.KafkaController)
[2016-11-17 17:36:22,550] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,48] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:36:22,551] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,48] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:36:22,551] WARN [Controller 0]: Partition [__consumer_offsets,48] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:36:22,551] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,6] (kafka.controller.KafkaController)
[2016-11-17 17:36:22,551] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,6] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:36:22,552] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,6] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:36:22,553] WARN [Controller 0]: Partition [__consumer_offsets,6] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:36:22,553] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,28] (kafka.controller.KafkaController)
[2016-11-17 17:36:22,553] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,28] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:36:22,554] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,28] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:36:22,554] WARN [Controller 0]: Partition [__consumer_offsets,28] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:36:22,554] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,4] (kafka.controller.KafkaController)
[2016-11-17 17:36:22,554] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,4] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:36:22,555] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,4] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:36:22,555] WARN [Controller 0]: Partition [__consumer_offsets,4] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:36:22,555] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,44] (kafka.controller.KafkaController)
[2016-11-17 17:36:22,555] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,44] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:36:22,556] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,44] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:36:22,557] WARN [Controller 0]: Partition [__consumer_offsets,44] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:36:22,557] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,42] (kafka.controller.KafkaController)
[2016-11-17 17:36:22,557] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,42] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:36:22,558] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,42] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:36:22,558] WARN [Controller 0]: Partition [__consumer_offsets,42] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:36:22,558] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,34] (kafka.controller.KafkaController)
[2016-11-17 17:36:22,558] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,34] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:36:22,559] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,34] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:36:22,559] WARN [Controller 0]: Partition [__consumer_offsets,34] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:36:22,559] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,46] (kafka.controller.KafkaController)
[2016-11-17 17:36:22,559] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,46] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:36:22,560] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,46] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:36:22,561] WARN [Controller 0]: Partition [__consumer_offsets,46] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:36:22,561] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,32] (kafka.controller.KafkaController)
[2016-11-17 17:36:22,561] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,32] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:36:22,562] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,32] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:36:22,562] WARN [Controller 0]: Partition [__consumer_offsets,32] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:36:22,562] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,36] (kafka.controller.KafkaController)
[2016-11-17 17:36:22,562] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,36] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:36:22,563] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,36] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:36:22,563] WARN [Controller 0]: Partition [__consumer_offsets,36] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:36:22,563] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,38] (kafka.controller.KafkaController)
[2016-11-17 17:36:22,563] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,38] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:36:22,564] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,38] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:36:22,565] WARN [Controller 0]: Partition [__consumer_offsets,38] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:36:22,565] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,2] (kafka.controller.KafkaController)
[2016-11-17 17:36:22,565] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:36:22,566] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:36:22,566] WARN [Controller 0]: Partition [__consumer_offsets,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:36:22,566] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,16] (kafka.controller.KafkaController)
[2016-11-17 17:36:22,566] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,16] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:36:22,567] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,16] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:36:22,567] WARN [Controller 0]: Partition [__consumer_offsets,16] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:36:22,567] DEBUG [Controller 0]: topics not in preferred replica Map([topic2,2] -> List(0, 2, 1), [othertopic,2] -> List(0, 1, 2), [topic4,0] -> List(0, 1)) (kafka.controller.KafkaController)
[2016-11-17 17:36:22,568] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.600000 (kafka.controller.KafkaController)
[2016-11-17 17:36:22,568] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic2,2] (kafka.controller.KafkaController)
[2016-11-17 17:36:22,568] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic2,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:36:22,569] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [topic2,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:36:22,569] WARN [Controller 0]: Partition [topic2,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 17:36:22,569] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,2] (kafka.controller.KafkaController)
[2016-11-17 17:36:22,569] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:36:22,570] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [othertopic,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:36:22,570] WARN [Controller 0]: Partition [othertopic,2] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
[2016-11-17 17:36:22,570] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic4,0] (kafka.controller.KafkaController)
[2016-11-17 17:36:22,570] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic4,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 17:36:22,571] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [topic4,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 17:36:22,572] WARN [Controller 0]: Partition [topic4,0] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
