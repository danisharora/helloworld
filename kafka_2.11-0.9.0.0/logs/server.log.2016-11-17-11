[2016-11-17 12:35:12,042] WARN [ReplicaFetcherThread-0-1], Error in fetch kafka.server.ReplicaFetcherThread$FetchRequest@78a6c088. Possible cause: java.io.IOException: Connection to 1 was disconnected before the response was read (kafka.server.ReplicaFetcherThread)
[2016-11-17 12:35:12,045] INFO Partition [othertopic,2] on broker 0: Shrinking ISR for partition [othertopic,2] from 0,2,1 to 0 (kafka.cluster.Partition)
[2016-11-17 12:35:12,042] WARN [ReplicaFetcherThread-0-2], Error in fetch kafka.server.ReplicaFetcherThread$FetchRequest@31e8e16d. Possible cause: java.io.IOException: Connection to 2 was disconnected before the response was read (kafka.server.ReplicaFetcherThread)
[2016-11-17 12:35:17,535] INFO Creating /controller (is it secure? false) (kafka.utils.ZKCheckedEphemeral)
[2016-11-17 12:35:17,669] INFO Partition [topic4,0] on broker 0: Shrinking ISR for partition [topic4,0] from 0,1 to 0 (kafka.cluster.Partition)
[2016-11-17 12:35:17,670] INFO Partition [othertopic,2] on broker 0: Expanding ISR for partition [othertopic,2] from 0 to 0,2 (kafka.cluster.Partition)
[2016-11-17 12:35:17,922] INFO Partition [othertopic,2] on broker 0: Expanding ISR for partition [othertopic,2] from 0,2 to 0,2,1 (kafka.cluster.Partition)
[2016-11-17 12:35:17,922] INFO Result of znode creation is: NODEEXISTS (kafka.utils.ZKCheckedEphemeral)
[2016-11-17 12:35:17,932] INFO Partition [topic4,0] on broker 0: Expanding ISR for partition [topic4,0] from 0 to 0,1 (kafka.cluster.Partition)
[2016-11-17 12:35:17,933] INFO re-registering broker info in ZK for broker 0 (kafka.server.KafkaHealthcheck)
[2016-11-17 12:35:17,937] INFO Creating /brokers/ids/0 (is it secure? false) (kafka.utils.ZKCheckedEphemeral)
[2016-11-17 12:35:18,415] INFO Result of znode creation is: OK (kafka.utils.ZKCheckedEphemeral)
[2016-11-17 12:35:18,415] INFO Registered broker 0 at path /brokers/ids/0 with addresses: PLAINTEXT -> EndPoint(172.16.26.72,9092,PLAINTEXT) (kafka.utils.ZkUtils)
[2016-11-17 12:35:18,415] INFO done re-registering broker (kafka.server.KafkaHealthcheck)
[2016-11-17 12:35:18,416] INFO Subscribing to /brokers/topics path to watch for new topics (kafka.server.KafkaHealthcheck)
[2016-11-17 12:35:18,733] INFO New leader is 1 (kafka.server.ZookeeperLeaderElector$LeaderChangeListener)
[2016-11-17 12:35:18,919] INFO Creating /controller (is it secure? false) (kafka.utils.ZKCheckedEphemeral)
[2016-11-17 12:35:18,921] INFO Result of znode creation is: OK (kafka.utils.ZKCheckedEphemeral)
[2016-11-17 12:35:18,921] INFO 0 successfully elected as leader (kafka.server.ZookeeperLeaderElector)
[2016-11-17 12:35:19,089] ERROR [KafkaApi-0] error when handling request Name:UpdateMetadataRequest;Version:1;Controller:1;ControllerEpoch:54;CorrelationId:1;ClientId:1;AliveBrokers:0 : (EndPoint(172.16.26.72,9092,PLAINTEXT)),2 : (EndPoint(172.16.26.72,9094,PLAINTEXT));PartitionState:[__consumer_offsets,32] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:28,ControllerEpoch:50),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,16] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:30,ControllerEpoch:50),ReplicationFactor:2),AllReplicas:1,2),[topic2,2] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,2,1,LeaderEpoch:6,ControllerEpoch:38),ReplicationFactor:3),AllReplicas:0,2,1),[__consumer_offsets,49] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:34,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,44] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:30,ControllerEpoch:50),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,28] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:29,ControllerEpoch:50),ReplicationFactor:2),AllReplicas:1,2),[topic2,1] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,0,LeaderEpoch:17,ControllerEpoch:53),ReplicationFactor:3),AllReplicas:2,1,0),[__consumer_offsets,17] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:35,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,23] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:35,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,7] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:35,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,4] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:30,ControllerEpoch:50),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,29] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:35,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[topic4,0] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,1,LeaderEpoch:3,ControllerEpoch:38),ReplicationFactor:2),AllReplicas:0,1),[__consumer_offsets,35] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:36,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,3] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:34,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,24] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:29,ControllerEpoch:50),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,41] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:35,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[topic1,0] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:21,ControllerEpoch:52),ReplicationFactor:1),AllReplicas:2),[__consumer_offsets,0] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:29,ControllerEpoch:50),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,38] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:29,ControllerEpoch:50),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,13] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:34,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,8] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:29,ControllerEpoch:50),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,5] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:35,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,39] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:34,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,36] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:29,ControllerEpoch:50),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,40] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:28,ControllerEpoch:50),ReplicationFactor:2),AllReplicas:1,2),[othertopic,2] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,2,1,LeaderEpoch:48,ControllerEpoch:38),ReplicationFactor:3),AllReplicas:0,1,2),[__consumer_offsets,45] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:35,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,15] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:35,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,33] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:34,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,37] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:35,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,21] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:34,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[othertopic,1] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,0,1,LeaderEpoch:53,ControllerEpoch:53),ReplicationFactor:3),AllReplicas:2,0,1),[__consumer_offsets,6] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:30,ControllerEpoch:50),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,11] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:34,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,20] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:30,ControllerEpoch:50),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,47] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:35,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,2] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:29,ControllerEpoch:50),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,27] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:35,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[topic3,2] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:52),ReplicationFactor:1),AllReplicas:2),[mytopic,0] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:37,ControllerEpoch:38),ReplicationFactor:1),AllReplicas:0),[__consumer_offsets,34] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:30,ControllerEpoch:50),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,9] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:36,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,22] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:29,ControllerEpoch:50),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,42] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:29,ControllerEpoch:50),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,14] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:30,ControllerEpoch:50),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,25] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:36,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,10] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:30,ControllerEpoch:50),ReplicationFactor:2),AllReplicas:1,2),[topic2,0] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,0,2,LeaderEpoch:9,ControllerEpoch:50),ReplicationFactor:3),AllReplicas:1,0,2),[__consumer_offsets,48] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:30,ControllerEpoch:50),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,31] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:34,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,18] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:29,ControllerEpoch:50),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,19] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:34,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,12] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:29,ControllerEpoch:50),ReplicationFactor:2),AllReplicas:1,2),[topic3,0] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:38),ReplicationFactor:1),AllReplicas:0),[__consumer_offsets,46] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:28,ControllerEpoch:50),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,43] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:35,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,1] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:36,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,26] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:29,ControllerEpoch:50),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,30] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:29,ControllerEpoch:50),ReplicationFactor:2),AllReplicas:1,2),[othertopic,0] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,0,2,LeaderEpoch:44,ControllerEpoch:50),ReplicationFactor:3),AllReplicas:1,2,0) (kafka.server.KafkaApis)
kafka.common.ControllerMovedException: Broker 0 received update metadata request with correlation id 1 from an old controller 1 with epoch 54. Latest known controller epoch is 55
	at kafka.server.ReplicaManager.maybeUpdateMetadataCache(ReplicaManager.scala:574)
	at kafka.server.KafkaApis.handleUpdateMetadataRequest(KafkaApis.scala:160)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:74)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
[2016-11-17 12:35:20,673] ERROR [KafkaApi-0] error when handling request Name:UpdateMetadataRequest;Version:1;Controller:1;ControllerEpoch:54;CorrelationId:3;ClientId:1;AliveBrokers:0 : (EndPoint(172.16.26.72,9092,PLAINTEXT)),2 : (EndPoint(172.16.26.72,9094,PLAINTEXT));PartitionState:[__consumer_offsets,32] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:29,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,16] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:31,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,44] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:31,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,28] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:30,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,4] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:31,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,24] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:30,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,0] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:30,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,38] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:30,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,8] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:30,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,36] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:30,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,40] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:29,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,6] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:31,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,20] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:31,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,2] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:30,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,34] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:31,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,22] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:30,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,42] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:30,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,14] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:31,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,10] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:31,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[topic2,0] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,2,LeaderEpoch:10,ControllerEpoch:54),ReplicationFactor:3),AllReplicas:1,0,2),[__consumer_offsets,48] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:31,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,18] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:30,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,12] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:30,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,46] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:29,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,26] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:30,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,30] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:30,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[othertopic,0] -> (LeaderAndIsrInfo:(Leader:2,ISR:0,2,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:3),AllReplicas:1,2,0) (kafka.server.KafkaApis)
kafka.common.ControllerMovedException: Broker 0 received update metadata request with correlation id 3 from an old controller 1 with epoch 54. Latest known controller epoch is 55
	at kafka.server.ReplicaManager.maybeUpdateMetadataCache(ReplicaManager.scala:574)
	at kafka.server.KafkaApis.handleUpdateMetadataRequest(KafkaApis.scala:160)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:74)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
[2016-11-17 12:35:20,677] INFO [ReplicaFetcherManager on broker 0] Removed fetcher for partitions [topic2,0] (kafka.server.ReplicaFetcherManager)
[2016-11-17 12:35:20,681] INFO [ReplicaFetcherManager on broker 0] Removed fetcher for partitions [othertopic,0] (kafka.server.ReplicaFetcherManager)
[2016-11-17 12:35:20,681] INFO Truncating log othertopic-0 to offset 4. (kafka.log.Log)
[2016-11-17 12:35:20,708] INFO [ReplicaFetcherManager on broker 0] Added fetcher for partitions List([[othertopic,0], initOffset 4 to broker BrokerEndPoint(2,172.16.26.72,9094)] ) (kafka.server.ReplicaFetcherManager)
[2016-11-17 12:35:20,708] INFO [ReplicaFetcherThread-0-1], Shutting down (kafka.server.ReplicaFetcherThread)
[2016-11-17 12:35:20,937] INFO [ReplicaFetcherThread-0-1], Stopped  (kafka.server.ReplicaFetcherThread)
[2016-11-17 12:35:20,937] INFO [ReplicaFetcherThread-0-1], Shutdown completed (kafka.server.ReplicaFetcherThread)
[2016-11-17 12:35:20,942] ERROR [KafkaApi-0] error when handling request Name:UpdateMetadataRequest;Version:1;Controller:1;ControllerEpoch:54;CorrelationId:4;ClientId:1;AliveBrokers:0 : (EndPoint(172.16.26.72,9092,PLAINTEXT)),2 : (EndPoint(172.16.26.72,9094,PLAINTEXT));PartitionState:[__consumer_offsets,32] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:29,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,16] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:31,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[topic2,2] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,2,1,LeaderEpoch:6,ControllerEpoch:38),ReplicationFactor:3),AllReplicas:0,2,1),[__consumer_offsets,49] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:34,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,44] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:31,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,28] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:30,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[topic2,1] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,0,LeaderEpoch:17,ControllerEpoch:53),ReplicationFactor:3),AllReplicas:2,1,0),[__consumer_offsets,17] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:35,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,23] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:35,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,7] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:35,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,4] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:31,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,29] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:35,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[topic4,0] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,1,LeaderEpoch:3,ControllerEpoch:38),ReplicationFactor:2),AllReplicas:0,1),[__consumer_offsets,35] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:36,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,3] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:34,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,24] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:30,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,41] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:35,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[topic1,0] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:21,ControllerEpoch:52),ReplicationFactor:1),AllReplicas:2),[__consumer_offsets,0] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:30,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,38] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:30,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,13] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:34,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,8] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:30,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,5] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:35,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,39] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:34,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,36] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:30,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[topic3,1] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:50),ReplicationFactor:1),AllReplicas:1),[__consumer_offsets,40] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:29,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[othertopic,2] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,2,1,LeaderEpoch:48,ControllerEpoch:38),ReplicationFactor:3),AllReplicas:0,1,2),[__consumer_offsets,45] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:35,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,15] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:35,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,33] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:34,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,37] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:35,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,21] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:34,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[othertopic,1] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,0,1,LeaderEpoch:53,ControllerEpoch:53),ReplicationFactor:3),AllReplicas:2,0,1),[__consumer_offsets,6] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:31,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,11] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:34,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,20] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:31,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,47] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:35,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,2] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:30,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,27] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:35,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[topic3,2] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:52),ReplicationFactor:1),AllReplicas:2),[mytopic,0] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:37,ControllerEpoch:38),ReplicationFactor:1),AllReplicas:0),[__consumer_offsets,34] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:31,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,9] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:36,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,22] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:30,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,42] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:30,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,14] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:31,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,25] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:36,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,10] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:31,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[topic2,0] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,2,LeaderEpoch:10,ControllerEpoch:54),ReplicationFactor:3),AllReplicas:1,0,2),[__consumer_offsets,48] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:31,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,31] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:34,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,18] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:30,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,19] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:34,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,12] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:30,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[topic3,0] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:38),ReplicationFactor:1),AllReplicas:0),[__consumer_offsets,46] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:29,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,43] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:35,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,1] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:36,ControllerEpoch:53),ReplicationFactor:2),AllReplicas:2,1),[__consumer_offsets,26] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:30,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[__consumer_offsets,30] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:30,ControllerEpoch:54),ReplicationFactor:2),AllReplicas:1,2),[othertopic,0] -> (LeaderAndIsrInfo:(Leader:2,ISR:0,2,LeaderEpoch:45,ControllerEpoch:54),ReplicationFactor:3),AllReplicas:1,2,0) (kafka.server.KafkaApis)
kafka.common.ControllerMovedException: Broker 0 received update metadata request with correlation id 4 from an old controller 1 with epoch 54. Latest known controller epoch is 55
	at kafka.server.ReplicaManager.maybeUpdateMetadataCache(ReplicaManager.scala:574)
	at kafka.server.KafkaApis.handleUpdateMetadataRequest(KafkaApis.scala:160)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:74)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
[2016-11-17 12:35:21,001] INFO New leader is 0 (kafka.server.ZookeeperLeaderElector$LeaderChangeListener)
[2016-11-17 12:35:21,953] INFO Partition [topic2,0] on broker 0: Expanding ISR for partition [topic2,0] from 0,2 to 0,2,1 (kafka.cluster.Partition)
[2016-11-17 12:35:22,175] INFO New leader is 2 (kafka.server.ZookeeperLeaderElector$LeaderChangeListener)
[2016-11-17 12:35:29,667] INFO [ReplicaFetcherManager on broker 0] Removed fetcher for partitions [othertopic,0] (kafka.server.ReplicaFetcherManager)
[2016-11-17 12:35:29,677] INFO Truncating log othertopic-0 to offset 4. (kafka.log.Log)
[2016-11-17 12:35:29,683] INFO [ReplicaFetcherManager on broker 0] Added fetcher for partitions List([[othertopic,0], initOffset 4 to broker BrokerEndPoint(1,172.16.26.72,9093)] ) (kafka.server.ReplicaFetcherManager)
[2016-11-17 12:35:29,685] INFO [ReplicaFetcherThread-0-1], Starting  (kafka.server.ReplicaFetcherThread)
[2016-11-17 12:35:29,703] INFO [ReplicaFetcherManager on broker 0] Removed fetcher for partitions [topic2,0] (kafka.server.ReplicaFetcherManager)
[2016-11-17 12:35:29,703] INFO Truncating log topic2-0 to offset 0. (kafka.log.Log)
[2016-11-17 12:35:29,722] INFO [ReplicaFetcherManager on broker 0] Added fetcher for partitions List([[topic2,0], initOffset 0 to broker BrokerEndPoint(1,172.16.26.72,9093)] ) (kafka.server.ReplicaFetcherManager)
[2016-11-17 12:35:56,637] INFO Partition [othertopic,2] on broker 0: Shrinking ISR for partition [othertopic,2] from 0,2,1 to 0 (kafka.cluster.Partition)
[2016-11-17 12:35:56,662] INFO Partition [topic2,2] on broker 0: Shrinking ISR for partition [topic2,2] from 0,2,1 to 0 (kafka.cluster.Partition)
[2016-11-17 12:35:56,663] INFO Partition [topic4,0] on broker 0: Shrinking ISR for partition [topic4,0] from 0,1 to 0 (kafka.cluster.Partition)
[2016-11-17 12:36:09,159] WARN [ReplicaFetcherThread-0-2], Error in fetch kafka.server.ReplicaFetcherThread$FetchRequest@45d498b0. Possible cause: java.net.SocketTimeoutException: No response received within 30000 ms (kafka.server.ReplicaFetcherThread)
[2016-11-17 12:36:09,229] WARN [ReplicaFetcherThread-0-1], Error in fetch kafka.server.ReplicaFetcherThread$FetchRequest@2ef0a534. Possible cause: java.io.IOException: Connection to 1 was disconnected before the response was read (kafka.server.ReplicaFetcherThread)
[2016-11-17 12:36:41,169] WARN [ReplicaFetcherThread-0-2], Error in fetch kafka.server.ReplicaFetcherThread$FetchRequest@3341eaee. Possible cause: java.io.IOException: Connection to Node(2, 172.16.26.72, 9094) failed (kafka.server.ReplicaFetcherThread)
[2016-11-17 12:36:41,239] WARN [ReplicaFetcherThread-0-1], Error in fetch kafka.server.ReplicaFetcherThread$FetchRequest@6bf23e8e. Possible cause: java.io.IOException: Connection to Node(1, 172.16.26.72, 9093) failed (kafka.server.ReplicaFetcherThread)
[2016-11-17 12:36:43,183] INFO Partition [topic2,2] on broker 0: Expanding ISR for partition [topic2,2] from 0 to 0,1 (kafka.cluster.Partition)
[2016-11-17 12:36:43,196] INFO Partition [othertopic,2] on broker 0: Expanding ISR for partition [othertopic,2] from 0 to 0,1 (kafka.cluster.Partition)
[2016-11-17 12:36:43,198] INFO Partition [topic4,0] on broker 0: Expanding ISR for partition [topic4,0] from 0 to 0,1 (kafka.cluster.Partition)
[2016-11-17 12:36:43,547] INFO Partition [topic2,2] on broker 0: Expanding ISR for partition [topic2,2] from 0,1 to 0,1,2 (kafka.cluster.Partition)
[2016-11-17 12:36:43,547] INFO Partition [othertopic,2] on broker 0: Expanding ISR for partition [othertopic,2] from 0,1 to 0,1,2 (kafka.cluster.Partition)
[2016-11-17 12:38:27,704] INFO [Group Metadata Manager on Broker 0]: Removed 0 expired offsets in 0 milliseconds. (kafka.coordinator.GroupMetadataManager)
[2016-11-17 12:48:27,072] INFO [Group Metadata Manager on Broker 0]: Removed 0 expired offsets in 0 milliseconds. (kafka.coordinator.GroupMetadataManager)
[2016-11-17 12:58:27,049] INFO [Group Metadata Manager on Broker 0]: Removed 0 expired offsets in 0 milliseconds. (kafka.coordinator.GroupMetadataManager)
