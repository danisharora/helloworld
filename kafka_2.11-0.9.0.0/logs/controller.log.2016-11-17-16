[2016-11-17 16:01:22,772] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2016-11-17 16:01:22,791] DEBUG [Controller 0]: preferred replicas by broker Map(2 -> Map([__consumer_offsets,19] -> List(2, 1), [__consumer_offsets,47] -> List(2, 1), [__consumer_offsets,41] -> List(2, 1), [__consumer_offsets,29] -> List(2, 1), [topic2,1] -> List(2, 1, 0), [__consumer_offsets,39] -> List(2, 1), [__consumer_offsets,17] -> List(2, 1), [__consumer_offsets,33] -> List(2, 1), [__consumer_offsets,5] -> List(2, 1), [__consumer_offsets,3] -> List(2, 1), [__consumer_offsets,21] -> List(2, 1), [othertopic,1] -> List(2, 0, 1), [__consumer_offsets,23] -> List(2, 1), [__consumer_offsets,15] -> List(2, 1), [__consumer_offsets,11] -> List(2, 1), [__consumer_offsets,13] -> List(2, 1), [__consumer_offsets,49] -> List(2, 1), [__consumer_offsets,37] -> List(2, 1), [__consumer_offsets,31] -> List(2, 1), [topic1,0] -> List(2), [topic3,2] -> List(2), [__consumer_offsets,25] -> List(2, 1), [__consumer_offsets,45] -> List(2, 1), [__consumer_offsets,27] -> List(2, 1), [__consumer_offsets,43] -> List(2, 1), [__consumer_offsets,35] -> List(2, 1), [__consumer_offsets,7] -> List(2, 1), [__consumer_offsets,9] -> List(2, 1), [__consumer_offsets,1] -> List(2, 1)), 1 -> Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [topic3,1] -> List(1), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [topic2,0] -> List(1, 0, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2)), 0 -> Map([othertopic,2] -> List(0, 1, 2), [topic2,2] -> List(0, 2, 1), [mytopic,0] -> List(0), [topic3,0] -> List(0), [topic4,0] -> List(0, 1))) (kafka.controller.KafkaController)
[2016-11-17 16:01:22,792] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2016-11-17 16:01:22,792] TRACE [Controller 0]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2016-11-17 16:01:22,792] DEBUG [Controller 0]: topics not in preferred replica Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2)) (kafka.controller.KafkaController)
[2016-11-17 16:01:22,792] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 0.928571 (kafka.controller.KafkaController)
[2016-11-17 16:01:22,792] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,30] (kafka.controller.KafkaController)
[2016-11-17 16:01:22,792] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,30] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:01:22,794] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,30] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:01:22,794] WARN [Controller 0]: Partition [__consumer_offsets,30] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:01:22,795] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,10] (kafka.controller.KafkaController)
[2016-11-17 16:01:22,795] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,10] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:01:22,796] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,10] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:01:22,796] WARN [Controller 0]: Partition [__consumer_offsets,10] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:01:22,796] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,14] (kafka.controller.KafkaController)
[2016-11-17 16:01:22,796] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,14] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:01:22,797] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,14] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:01:22,798] WARN [Controller 0]: Partition [__consumer_offsets,14] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:01:22,798] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,40] (kafka.controller.KafkaController)
[2016-11-17 16:01:22,798] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,40] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:01:22,799] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,40] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:01:22,799] WARN [Controller 0]: Partition [__consumer_offsets,40] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:01:22,799] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,18] (kafka.controller.KafkaController)
[2016-11-17 16:01:22,799] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,18] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:01:22,800] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,18] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:01:22,801] WARN [Controller 0]: Partition [__consumer_offsets,18] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:01:22,801] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,0] (kafka.controller.KafkaController)
[2016-11-17 16:01:22,801] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:01:22,802] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:01:22,803] WARN [Controller 0]: Partition [__consumer_offsets,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:01:22,803] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,26] (kafka.controller.KafkaController)
[2016-11-17 16:01:22,803] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,26] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:01:22,804] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,26] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:01:22,804] WARN [Controller 0]: Partition [__consumer_offsets,26] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:01:22,805] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,24] (kafka.controller.KafkaController)
[2016-11-17 16:01:22,805] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,24] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:01:22,806] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,24] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:01:22,806] WARN [Controller 0]: Partition [__consumer_offsets,24] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:01:22,806] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,0] (kafka.controller.KafkaController)
[2016-11-17 16:01:22,806] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:01:22,807] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [othertopic,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:01:22,807] WARN [Controller 0]: Partition [othertopic,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:01:22,807] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,20] (kafka.controller.KafkaController)
[2016-11-17 16:01:22,807] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,20] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:01:22,808] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,20] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:01:22,809] WARN [Controller 0]: Partition [__consumer_offsets,20] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:01:22,809] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,22] (kafka.controller.KafkaController)
[2016-11-17 16:01:22,809] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,22] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:01:22,810] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,22] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:01:22,810] WARN [Controller 0]: Partition [__consumer_offsets,22] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:01:22,810] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,12] (kafka.controller.KafkaController)
[2016-11-17 16:01:22,810] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,12] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:01:22,811] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,12] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:01:22,812] WARN [Controller 0]: Partition [__consumer_offsets,12] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:01:22,812] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,8] (kafka.controller.KafkaController)
[2016-11-17 16:01:22,812] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,8] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:01:22,813] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,8] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:01:22,813] WARN [Controller 0]: Partition [__consumer_offsets,8] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:01:22,813] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,48] (kafka.controller.KafkaController)
[2016-11-17 16:01:22,813] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,48] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:01:22,814] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,48] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:01:22,815] WARN [Controller 0]: Partition [__consumer_offsets,48] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:01:22,815] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,6] (kafka.controller.KafkaController)
[2016-11-17 16:01:22,815] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,6] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:01:22,815] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,6] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:01:22,816] WARN [Controller 0]: Partition [__consumer_offsets,6] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:01:22,816] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,28] (kafka.controller.KafkaController)
[2016-11-17 16:01:22,816] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,28] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:01:22,817] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,28] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:01:22,817] WARN [Controller 0]: Partition [__consumer_offsets,28] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:01:22,817] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,4] (kafka.controller.KafkaController)
[2016-11-17 16:01:22,817] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,4] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:01:22,818] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,4] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:01:22,819] WARN [Controller 0]: Partition [__consumer_offsets,4] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:01:22,819] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,44] (kafka.controller.KafkaController)
[2016-11-17 16:01:22,819] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,44] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:01:22,820] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,44] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:01:22,821] WARN [Controller 0]: Partition [__consumer_offsets,44] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:01:22,821] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,42] (kafka.controller.KafkaController)
[2016-11-17 16:01:22,821] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,42] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:01:22,822] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,42] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:01:22,822] WARN [Controller 0]: Partition [__consumer_offsets,42] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:01:22,822] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,34] (kafka.controller.KafkaController)
[2016-11-17 16:01:22,822] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,34] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:01:22,823] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,34] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:01:22,823] WARN [Controller 0]: Partition [__consumer_offsets,34] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:01:22,823] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,46] (kafka.controller.KafkaController)
[2016-11-17 16:01:22,823] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,46] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:01:22,824] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,46] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:01:22,825] WARN [Controller 0]: Partition [__consumer_offsets,46] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:01:22,825] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,32] (kafka.controller.KafkaController)
[2016-11-17 16:01:22,825] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,32] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:01:22,826] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,32] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:01:22,826] WARN [Controller 0]: Partition [__consumer_offsets,32] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:01:22,826] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,36] (kafka.controller.KafkaController)
[2016-11-17 16:01:22,826] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,36] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:01:22,828] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,36] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:01:22,828] WARN [Controller 0]: Partition [__consumer_offsets,36] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:01:22,828] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,38] (kafka.controller.KafkaController)
[2016-11-17 16:01:22,829] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,38] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:01:22,830] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,38] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:01:22,830] WARN [Controller 0]: Partition [__consumer_offsets,38] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:01:22,830] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,2] (kafka.controller.KafkaController)
[2016-11-17 16:01:22,830] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:01:22,831] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:01:22,831] WARN [Controller 0]: Partition [__consumer_offsets,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:01:22,831] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,16] (kafka.controller.KafkaController)
[2016-11-17 16:01:22,831] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,16] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:01:22,832] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,16] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:01:22,833] WARN [Controller 0]: Partition [__consumer_offsets,16] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:01:22,833] DEBUG [Controller 0]: topics not in preferred replica Map([topic2,2] -> List(0, 2, 1), [othertopic,2] -> List(0, 1, 2), [topic4,0] -> List(0, 1)) (kafka.controller.KafkaController)
[2016-11-17 16:01:22,833] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.600000 (kafka.controller.KafkaController)
[2016-11-17 16:01:22,833] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic2,2] (kafka.controller.KafkaController)
[2016-11-17 16:01:22,833] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic2,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:01:22,834] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [topic2,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:01:22,834] WARN [Controller 0]: Partition [topic2,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:01:22,834] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,2] (kafka.controller.KafkaController)
[2016-11-17 16:01:22,834] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:01:22,836] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [othertopic,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:01:22,836] WARN [Controller 0]: Partition [othertopic,2] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
[2016-11-17 16:01:22,837] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic4,0] (kafka.controller.KafkaController)
[2016-11-17 16:01:22,837] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic4,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:01:22,838] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [topic4,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:01:22,838] WARN [Controller 0]: Partition [topic4,0] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
[2016-11-17 16:06:22,758] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2016-11-17 16:06:22,759] DEBUG [Controller 0]: preferred replicas by broker Map(2 -> Map([__consumer_offsets,19] -> List(2, 1), [__consumer_offsets,47] -> List(2, 1), [__consumer_offsets,41] -> List(2, 1), [__consumer_offsets,29] -> List(2, 1), [topic2,1] -> List(2, 1, 0), [__consumer_offsets,39] -> List(2, 1), [__consumer_offsets,17] -> List(2, 1), [__consumer_offsets,33] -> List(2, 1), [__consumer_offsets,5] -> List(2, 1), [__consumer_offsets,3] -> List(2, 1), [__consumer_offsets,21] -> List(2, 1), [othertopic,1] -> List(2, 0, 1), [__consumer_offsets,23] -> List(2, 1), [__consumer_offsets,15] -> List(2, 1), [__consumer_offsets,11] -> List(2, 1), [__consumer_offsets,13] -> List(2, 1), [__consumer_offsets,49] -> List(2, 1), [__consumer_offsets,37] -> List(2, 1), [__consumer_offsets,31] -> List(2, 1), [topic1,0] -> List(2), [topic3,2] -> List(2), [__consumer_offsets,25] -> List(2, 1), [__consumer_offsets,45] -> List(2, 1), [__consumer_offsets,27] -> List(2, 1), [__consumer_offsets,43] -> List(2, 1), [__consumer_offsets,35] -> List(2, 1), [__consumer_offsets,7] -> List(2, 1), [__consumer_offsets,9] -> List(2, 1), [__consumer_offsets,1] -> List(2, 1)), 1 -> Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [topic3,1] -> List(1), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [topic2,0] -> List(1, 0, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2)), 0 -> Map([othertopic,2] -> List(0, 1, 2), [topic2,2] -> List(0, 2, 1), [mytopic,0] -> List(0), [topic3,0] -> List(0), [topic4,0] -> List(0, 1))) (kafka.controller.KafkaController)
[2016-11-17 16:06:22,759] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2016-11-17 16:06:22,759] TRACE [Controller 0]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2016-11-17 16:06:22,760] DEBUG [Controller 0]: topics not in preferred replica Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2)) (kafka.controller.KafkaController)
[2016-11-17 16:06:22,760] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 0.928571 (kafka.controller.KafkaController)
[2016-11-17 16:06:22,760] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,30] (kafka.controller.KafkaController)
[2016-11-17 16:06:22,760] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,30] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:06:22,762] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,30] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:06:22,762] WARN [Controller 0]: Partition [__consumer_offsets,30] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:06:22,762] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,10] (kafka.controller.KafkaController)
[2016-11-17 16:06:22,762] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,10] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:06:22,763] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,10] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:06:22,764] WARN [Controller 0]: Partition [__consumer_offsets,10] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:06:22,764] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,14] (kafka.controller.KafkaController)
[2016-11-17 16:06:22,764] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,14] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:06:22,766] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,14] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:06:22,766] WARN [Controller 0]: Partition [__consumer_offsets,14] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:06:22,766] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,40] (kafka.controller.KafkaController)
[2016-11-17 16:06:22,766] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,40] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:06:22,768] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,40] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:06:22,790] WARN [Controller 0]: Partition [__consumer_offsets,40] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:06:22,790] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,18] (kafka.controller.KafkaController)
[2016-11-17 16:06:22,790] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,18] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:06:22,792] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,18] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:06:22,793] WARN [Controller 0]: Partition [__consumer_offsets,18] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:06:22,793] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,0] (kafka.controller.KafkaController)
[2016-11-17 16:06:22,793] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:06:22,794] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:06:22,794] WARN [Controller 0]: Partition [__consumer_offsets,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:06:22,795] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,26] (kafka.controller.KafkaController)
[2016-11-17 16:06:22,795] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,26] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:06:22,796] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,26] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:06:22,797] WARN [Controller 0]: Partition [__consumer_offsets,26] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:06:22,797] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,24] (kafka.controller.KafkaController)
[2016-11-17 16:06:22,797] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,24] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:06:22,798] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,24] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:06:22,799] WARN [Controller 0]: Partition [__consumer_offsets,24] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:06:22,799] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,0] (kafka.controller.KafkaController)
[2016-11-17 16:06:22,799] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:06:22,800] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [othertopic,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:06:22,801] WARN [Controller 0]: Partition [othertopic,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:06:22,801] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,20] (kafka.controller.KafkaController)
[2016-11-17 16:06:22,801] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,20] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:06:22,802] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,20] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:06:22,802] WARN [Controller 0]: Partition [__consumer_offsets,20] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:06:22,802] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,22] (kafka.controller.KafkaController)
[2016-11-17 16:06:22,802] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,22] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:06:22,803] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,22] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:06:22,804] WARN [Controller 0]: Partition [__consumer_offsets,22] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:06:22,804] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,12] (kafka.controller.KafkaController)
[2016-11-17 16:06:22,804] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,12] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:06:22,805] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,12] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:06:22,806] WARN [Controller 0]: Partition [__consumer_offsets,12] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:06:22,806] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,8] (kafka.controller.KafkaController)
[2016-11-17 16:06:22,806] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,8] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:06:22,807] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,8] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:06:22,807] WARN [Controller 0]: Partition [__consumer_offsets,8] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:06:22,807] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,48] (kafka.controller.KafkaController)
[2016-11-17 16:06:22,807] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,48] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:06:22,808] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,48] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:06:22,809] WARN [Controller 0]: Partition [__consumer_offsets,48] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:06:22,809] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,6] (kafka.controller.KafkaController)
[2016-11-17 16:06:22,809] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,6] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:06:22,810] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,6] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:06:22,810] WARN [Controller 0]: Partition [__consumer_offsets,6] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:06:22,810] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,28] (kafka.controller.KafkaController)
[2016-11-17 16:06:22,810] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,28] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:06:22,811] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,28] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:06:22,811] WARN [Controller 0]: Partition [__consumer_offsets,28] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:06:22,811] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,4] (kafka.controller.KafkaController)
[2016-11-17 16:06:22,811] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,4] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:06:22,812] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,4] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:06:22,813] WARN [Controller 0]: Partition [__consumer_offsets,4] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:06:22,813] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,44] (kafka.controller.KafkaController)
[2016-11-17 16:06:22,813] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,44] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:06:22,814] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,44] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:06:22,815] WARN [Controller 0]: Partition [__consumer_offsets,44] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:06:22,815] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,42] (kafka.controller.KafkaController)
[2016-11-17 16:06:22,815] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,42] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:06:22,816] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,42] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:06:22,816] WARN [Controller 0]: Partition [__consumer_offsets,42] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:06:22,816] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,34] (kafka.controller.KafkaController)
[2016-11-17 16:06:22,816] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,34] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:06:22,818] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,34] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:06:22,818] WARN [Controller 0]: Partition [__consumer_offsets,34] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:06:22,818] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,46] (kafka.controller.KafkaController)
[2016-11-17 16:06:22,818] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,46] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:06:22,819] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,46] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:06:22,819] WARN [Controller 0]: Partition [__consumer_offsets,46] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:06:22,819] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,32] (kafka.controller.KafkaController)
[2016-11-17 16:06:22,819] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,32] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:06:22,820] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,32] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:06:22,821] WARN [Controller 0]: Partition [__consumer_offsets,32] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:06:22,821] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,36] (kafka.controller.KafkaController)
[2016-11-17 16:06:22,821] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,36] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:06:22,822] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,36] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:06:22,823] WARN [Controller 0]: Partition [__consumer_offsets,36] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:06:22,823] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,38] (kafka.controller.KafkaController)
[2016-11-17 16:06:22,823] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,38] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:06:22,824] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,38] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:06:22,824] WARN [Controller 0]: Partition [__consumer_offsets,38] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:06:22,824] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,2] (kafka.controller.KafkaController)
[2016-11-17 16:06:22,824] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:06:22,826] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:06:22,826] WARN [Controller 0]: Partition [__consumer_offsets,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:06:22,826] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,16] (kafka.controller.KafkaController)
[2016-11-17 16:06:22,826] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,16] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:06:22,827] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,16] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:06:22,827] WARN [Controller 0]: Partition [__consumer_offsets,16] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:06:22,827] DEBUG [Controller 0]: topics not in preferred replica Map([topic2,2] -> List(0, 2, 1), [othertopic,2] -> List(0, 1, 2), [topic4,0] -> List(0, 1)) (kafka.controller.KafkaController)
[2016-11-17 16:06:22,828] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.600000 (kafka.controller.KafkaController)
[2016-11-17 16:06:22,828] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic2,2] (kafka.controller.KafkaController)
[2016-11-17 16:06:22,828] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic2,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:06:22,829] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [topic2,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:06:22,829] WARN [Controller 0]: Partition [topic2,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:06:22,829] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,2] (kafka.controller.KafkaController)
[2016-11-17 16:06:22,829] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:06:22,831] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [othertopic,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:06:22,831] WARN [Controller 0]: Partition [othertopic,2] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
[2016-11-17 16:06:22,831] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic4,0] (kafka.controller.KafkaController)
[2016-11-17 16:06:22,831] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic4,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:06:22,832] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [topic4,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:06:22,833] WARN [Controller 0]: Partition [topic4,0] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
[2016-11-17 16:11:22,748] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2016-11-17 16:11:22,767] DEBUG [Controller 0]: preferred replicas by broker Map(2 -> Map([__consumer_offsets,19] -> List(2, 1), [__consumer_offsets,47] -> List(2, 1), [__consumer_offsets,41] -> List(2, 1), [__consumer_offsets,29] -> List(2, 1), [topic2,1] -> List(2, 1, 0), [__consumer_offsets,39] -> List(2, 1), [__consumer_offsets,17] -> List(2, 1), [__consumer_offsets,33] -> List(2, 1), [__consumer_offsets,5] -> List(2, 1), [__consumer_offsets,3] -> List(2, 1), [__consumer_offsets,21] -> List(2, 1), [othertopic,1] -> List(2, 0, 1), [__consumer_offsets,23] -> List(2, 1), [__consumer_offsets,15] -> List(2, 1), [__consumer_offsets,11] -> List(2, 1), [__consumer_offsets,13] -> List(2, 1), [__consumer_offsets,49] -> List(2, 1), [__consumer_offsets,37] -> List(2, 1), [__consumer_offsets,31] -> List(2, 1), [topic1,0] -> List(2), [topic3,2] -> List(2), [__consumer_offsets,25] -> List(2, 1), [__consumer_offsets,45] -> List(2, 1), [__consumer_offsets,27] -> List(2, 1), [__consumer_offsets,43] -> List(2, 1), [__consumer_offsets,35] -> List(2, 1), [__consumer_offsets,7] -> List(2, 1), [__consumer_offsets,9] -> List(2, 1), [__consumer_offsets,1] -> List(2, 1)), 1 -> Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [topic3,1] -> List(1), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [topic2,0] -> List(1, 0, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2)), 0 -> Map([othertopic,2] -> List(0, 1, 2), [topic2,2] -> List(0, 2, 1), [mytopic,0] -> List(0), [topic3,0] -> List(0), [topic4,0] -> List(0, 1))) (kafka.controller.KafkaController)
[2016-11-17 16:11:22,767] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2016-11-17 16:11:22,767] TRACE [Controller 0]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2016-11-17 16:11:22,767] DEBUG [Controller 0]: topics not in preferred replica Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2)) (kafka.controller.KafkaController)
[2016-11-17 16:11:22,767] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 0.928571 (kafka.controller.KafkaController)
[2016-11-17 16:11:22,767] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,30] (kafka.controller.KafkaController)
[2016-11-17 16:11:22,767] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,30] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:11:22,769] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,30] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:11:22,769] WARN [Controller 0]: Partition [__consumer_offsets,30] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:11:22,770] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,10] (kafka.controller.KafkaController)
[2016-11-17 16:11:22,770] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,10] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:11:22,771] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,10] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:11:22,771] WARN [Controller 0]: Partition [__consumer_offsets,10] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:11:22,771] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,14] (kafka.controller.KafkaController)
[2016-11-17 16:11:22,771] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,14] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:11:22,772] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,14] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:11:22,773] WARN [Controller 0]: Partition [__consumer_offsets,14] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:11:22,773] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,40] (kafka.controller.KafkaController)
[2016-11-17 16:11:22,773] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,40] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:11:22,774] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,40] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:11:22,775] WARN [Controller 0]: Partition [__consumer_offsets,40] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:11:22,775] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,18] (kafka.controller.KafkaController)
[2016-11-17 16:11:22,775] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,18] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:11:22,776] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,18] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:11:22,777] WARN [Controller 0]: Partition [__consumer_offsets,18] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:11:22,777] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,0] (kafka.controller.KafkaController)
[2016-11-17 16:11:22,777] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:11:22,778] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:11:22,778] WARN [Controller 0]: Partition [__consumer_offsets,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:11:22,778] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,26] (kafka.controller.KafkaController)
[2016-11-17 16:11:22,778] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,26] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:11:22,779] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,26] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:11:22,780] WARN [Controller 0]: Partition [__consumer_offsets,26] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:11:22,780] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,24] (kafka.controller.KafkaController)
[2016-11-17 16:11:22,780] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,24] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:11:22,781] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,24] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:11:22,781] WARN [Controller 0]: Partition [__consumer_offsets,24] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:11:22,781] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,0] (kafka.controller.KafkaController)
[2016-11-17 16:11:22,781] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:11:22,782] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [othertopic,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:11:22,783] WARN [Controller 0]: Partition [othertopic,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:11:22,783] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,20] (kafka.controller.KafkaController)
[2016-11-17 16:11:22,783] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,20] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:11:22,784] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,20] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:11:22,784] WARN [Controller 0]: Partition [__consumer_offsets,20] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:11:22,784] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,22] (kafka.controller.KafkaController)
[2016-11-17 16:11:22,784] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,22] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:11:22,785] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,22] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:11:22,786] WARN [Controller 0]: Partition [__consumer_offsets,22] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:11:22,786] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,12] (kafka.controller.KafkaController)
[2016-11-17 16:11:22,786] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,12] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:11:22,787] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,12] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:11:22,787] WARN [Controller 0]: Partition [__consumer_offsets,12] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:11:22,787] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,8] (kafka.controller.KafkaController)
[2016-11-17 16:11:22,787] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,8] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:11:22,788] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,8] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:11:22,789] WARN [Controller 0]: Partition [__consumer_offsets,8] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:11:22,789] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,48] (kafka.controller.KafkaController)
[2016-11-17 16:11:22,789] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,48] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:11:22,790] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,48] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:11:22,790] WARN [Controller 0]: Partition [__consumer_offsets,48] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:11:22,790] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,6] (kafka.controller.KafkaController)
[2016-11-17 16:11:22,790] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,6] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:11:22,791] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,6] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:11:22,792] WARN [Controller 0]: Partition [__consumer_offsets,6] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:11:22,792] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,28] (kafka.controller.KafkaController)
[2016-11-17 16:11:22,792] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,28] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:11:22,793] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,28] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:11:22,793] WARN [Controller 0]: Partition [__consumer_offsets,28] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:11:22,793] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,4] (kafka.controller.KafkaController)
[2016-11-17 16:11:22,793] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,4] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:11:22,794] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,4] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:11:22,795] WARN [Controller 0]: Partition [__consumer_offsets,4] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:11:22,795] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,44] (kafka.controller.KafkaController)
[2016-11-17 16:11:22,795] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,44] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:11:22,796] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,44] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:11:22,796] WARN [Controller 0]: Partition [__consumer_offsets,44] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:11:22,796] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,42] (kafka.controller.KafkaController)
[2016-11-17 16:11:22,796] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,42] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:11:22,797] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,42] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:11:22,798] WARN [Controller 0]: Partition [__consumer_offsets,42] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:11:22,798] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,34] (kafka.controller.KafkaController)
[2016-11-17 16:11:22,798] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,34] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:11:22,799] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,34] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:11:22,799] WARN [Controller 0]: Partition [__consumer_offsets,34] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:11:22,799] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,46] (kafka.controller.KafkaController)
[2016-11-17 16:11:22,799] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,46] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:11:22,800] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,46] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:11:22,801] WARN [Controller 0]: Partition [__consumer_offsets,46] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:11:22,801] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,32] (kafka.controller.KafkaController)
[2016-11-17 16:11:22,801] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,32] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:11:22,802] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,32] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:11:22,802] WARN [Controller 0]: Partition [__consumer_offsets,32] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:11:22,802] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,36] (kafka.controller.KafkaController)
[2016-11-17 16:11:22,802] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,36] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:11:22,803] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,36] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:11:22,803] WARN [Controller 0]: Partition [__consumer_offsets,36] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:11:22,804] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,38] (kafka.controller.KafkaController)
[2016-11-17 16:11:22,804] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,38] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:11:22,804] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,38] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:11:22,805] WARN [Controller 0]: Partition [__consumer_offsets,38] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:11:22,805] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,2] (kafka.controller.KafkaController)
[2016-11-17 16:11:22,805] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:11:22,806] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:11:22,806] WARN [Controller 0]: Partition [__consumer_offsets,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:11:22,806] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,16] (kafka.controller.KafkaController)
[2016-11-17 16:11:22,806] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,16] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:11:22,807] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,16] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:11:22,808] WARN [Controller 0]: Partition [__consumer_offsets,16] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:11:22,808] DEBUG [Controller 0]: topics not in preferred replica Map([topic2,2] -> List(0, 2, 1), [othertopic,2] -> List(0, 1, 2), [topic4,0] -> List(0, 1)) (kafka.controller.KafkaController)
[2016-11-17 16:11:22,808] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.600000 (kafka.controller.KafkaController)
[2016-11-17 16:11:22,808] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic2,2] (kafka.controller.KafkaController)
[2016-11-17 16:11:22,808] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic2,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:11:22,809] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [topic2,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:11:22,809] WARN [Controller 0]: Partition [topic2,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:11:22,810] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,2] (kafka.controller.KafkaController)
[2016-11-17 16:11:22,810] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:11:22,811] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [othertopic,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:11:22,811] WARN [Controller 0]: Partition [othertopic,2] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
[2016-11-17 16:11:22,811] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic4,0] (kafka.controller.KafkaController)
[2016-11-17 16:11:22,811] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic4,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:11:22,812] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [topic4,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:11:22,812] WARN [Controller 0]: Partition [topic4,0] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
[2016-11-17 16:16:22,733] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2016-11-17 16:16:22,734] DEBUG [Controller 0]: preferred replicas by broker Map(2 -> Map([__consumer_offsets,19] -> List(2, 1), [__consumer_offsets,47] -> List(2, 1), [__consumer_offsets,41] -> List(2, 1), [__consumer_offsets,29] -> List(2, 1), [topic2,1] -> List(2, 1, 0), [__consumer_offsets,39] -> List(2, 1), [__consumer_offsets,17] -> List(2, 1), [__consumer_offsets,33] -> List(2, 1), [__consumer_offsets,5] -> List(2, 1), [__consumer_offsets,3] -> List(2, 1), [__consumer_offsets,21] -> List(2, 1), [othertopic,1] -> List(2, 0, 1), [__consumer_offsets,23] -> List(2, 1), [__consumer_offsets,15] -> List(2, 1), [__consumer_offsets,11] -> List(2, 1), [__consumer_offsets,13] -> List(2, 1), [__consumer_offsets,49] -> List(2, 1), [__consumer_offsets,37] -> List(2, 1), [__consumer_offsets,31] -> List(2, 1), [topic1,0] -> List(2), [topic3,2] -> List(2), [__consumer_offsets,25] -> List(2, 1), [__consumer_offsets,45] -> List(2, 1), [__consumer_offsets,27] -> List(2, 1), [__consumer_offsets,43] -> List(2, 1), [__consumer_offsets,35] -> List(2, 1), [__consumer_offsets,7] -> List(2, 1), [__consumer_offsets,9] -> List(2, 1), [__consumer_offsets,1] -> List(2, 1)), 1 -> Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [topic3,1] -> List(1), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [topic2,0] -> List(1, 0, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2)), 0 -> Map([othertopic,2] -> List(0, 1, 2), [topic2,2] -> List(0, 2, 1), [mytopic,0] -> List(0), [topic3,0] -> List(0), [topic4,0] -> List(0, 1))) (kafka.controller.KafkaController)
[2016-11-17 16:16:22,734] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2016-11-17 16:16:22,734] TRACE [Controller 0]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2016-11-17 16:16:22,734] DEBUG [Controller 0]: topics not in preferred replica Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2)) (kafka.controller.KafkaController)
[2016-11-17 16:16:22,734] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 0.928571 (kafka.controller.KafkaController)
[2016-11-17 16:16:22,734] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,30] (kafka.controller.KafkaController)
[2016-11-17 16:16:22,734] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,30] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:16:22,735] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,30] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:16:22,736] WARN [Controller 0]: Partition [__consumer_offsets,30] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:16:22,736] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,10] (kafka.controller.KafkaController)
[2016-11-17 16:16:22,736] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,10] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:16:22,737] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,10] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:16:22,738] WARN [Controller 0]: Partition [__consumer_offsets,10] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:16:22,738] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,14] (kafka.controller.KafkaController)
[2016-11-17 16:16:22,738] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,14] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:16:22,739] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,14] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:16:22,740] WARN [Controller 0]: Partition [__consumer_offsets,14] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:16:22,740] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,40] (kafka.controller.KafkaController)
[2016-11-17 16:16:22,740] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,40] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:16:22,741] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,40] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:16:22,742] WARN [Controller 0]: Partition [__consumer_offsets,40] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:16:22,742] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,18] (kafka.controller.KafkaController)
[2016-11-17 16:16:22,742] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,18] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:16:22,743] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,18] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:16:22,743] WARN [Controller 0]: Partition [__consumer_offsets,18] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:16:22,743] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,0] (kafka.controller.KafkaController)
[2016-11-17 16:16:22,743] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:16:22,744] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:16:22,745] WARN [Controller 0]: Partition [__consumer_offsets,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:16:22,745] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,26] (kafka.controller.KafkaController)
[2016-11-17 16:16:22,745] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,26] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:16:22,746] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,26] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:16:22,746] WARN [Controller 0]: Partition [__consumer_offsets,26] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:16:22,746] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,24] (kafka.controller.KafkaController)
[2016-11-17 16:16:22,746] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,24] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:16:22,747] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,24] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:16:22,747] WARN [Controller 0]: Partition [__consumer_offsets,24] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:16:22,747] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,0] (kafka.controller.KafkaController)
[2016-11-17 16:16:22,747] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:16:22,748] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [othertopic,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:16:22,749] WARN [Controller 0]: Partition [othertopic,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:16:22,749] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,20] (kafka.controller.KafkaController)
[2016-11-17 16:16:22,749] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,20] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:16:22,750] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,20] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:16:22,750] WARN [Controller 0]: Partition [__consumer_offsets,20] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:16:22,750] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,22] (kafka.controller.KafkaController)
[2016-11-17 16:16:22,750] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,22] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:16:22,751] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,22] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:16:22,752] WARN [Controller 0]: Partition [__consumer_offsets,22] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:16:22,752] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,12] (kafka.controller.KafkaController)
[2016-11-17 16:16:22,752] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,12] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:16:22,754] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,12] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:16:22,754] WARN [Controller 0]: Partition [__consumer_offsets,12] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:16:22,754] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,8] (kafka.controller.KafkaController)
[2016-11-17 16:16:22,754] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,8] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:16:22,755] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,8] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:16:22,756] WARN [Controller 0]: Partition [__consumer_offsets,8] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:16:22,756] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,48] (kafka.controller.KafkaController)
[2016-11-17 16:16:22,756] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,48] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:16:22,757] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,48] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:16:22,758] WARN [Controller 0]: Partition [__consumer_offsets,48] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:16:22,758] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,6] (kafka.controller.KafkaController)
[2016-11-17 16:16:22,758] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,6] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:16:22,759] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,6] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:16:22,759] WARN [Controller 0]: Partition [__consumer_offsets,6] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:16:22,759] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,28] (kafka.controller.KafkaController)
[2016-11-17 16:16:22,759] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,28] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:16:22,760] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,28] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:16:22,760] WARN [Controller 0]: Partition [__consumer_offsets,28] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:16:22,761] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,4] (kafka.controller.KafkaController)
[2016-11-17 16:16:22,761] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,4] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:16:22,761] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,4] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:16:22,762] WARN [Controller 0]: Partition [__consumer_offsets,4] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:16:22,762] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,44] (kafka.controller.KafkaController)
[2016-11-17 16:16:22,762] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,44] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:16:22,763] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,44] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:16:22,763] WARN [Controller 0]: Partition [__consumer_offsets,44] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:16:22,763] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,42] (kafka.controller.KafkaController)
[2016-11-17 16:16:22,763] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,42] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:16:22,764] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,42] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:16:22,765] WARN [Controller 0]: Partition [__consumer_offsets,42] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:16:22,765] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,34] (kafka.controller.KafkaController)
[2016-11-17 16:16:22,765] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,34] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:16:22,765] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,34] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:16:22,766] WARN [Controller 0]: Partition [__consumer_offsets,34] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:16:22,766] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,46] (kafka.controller.KafkaController)
[2016-11-17 16:16:22,766] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,46] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:16:22,767] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,46] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:16:22,767] WARN [Controller 0]: Partition [__consumer_offsets,46] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:16:22,767] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,32] (kafka.controller.KafkaController)
[2016-11-17 16:16:22,767] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,32] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:16:22,768] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,32] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:16:22,769] WARN [Controller 0]: Partition [__consumer_offsets,32] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:16:22,769] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,36] (kafka.controller.KafkaController)
[2016-11-17 16:16:22,769] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,36] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:16:22,770] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,36] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:16:22,770] WARN [Controller 0]: Partition [__consumer_offsets,36] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:16:22,770] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,38] (kafka.controller.KafkaController)
[2016-11-17 16:16:22,770] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,38] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:16:22,772] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,38] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:16:22,773] WARN [Controller 0]: Partition [__consumer_offsets,38] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:16:22,773] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,2] (kafka.controller.KafkaController)
[2016-11-17 16:16:22,773] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:16:22,774] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:16:22,774] WARN [Controller 0]: Partition [__consumer_offsets,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:16:22,774] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,16] (kafka.controller.KafkaController)
[2016-11-17 16:16:22,774] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,16] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:16:22,775] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,16] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:16:22,776] WARN [Controller 0]: Partition [__consumer_offsets,16] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:16:22,776] DEBUG [Controller 0]: topics not in preferred replica Map([topic2,2] -> List(0, 2, 1), [othertopic,2] -> List(0, 1, 2), [topic4,0] -> List(0, 1)) (kafka.controller.KafkaController)
[2016-11-17 16:16:22,776] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.600000 (kafka.controller.KafkaController)
[2016-11-17 16:16:22,776] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic2,2] (kafka.controller.KafkaController)
[2016-11-17 16:16:22,776] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic2,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:16:22,777] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [topic2,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:16:22,777] WARN [Controller 0]: Partition [topic2,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:16:22,777] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,2] (kafka.controller.KafkaController)
[2016-11-17 16:16:22,777] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:16:22,778] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [othertopic,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:16:22,779] WARN [Controller 0]: Partition [othertopic,2] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
[2016-11-17 16:16:22,779] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic4,0] (kafka.controller.KafkaController)
[2016-11-17 16:16:22,779] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic4,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:16:22,780] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [topic4,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:16:22,780] WARN [Controller 0]: Partition [topic4,0] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
[2016-11-17 16:21:22,721] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2016-11-17 16:21:22,721] DEBUG [Controller 0]: preferred replicas by broker Map(2 -> Map([__consumer_offsets,19] -> List(2, 1), [__consumer_offsets,47] -> List(2, 1), [__consumer_offsets,41] -> List(2, 1), [__consumer_offsets,29] -> List(2, 1), [topic2,1] -> List(2, 1, 0), [__consumer_offsets,39] -> List(2, 1), [__consumer_offsets,17] -> List(2, 1), [__consumer_offsets,33] -> List(2, 1), [__consumer_offsets,5] -> List(2, 1), [__consumer_offsets,3] -> List(2, 1), [__consumer_offsets,21] -> List(2, 1), [othertopic,1] -> List(2, 0, 1), [__consumer_offsets,23] -> List(2, 1), [__consumer_offsets,15] -> List(2, 1), [__consumer_offsets,11] -> List(2, 1), [__consumer_offsets,13] -> List(2, 1), [__consumer_offsets,49] -> List(2, 1), [__consumer_offsets,37] -> List(2, 1), [__consumer_offsets,31] -> List(2, 1), [topic1,0] -> List(2), [topic3,2] -> List(2), [__consumer_offsets,25] -> List(2, 1), [__consumer_offsets,45] -> List(2, 1), [__consumer_offsets,27] -> List(2, 1), [__consumer_offsets,43] -> List(2, 1), [__consumer_offsets,35] -> List(2, 1), [__consumer_offsets,7] -> List(2, 1), [__consumer_offsets,9] -> List(2, 1), [__consumer_offsets,1] -> List(2, 1)), 1 -> Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [topic3,1] -> List(1), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [topic2,0] -> List(1, 0, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2)), 0 -> Map([othertopic,2] -> List(0, 1, 2), [topic2,2] -> List(0, 2, 1), [mytopic,0] -> List(0), [topic3,0] -> List(0), [topic4,0] -> List(0, 1))) (kafka.controller.KafkaController)
[2016-11-17 16:21:22,721] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2016-11-17 16:21:22,721] TRACE [Controller 0]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2016-11-17 16:21:22,722] DEBUG [Controller 0]: topics not in preferred replica Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2)) (kafka.controller.KafkaController)
[2016-11-17 16:21:22,722] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 0.928571 (kafka.controller.KafkaController)
[2016-11-17 16:21:22,722] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,30] (kafka.controller.KafkaController)
[2016-11-17 16:21:22,722] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,30] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:21:22,723] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,30] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:21:22,723] WARN [Controller 0]: Partition [__consumer_offsets,30] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:21:22,723] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,10] (kafka.controller.KafkaController)
[2016-11-17 16:21:22,723] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,10] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:21:22,725] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,10] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:21:22,725] WARN [Controller 0]: Partition [__consumer_offsets,10] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:21:22,725] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,14] (kafka.controller.KafkaController)
[2016-11-17 16:21:22,725] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,14] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:21:22,726] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,14] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:21:22,727] WARN [Controller 0]: Partition [__consumer_offsets,14] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:21:22,727] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,40] (kafka.controller.KafkaController)
[2016-11-17 16:21:22,727] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,40] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:21:22,728] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,40] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:21:22,728] WARN [Controller 0]: Partition [__consumer_offsets,40] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:21:22,728] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,18] (kafka.controller.KafkaController)
[2016-11-17 16:21:22,728] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,18] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:21:22,729] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,18] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:21:22,730] WARN [Controller 0]: Partition [__consumer_offsets,18] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:21:22,730] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,0] (kafka.controller.KafkaController)
[2016-11-17 16:21:22,730] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:21:22,731] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:21:22,732] WARN [Controller 0]: Partition [__consumer_offsets,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:21:22,732] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,26] (kafka.controller.KafkaController)
[2016-11-17 16:21:22,732] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,26] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:21:22,733] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,26] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:21:22,734] WARN [Controller 0]: Partition [__consumer_offsets,26] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:21:22,734] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,24] (kafka.controller.KafkaController)
[2016-11-17 16:21:22,734] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,24] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:21:22,735] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,24] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:21:22,736] WARN [Controller 0]: Partition [__consumer_offsets,24] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:21:22,736] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,0] (kafka.controller.KafkaController)
[2016-11-17 16:21:22,736] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:21:22,737] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [othertopic,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:21:22,737] WARN [Controller 0]: Partition [othertopic,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:21:22,737] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,20] (kafka.controller.KafkaController)
[2016-11-17 16:21:22,737] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,20] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:21:22,738] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,20] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:21:22,739] WARN [Controller 0]: Partition [__consumer_offsets,20] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:21:22,739] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,22] (kafka.controller.KafkaController)
[2016-11-17 16:21:22,739] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,22] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:21:22,740] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,22] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:21:22,740] WARN [Controller 0]: Partition [__consumer_offsets,22] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:21:22,740] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,12] (kafka.controller.KafkaController)
[2016-11-17 16:21:22,740] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,12] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:21:22,741] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,12] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:21:22,742] WARN [Controller 0]: Partition [__consumer_offsets,12] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:21:22,742] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,8] (kafka.controller.KafkaController)
[2016-11-17 16:21:22,742] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,8] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:21:22,743] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,8] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:21:22,743] WARN [Controller 0]: Partition [__consumer_offsets,8] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:21:22,743] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,48] (kafka.controller.KafkaController)
[2016-11-17 16:21:22,743] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,48] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:21:22,744] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,48] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:21:22,744] WARN [Controller 0]: Partition [__consumer_offsets,48] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:21:22,744] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,6] (kafka.controller.KafkaController)
[2016-11-17 16:21:22,744] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,6] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:21:22,745] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,6] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:21:22,746] WARN [Controller 0]: Partition [__consumer_offsets,6] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:21:22,746] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,28] (kafka.controller.KafkaController)
[2016-11-17 16:21:22,746] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,28] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:21:22,747] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,28] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:21:22,747] WARN [Controller 0]: Partition [__consumer_offsets,28] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:21:22,747] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,4] (kafka.controller.KafkaController)
[2016-11-17 16:21:22,747] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,4] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:21:22,748] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,4] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:21:22,748] WARN [Controller 0]: Partition [__consumer_offsets,4] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:21:22,748] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,44] (kafka.controller.KafkaController)
[2016-11-17 16:21:22,748] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,44] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:21:22,749] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,44] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:21:22,750] WARN [Controller 0]: Partition [__consumer_offsets,44] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:21:22,750] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,42] (kafka.controller.KafkaController)
[2016-11-17 16:21:22,750] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,42] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:21:22,751] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,42] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:21:22,751] WARN [Controller 0]: Partition [__consumer_offsets,42] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:21:22,751] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,34] (kafka.controller.KafkaController)
[2016-11-17 16:21:22,751] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,34] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:21:22,752] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,34] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:21:22,753] WARN [Controller 0]: Partition [__consumer_offsets,34] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:21:22,753] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,46] (kafka.controller.KafkaController)
[2016-11-17 16:21:22,753] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,46] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:21:22,754] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,46] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:21:22,754] WARN [Controller 0]: Partition [__consumer_offsets,46] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:21:22,754] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,32] (kafka.controller.KafkaController)
[2016-11-17 16:21:22,754] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,32] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:21:22,755] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,32] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:21:22,755] WARN [Controller 0]: Partition [__consumer_offsets,32] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:21:22,755] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,36] (kafka.controller.KafkaController)
[2016-11-17 16:21:22,755] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,36] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:21:22,756] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,36] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:21:22,757] WARN [Controller 0]: Partition [__consumer_offsets,36] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:21:22,757] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,38] (kafka.controller.KafkaController)
[2016-11-17 16:21:22,757] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,38] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:21:22,758] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,38] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:21:22,758] WARN [Controller 0]: Partition [__consumer_offsets,38] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:21:22,758] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,2] (kafka.controller.KafkaController)
[2016-11-17 16:21:22,758] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:21:22,759] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:21:22,759] WARN [Controller 0]: Partition [__consumer_offsets,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:21:22,759] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,16] (kafka.controller.KafkaController)
[2016-11-17 16:21:22,759] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,16] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:21:22,760] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,16] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:21:22,761] WARN [Controller 0]: Partition [__consumer_offsets,16] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:21:22,761] DEBUG [Controller 0]: topics not in preferred replica Map([topic2,2] -> List(0, 2, 1), [othertopic,2] -> List(0, 1, 2), [topic4,0] -> List(0, 1)) (kafka.controller.KafkaController)
[2016-11-17 16:21:22,761] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.600000 (kafka.controller.KafkaController)
[2016-11-17 16:21:22,761] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic2,2] (kafka.controller.KafkaController)
[2016-11-17 16:21:22,761] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic2,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:21:22,762] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [topic2,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:21:22,763] WARN [Controller 0]: Partition [topic2,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:21:22,763] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,2] (kafka.controller.KafkaController)
[2016-11-17 16:21:22,763] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:21:22,764] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [othertopic,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:21:22,764] WARN [Controller 0]: Partition [othertopic,2] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
[2016-11-17 16:21:22,764] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic4,0] (kafka.controller.KafkaController)
[2016-11-17 16:21:22,764] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic4,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:21:22,765] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [topic4,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:21:22,766] WARN [Controller 0]: Partition [topic4,0] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
[2016-11-17 16:26:22,707] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2016-11-17 16:26:22,725] DEBUG [Controller 0]: preferred replicas by broker Map(2 -> Map([__consumer_offsets,19] -> List(2, 1), [__consumer_offsets,47] -> List(2, 1), [__consumer_offsets,41] -> List(2, 1), [__consumer_offsets,29] -> List(2, 1), [topic2,1] -> List(2, 1, 0), [__consumer_offsets,39] -> List(2, 1), [__consumer_offsets,17] -> List(2, 1), [__consumer_offsets,33] -> List(2, 1), [__consumer_offsets,5] -> List(2, 1), [__consumer_offsets,3] -> List(2, 1), [__consumer_offsets,21] -> List(2, 1), [othertopic,1] -> List(2, 0, 1), [__consumer_offsets,23] -> List(2, 1), [__consumer_offsets,15] -> List(2, 1), [__consumer_offsets,11] -> List(2, 1), [__consumer_offsets,13] -> List(2, 1), [__consumer_offsets,49] -> List(2, 1), [__consumer_offsets,37] -> List(2, 1), [__consumer_offsets,31] -> List(2, 1), [topic1,0] -> List(2), [topic3,2] -> List(2), [__consumer_offsets,25] -> List(2, 1), [__consumer_offsets,45] -> List(2, 1), [__consumer_offsets,27] -> List(2, 1), [__consumer_offsets,43] -> List(2, 1), [__consumer_offsets,35] -> List(2, 1), [__consumer_offsets,7] -> List(2, 1), [__consumer_offsets,9] -> List(2, 1), [__consumer_offsets,1] -> List(2, 1)), 1 -> Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [topic3,1] -> List(1), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [topic2,0] -> List(1, 0, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2)), 0 -> Map([othertopic,2] -> List(0, 1, 2), [topic2,2] -> List(0, 2, 1), [mytopic,0] -> List(0), [topic3,0] -> List(0), [topic4,0] -> List(0, 1))) (kafka.controller.KafkaController)
[2016-11-17 16:26:22,725] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2016-11-17 16:26:22,725] TRACE [Controller 0]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2016-11-17 16:26:22,725] DEBUG [Controller 0]: topics not in preferred replica Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2)) (kafka.controller.KafkaController)
[2016-11-17 16:26:22,725] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 0.928571 (kafka.controller.KafkaController)
[2016-11-17 16:26:22,725] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,30] (kafka.controller.KafkaController)
[2016-11-17 16:26:22,725] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,30] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:26:22,727] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,30] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:26:22,728] WARN [Controller 0]: Partition [__consumer_offsets,30] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:26:22,728] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,10] (kafka.controller.KafkaController)
[2016-11-17 16:26:22,728] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,10] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:26:22,730] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,10] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:26:22,730] WARN [Controller 0]: Partition [__consumer_offsets,10] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:26:22,730] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,14] (kafka.controller.KafkaController)
[2016-11-17 16:26:22,730] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,14] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:26:22,732] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,14] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:26:22,732] WARN [Controller 0]: Partition [__consumer_offsets,14] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:26:22,733] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,40] (kafka.controller.KafkaController)
[2016-11-17 16:26:22,733] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,40] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:26:22,734] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,40] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:26:22,734] WARN [Controller 0]: Partition [__consumer_offsets,40] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:26:22,734] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,18] (kafka.controller.KafkaController)
[2016-11-17 16:26:22,734] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,18] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:26:22,735] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,18] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:26:22,736] WARN [Controller 0]: Partition [__consumer_offsets,18] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:26:22,736] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,0] (kafka.controller.KafkaController)
[2016-11-17 16:26:22,736] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:26:22,737] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:26:22,737] WARN [Controller 0]: Partition [__consumer_offsets,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:26:22,737] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,26] (kafka.controller.KafkaController)
[2016-11-17 16:26:22,737] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,26] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:26:22,738] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,26] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:26:22,739] WARN [Controller 0]: Partition [__consumer_offsets,26] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:26:22,739] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,24] (kafka.controller.KafkaController)
[2016-11-17 16:26:22,739] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,24] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:26:22,741] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,24] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:26:22,741] WARN [Controller 0]: Partition [__consumer_offsets,24] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:26:22,741] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,0] (kafka.controller.KafkaController)
[2016-11-17 16:26:22,741] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:26:22,742] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [othertopic,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:26:22,743] WARN [Controller 0]: Partition [othertopic,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:26:22,743] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,20] (kafka.controller.KafkaController)
[2016-11-17 16:26:22,743] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,20] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:26:22,744] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,20] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:26:22,744] WARN [Controller 0]: Partition [__consumer_offsets,20] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:26:22,744] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,22] (kafka.controller.KafkaController)
[2016-11-17 16:26:22,744] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,22] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:26:22,745] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,22] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:26:22,746] WARN [Controller 0]: Partition [__consumer_offsets,22] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:26:22,746] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,12] (kafka.controller.KafkaController)
[2016-11-17 16:26:22,746] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,12] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:26:22,747] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,12] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:26:22,748] WARN [Controller 0]: Partition [__consumer_offsets,12] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:26:22,748] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,8] (kafka.controller.KafkaController)
[2016-11-17 16:26:22,748] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,8] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:26:22,750] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,8] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:26:22,750] WARN [Controller 0]: Partition [__consumer_offsets,8] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:26:22,750] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,48] (kafka.controller.KafkaController)
[2016-11-17 16:26:22,750] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,48] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:26:22,751] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,48] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:26:22,752] WARN [Controller 0]: Partition [__consumer_offsets,48] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:26:22,752] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,6] (kafka.controller.KafkaController)
[2016-11-17 16:26:22,752] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,6] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:26:22,753] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,6] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:26:22,753] WARN [Controller 0]: Partition [__consumer_offsets,6] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:26:22,753] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,28] (kafka.controller.KafkaController)
[2016-11-17 16:26:22,753] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,28] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:26:22,754] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,28] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:26:22,755] WARN [Controller 0]: Partition [__consumer_offsets,28] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:26:22,755] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,4] (kafka.controller.KafkaController)
[2016-11-17 16:26:22,755] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,4] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:26:22,756] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,4] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:26:22,756] WARN [Controller 0]: Partition [__consumer_offsets,4] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:26:22,756] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,44] (kafka.controller.KafkaController)
[2016-11-17 16:26:22,756] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,44] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:26:22,758] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,44] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:26:22,758] WARN [Controller 0]: Partition [__consumer_offsets,44] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:26:22,759] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,42] (kafka.controller.KafkaController)
[2016-11-17 16:26:22,759] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,42] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:26:22,760] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,42] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:26:22,760] WARN [Controller 0]: Partition [__consumer_offsets,42] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:26:22,760] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,34] (kafka.controller.KafkaController)
[2016-11-17 16:26:22,760] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,34] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:26:22,761] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,34] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:26:22,762] WARN [Controller 0]: Partition [__consumer_offsets,34] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:26:22,762] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,46] (kafka.controller.KafkaController)
[2016-11-17 16:26:22,762] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,46] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:26:22,764] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,46] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:26:22,764] WARN [Controller 0]: Partition [__consumer_offsets,46] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:26:22,764] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,32] (kafka.controller.KafkaController)
[2016-11-17 16:26:22,764] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,32] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:26:22,766] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,32] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:26:22,766] WARN [Controller 0]: Partition [__consumer_offsets,32] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:26:22,766] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,36] (kafka.controller.KafkaController)
[2016-11-17 16:26:22,766] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,36] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:26:22,767] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,36] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:26:22,768] WARN [Controller 0]: Partition [__consumer_offsets,36] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:26:22,768] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,38] (kafka.controller.KafkaController)
[2016-11-17 16:26:22,768] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,38] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:26:22,769] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,38] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:26:22,769] WARN [Controller 0]: Partition [__consumer_offsets,38] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:26:22,770] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,2] (kafka.controller.KafkaController)
[2016-11-17 16:26:22,770] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:26:22,771] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:26:22,771] WARN [Controller 0]: Partition [__consumer_offsets,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:26:22,771] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,16] (kafka.controller.KafkaController)
[2016-11-17 16:26:22,771] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,16] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:26:22,772] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,16] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:26:22,773] WARN [Controller 0]: Partition [__consumer_offsets,16] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:26:22,773] DEBUG [Controller 0]: topics not in preferred replica Map([topic2,2] -> List(0, 2, 1), [othertopic,2] -> List(0, 1, 2), [topic4,0] -> List(0, 1)) (kafka.controller.KafkaController)
[2016-11-17 16:26:22,773] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.600000 (kafka.controller.KafkaController)
[2016-11-17 16:26:22,773] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic2,2] (kafka.controller.KafkaController)
[2016-11-17 16:26:22,773] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic2,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:26:22,774] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [topic2,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:26:22,775] WARN [Controller 0]: Partition [topic2,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:26:22,775] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,2] (kafka.controller.KafkaController)
[2016-11-17 16:26:22,775] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:26:22,776] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [othertopic,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:26:22,777] WARN [Controller 0]: Partition [othertopic,2] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
[2016-11-17 16:26:22,777] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic4,0] (kafka.controller.KafkaController)
[2016-11-17 16:26:22,777] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic4,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:26:22,779] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [topic4,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:26:22,779] WARN [Controller 0]: Partition [topic4,0] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
[2016-11-17 16:31:22,696] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2016-11-17 16:31:22,714] DEBUG [Controller 0]: preferred replicas by broker Map(2 -> Map([__consumer_offsets,19] -> List(2, 1), [__consumer_offsets,47] -> List(2, 1), [__consumer_offsets,41] -> List(2, 1), [__consumer_offsets,29] -> List(2, 1), [topic2,1] -> List(2, 1, 0), [__consumer_offsets,39] -> List(2, 1), [__consumer_offsets,17] -> List(2, 1), [__consumer_offsets,33] -> List(2, 1), [__consumer_offsets,5] -> List(2, 1), [__consumer_offsets,3] -> List(2, 1), [__consumer_offsets,21] -> List(2, 1), [othertopic,1] -> List(2, 0, 1), [__consumer_offsets,23] -> List(2, 1), [__consumer_offsets,15] -> List(2, 1), [__consumer_offsets,11] -> List(2, 1), [__consumer_offsets,13] -> List(2, 1), [__consumer_offsets,49] -> List(2, 1), [__consumer_offsets,37] -> List(2, 1), [__consumer_offsets,31] -> List(2, 1), [topic1,0] -> List(2), [topic3,2] -> List(2), [__consumer_offsets,25] -> List(2, 1), [__consumer_offsets,45] -> List(2, 1), [__consumer_offsets,27] -> List(2, 1), [__consumer_offsets,43] -> List(2, 1), [__consumer_offsets,35] -> List(2, 1), [__consumer_offsets,7] -> List(2, 1), [__consumer_offsets,9] -> List(2, 1), [__consumer_offsets,1] -> List(2, 1)), 1 -> Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [topic3,1] -> List(1), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [topic2,0] -> List(1, 0, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2)), 0 -> Map([othertopic,2] -> List(0, 1, 2), [topic2,2] -> List(0, 2, 1), [mytopic,0] -> List(0), [topic3,0] -> List(0), [topic4,0] -> List(0, 1))) (kafka.controller.KafkaController)
[2016-11-17 16:31:22,714] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2016-11-17 16:31:22,714] TRACE [Controller 0]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2016-11-17 16:31:22,715] DEBUG [Controller 0]: topics not in preferred replica Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2)) (kafka.controller.KafkaController)
[2016-11-17 16:31:22,715] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 0.928571 (kafka.controller.KafkaController)
[2016-11-17 16:31:22,715] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,30] (kafka.controller.KafkaController)
[2016-11-17 16:31:22,715] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,30] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:31:22,716] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,30] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:31:22,717] WARN [Controller 0]: Partition [__consumer_offsets,30] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:31:22,717] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,10] (kafka.controller.KafkaController)
[2016-11-17 16:31:22,717] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,10] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:31:22,718] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,10] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:31:22,719] WARN [Controller 0]: Partition [__consumer_offsets,10] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:31:22,719] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,14] (kafka.controller.KafkaController)
[2016-11-17 16:31:22,719] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,14] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:31:22,720] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,14] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:31:22,720] WARN [Controller 0]: Partition [__consumer_offsets,14] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:31:22,720] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,40] (kafka.controller.KafkaController)
[2016-11-17 16:31:22,720] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,40] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:31:22,721] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,40] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:31:22,722] WARN [Controller 0]: Partition [__consumer_offsets,40] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:31:22,722] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,18] (kafka.controller.KafkaController)
[2016-11-17 16:31:22,722] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,18] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:31:22,723] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,18] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:31:22,723] WARN [Controller 0]: Partition [__consumer_offsets,18] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:31:22,723] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,0] (kafka.controller.KafkaController)
[2016-11-17 16:31:22,723] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:31:22,724] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:31:22,725] WARN [Controller 0]: Partition [__consumer_offsets,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:31:22,725] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,26] (kafka.controller.KafkaController)
[2016-11-17 16:31:22,725] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,26] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:31:22,726] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,26] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:31:22,726] WARN [Controller 0]: Partition [__consumer_offsets,26] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:31:22,726] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,24] (kafka.controller.KafkaController)
[2016-11-17 16:31:22,726] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,24] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:31:22,728] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,24] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:31:22,728] WARN [Controller 0]: Partition [__consumer_offsets,24] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:31:22,728] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,0] (kafka.controller.KafkaController)
[2016-11-17 16:31:22,728] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:31:22,729] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [othertopic,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:31:22,730] WARN [Controller 0]: Partition [othertopic,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:31:22,730] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,20] (kafka.controller.KafkaController)
[2016-11-17 16:31:22,730] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,20] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:31:22,731] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,20] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:31:22,731] WARN [Controller 0]: Partition [__consumer_offsets,20] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:31:22,731] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,22] (kafka.controller.KafkaController)
[2016-11-17 16:31:22,731] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,22] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:31:22,732] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,22] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:31:22,732] WARN [Controller 0]: Partition [__consumer_offsets,22] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:31:22,732] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,12] (kafka.controller.KafkaController)
[2016-11-17 16:31:22,732] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,12] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:31:22,733] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,12] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:31:22,734] WARN [Controller 0]: Partition [__consumer_offsets,12] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:31:22,734] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,8] (kafka.controller.KafkaController)
[2016-11-17 16:31:22,734] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,8] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:31:22,735] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,8] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:31:22,735] WARN [Controller 0]: Partition [__consumer_offsets,8] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:31:22,735] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,48] (kafka.controller.KafkaController)
[2016-11-17 16:31:22,735] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,48] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:31:22,737] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,48] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:31:22,737] WARN [Controller 0]: Partition [__consumer_offsets,48] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:31:22,737] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,6] (kafka.controller.KafkaController)
[2016-11-17 16:31:22,737] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,6] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:31:22,738] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,6] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:31:22,739] WARN [Controller 0]: Partition [__consumer_offsets,6] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:31:22,739] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,28] (kafka.controller.KafkaController)
[2016-11-17 16:31:22,739] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,28] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:31:22,740] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,28] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:31:22,740] WARN [Controller 0]: Partition [__consumer_offsets,28] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:31:22,740] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,4] (kafka.controller.KafkaController)
[2016-11-17 16:31:22,740] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,4] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:31:22,741] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,4] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:31:22,742] WARN [Controller 0]: Partition [__consumer_offsets,4] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:31:22,742] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,44] (kafka.controller.KafkaController)
[2016-11-17 16:31:22,742] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,44] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:31:22,743] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,44] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:31:22,743] WARN [Controller 0]: Partition [__consumer_offsets,44] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:31:22,743] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,42] (kafka.controller.KafkaController)
[2016-11-17 16:31:22,743] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,42] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:31:22,744] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,42] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:31:22,745] WARN [Controller 0]: Partition [__consumer_offsets,42] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:31:22,745] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,34] (kafka.controller.KafkaController)
[2016-11-17 16:31:22,745] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,34] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:31:22,746] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,34] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:31:22,746] WARN [Controller 0]: Partition [__consumer_offsets,34] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:31:22,746] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,46] (kafka.controller.KafkaController)
[2016-11-17 16:31:22,747] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,46] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:31:22,748] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,46] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:31:22,748] WARN [Controller 0]: Partition [__consumer_offsets,46] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:31:22,748] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,32] (kafka.controller.KafkaController)
[2016-11-17 16:31:22,748] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,32] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:31:22,749] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,32] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:31:22,750] WARN [Controller 0]: Partition [__consumer_offsets,32] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:31:22,750] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,36] (kafka.controller.KafkaController)
[2016-11-17 16:31:22,750] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,36] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:31:22,751] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,36] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:31:22,752] WARN [Controller 0]: Partition [__consumer_offsets,36] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:31:22,752] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,38] (kafka.controller.KafkaController)
[2016-11-17 16:31:22,752] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,38] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:31:22,753] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,38] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:31:22,754] WARN [Controller 0]: Partition [__consumer_offsets,38] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:31:22,754] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,2] (kafka.controller.KafkaController)
[2016-11-17 16:31:22,754] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:31:22,755] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:31:22,756] WARN [Controller 0]: Partition [__consumer_offsets,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:31:22,756] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,16] (kafka.controller.KafkaController)
[2016-11-17 16:31:22,756] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,16] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:31:22,757] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,16] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:31:22,758] WARN [Controller 0]: Partition [__consumer_offsets,16] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:31:22,758] DEBUG [Controller 0]: topics not in preferred replica Map([topic2,2] -> List(0, 2, 1), [othertopic,2] -> List(0, 1, 2), [topic4,0] -> List(0, 1)) (kafka.controller.KafkaController)
[2016-11-17 16:31:22,758] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.600000 (kafka.controller.KafkaController)
[2016-11-17 16:31:22,758] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic2,2] (kafka.controller.KafkaController)
[2016-11-17 16:31:22,758] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic2,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:31:22,760] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [topic2,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:31:22,761] WARN [Controller 0]: Partition [topic2,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:31:22,761] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,2] (kafka.controller.KafkaController)
[2016-11-17 16:31:22,761] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:31:22,762] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [othertopic,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:31:22,762] WARN [Controller 0]: Partition [othertopic,2] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
[2016-11-17 16:31:22,762] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic4,0] (kafka.controller.KafkaController)
[2016-11-17 16:31:22,762] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic4,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:31:22,763] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [topic4,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:31:22,764] WARN [Controller 0]: Partition [topic4,0] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
[2016-11-17 16:36:22,681] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2016-11-17 16:36:22,693] DEBUG [Controller 0]: preferred replicas by broker Map(2 -> Map([__consumer_offsets,19] -> List(2, 1), [__consumer_offsets,47] -> List(2, 1), [__consumer_offsets,41] -> List(2, 1), [__consumer_offsets,29] -> List(2, 1), [topic2,1] -> List(2, 1, 0), [__consumer_offsets,39] -> List(2, 1), [__consumer_offsets,17] -> List(2, 1), [__consumer_offsets,33] -> List(2, 1), [__consumer_offsets,5] -> List(2, 1), [__consumer_offsets,3] -> List(2, 1), [__consumer_offsets,21] -> List(2, 1), [othertopic,1] -> List(2, 0, 1), [__consumer_offsets,23] -> List(2, 1), [__consumer_offsets,15] -> List(2, 1), [__consumer_offsets,11] -> List(2, 1), [__consumer_offsets,13] -> List(2, 1), [__consumer_offsets,49] -> List(2, 1), [__consumer_offsets,37] -> List(2, 1), [__consumer_offsets,31] -> List(2, 1), [topic1,0] -> List(2), [topic3,2] -> List(2), [__consumer_offsets,25] -> List(2, 1), [__consumer_offsets,45] -> List(2, 1), [__consumer_offsets,27] -> List(2, 1), [__consumer_offsets,43] -> List(2, 1), [__consumer_offsets,35] -> List(2, 1), [__consumer_offsets,7] -> List(2, 1), [__consumer_offsets,9] -> List(2, 1), [__consumer_offsets,1] -> List(2, 1)), 1 -> Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [topic3,1] -> List(1), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [topic2,0] -> List(1, 0, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2)), 0 -> Map([othertopic,2] -> List(0, 1, 2), [topic2,2] -> List(0, 2, 1), [mytopic,0] -> List(0), [topic3,0] -> List(0), [topic4,0] -> List(0, 1))) (kafka.controller.KafkaController)
[2016-11-17 16:36:22,693] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2016-11-17 16:36:22,693] TRACE [Controller 0]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2016-11-17 16:36:22,693] DEBUG [Controller 0]: topics not in preferred replica Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2)) (kafka.controller.KafkaController)
[2016-11-17 16:36:22,693] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 0.928571 (kafka.controller.KafkaController)
[2016-11-17 16:36:22,693] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,30] (kafka.controller.KafkaController)
[2016-11-17 16:36:22,693] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,30] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:36:22,695] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,30] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:36:22,695] WARN [Controller 0]: Partition [__consumer_offsets,30] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:36:22,695] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,10] (kafka.controller.KafkaController)
[2016-11-17 16:36:22,695] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,10] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:36:22,696] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,10] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:36:22,697] WARN [Controller 0]: Partition [__consumer_offsets,10] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:36:22,697] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,14] (kafka.controller.KafkaController)
[2016-11-17 16:36:22,697] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,14] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:36:22,698] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,14] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:36:22,699] WARN [Controller 0]: Partition [__consumer_offsets,14] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:36:22,699] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,40] (kafka.controller.KafkaController)
[2016-11-17 16:36:22,699] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,40] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:36:22,700] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,40] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:36:22,700] WARN [Controller 0]: Partition [__consumer_offsets,40] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:36:22,700] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,18] (kafka.controller.KafkaController)
[2016-11-17 16:36:22,700] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,18] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:36:22,701] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,18] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:36:22,701] WARN [Controller 0]: Partition [__consumer_offsets,18] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:36:22,701] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,0] (kafka.controller.KafkaController)
[2016-11-17 16:36:22,702] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:36:22,702] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:36:22,703] WARN [Controller 0]: Partition [__consumer_offsets,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:36:22,703] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,26] (kafka.controller.KafkaController)
[2016-11-17 16:36:22,703] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,26] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:36:22,704] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,26] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:36:22,704] WARN [Controller 0]: Partition [__consumer_offsets,26] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:36:22,704] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,24] (kafka.controller.KafkaController)
[2016-11-17 16:36:22,704] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,24] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:36:22,705] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,24] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:36:22,705] WARN [Controller 0]: Partition [__consumer_offsets,24] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:36:22,706] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,0] (kafka.controller.KafkaController)
[2016-11-17 16:36:22,706] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:36:22,707] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [othertopic,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:36:22,707] WARN [Controller 0]: Partition [othertopic,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:36:22,707] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,20] (kafka.controller.KafkaController)
[2016-11-17 16:36:22,707] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,20] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:36:22,708] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,20] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:36:22,709] WARN [Controller 0]: Partition [__consumer_offsets,20] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:36:22,709] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,22] (kafka.controller.KafkaController)
[2016-11-17 16:36:22,709] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,22] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:36:22,710] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,22] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:36:22,710] WARN [Controller 0]: Partition [__consumer_offsets,22] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:36:22,710] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,12] (kafka.controller.KafkaController)
[2016-11-17 16:36:22,710] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,12] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:36:22,711] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,12] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:36:22,711] WARN [Controller 0]: Partition [__consumer_offsets,12] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:36:22,711] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,8] (kafka.controller.KafkaController)
[2016-11-17 16:36:22,711] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,8] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:36:22,712] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,8] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:36:22,713] WARN [Controller 0]: Partition [__consumer_offsets,8] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:36:22,713] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,48] (kafka.controller.KafkaController)
[2016-11-17 16:36:22,713] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,48] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:36:22,714] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,48] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:36:22,714] WARN [Controller 0]: Partition [__consumer_offsets,48] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:36:22,714] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,6] (kafka.controller.KafkaController)
[2016-11-17 16:36:22,714] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,6] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:36:22,715] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,6] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:36:22,716] WARN [Controller 0]: Partition [__consumer_offsets,6] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:36:22,716] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,28] (kafka.controller.KafkaController)
[2016-11-17 16:36:22,716] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,28] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:36:22,717] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,28] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:36:22,717] WARN [Controller 0]: Partition [__consumer_offsets,28] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:36:22,717] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,4] (kafka.controller.KafkaController)
[2016-11-17 16:36:22,717] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,4] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:36:22,718] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,4] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:36:22,718] WARN [Controller 0]: Partition [__consumer_offsets,4] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:36:22,718] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,44] (kafka.controller.KafkaController)
[2016-11-17 16:36:22,718] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,44] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:36:22,719] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,44] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:36:22,720] WARN [Controller 0]: Partition [__consumer_offsets,44] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:36:22,720] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,42] (kafka.controller.KafkaController)
[2016-11-17 16:36:22,720] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,42] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:36:22,721] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,42] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:36:22,721] WARN [Controller 0]: Partition [__consumer_offsets,42] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:36:22,721] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,34] (kafka.controller.KafkaController)
[2016-11-17 16:36:22,721] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,34] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:36:22,722] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,34] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:36:22,723] WARN [Controller 0]: Partition [__consumer_offsets,34] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:36:22,723] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,46] (kafka.controller.KafkaController)
[2016-11-17 16:36:22,723] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,46] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:36:22,724] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,46] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:36:22,724] WARN [Controller 0]: Partition [__consumer_offsets,46] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:36:22,724] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,32] (kafka.controller.KafkaController)
[2016-11-17 16:36:22,724] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,32] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:36:22,725] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,32] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:36:22,725] WARN [Controller 0]: Partition [__consumer_offsets,32] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:36:22,725] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,36] (kafka.controller.KafkaController)
[2016-11-17 16:36:22,725] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,36] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:36:22,726] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,36] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:36:22,727] WARN [Controller 0]: Partition [__consumer_offsets,36] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:36:22,727] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,38] (kafka.controller.KafkaController)
[2016-11-17 16:36:22,727] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,38] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:36:22,728] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,38] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:36:22,728] WARN [Controller 0]: Partition [__consumer_offsets,38] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:36:22,728] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,2] (kafka.controller.KafkaController)
[2016-11-17 16:36:22,728] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:36:22,729] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:36:22,730] WARN [Controller 0]: Partition [__consumer_offsets,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:36:22,730] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,16] (kafka.controller.KafkaController)
[2016-11-17 16:36:22,730] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,16] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:36:22,731] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,16] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:36:22,731] WARN [Controller 0]: Partition [__consumer_offsets,16] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:36:22,732] DEBUG [Controller 0]: topics not in preferred replica Map([topic2,2] -> List(0, 2, 1), [othertopic,2] -> List(0, 1, 2), [topic4,0] -> List(0, 1)) (kafka.controller.KafkaController)
[2016-11-17 16:36:22,732] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.600000 (kafka.controller.KafkaController)
[2016-11-17 16:36:22,732] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic2,2] (kafka.controller.KafkaController)
[2016-11-17 16:36:22,732] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic2,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:36:22,733] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [topic2,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:36:22,733] WARN [Controller 0]: Partition [topic2,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:36:22,733] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,2] (kafka.controller.KafkaController)
[2016-11-17 16:36:22,733] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:36:22,734] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [othertopic,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:36:22,734] WARN [Controller 0]: Partition [othertopic,2] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
[2016-11-17 16:36:22,734] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic4,0] (kafka.controller.KafkaController)
[2016-11-17 16:36:22,734] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic4,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:36:22,735] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [topic4,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:36:22,736] WARN [Controller 0]: Partition [topic4,0] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
[2016-11-17 16:41:22,670] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2016-11-17 16:41:22,681] DEBUG [Controller 0]: preferred replicas by broker Map(2 -> Map([__consumer_offsets,19] -> List(2, 1), [__consumer_offsets,47] -> List(2, 1), [__consumer_offsets,41] -> List(2, 1), [__consumer_offsets,29] -> List(2, 1), [topic2,1] -> List(2, 1, 0), [__consumer_offsets,39] -> List(2, 1), [__consumer_offsets,17] -> List(2, 1), [__consumer_offsets,33] -> List(2, 1), [__consumer_offsets,5] -> List(2, 1), [__consumer_offsets,3] -> List(2, 1), [__consumer_offsets,21] -> List(2, 1), [othertopic,1] -> List(2, 0, 1), [__consumer_offsets,23] -> List(2, 1), [__consumer_offsets,15] -> List(2, 1), [__consumer_offsets,11] -> List(2, 1), [__consumer_offsets,13] -> List(2, 1), [__consumer_offsets,49] -> List(2, 1), [__consumer_offsets,37] -> List(2, 1), [__consumer_offsets,31] -> List(2, 1), [topic1,0] -> List(2), [topic3,2] -> List(2), [__consumer_offsets,25] -> List(2, 1), [__consumer_offsets,45] -> List(2, 1), [__consumer_offsets,27] -> List(2, 1), [__consumer_offsets,43] -> List(2, 1), [__consumer_offsets,35] -> List(2, 1), [__consumer_offsets,7] -> List(2, 1), [__consumer_offsets,9] -> List(2, 1), [__consumer_offsets,1] -> List(2, 1)), 1 -> Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [topic3,1] -> List(1), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [topic2,0] -> List(1, 0, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2)), 0 -> Map([othertopic,2] -> List(0, 1, 2), [topic2,2] -> List(0, 2, 1), [mytopic,0] -> List(0), [topic3,0] -> List(0), [topic4,0] -> List(0, 1))) (kafka.controller.KafkaController)
[2016-11-17 16:41:22,682] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2016-11-17 16:41:22,682] TRACE [Controller 0]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2016-11-17 16:41:22,682] DEBUG [Controller 0]: topics not in preferred replica Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2)) (kafka.controller.KafkaController)
[2016-11-17 16:41:22,682] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 0.928571 (kafka.controller.KafkaController)
[2016-11-17 16:41:22,682] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,30] (kafka.controller.KafkaController)
[2016-11-17 16:41:22,682] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,30] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:41:22,693] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,30] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:41:22,694] WARN [Controller 0]: Partition [__consumer_offsets,30] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:41:22,694] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,10] (kafka.controller.KafkaController)
[2016-11-17 16:41:22,694] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,10] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:41:22,695] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,10] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:41:22,695] WARN [Controller 0]: Partition [__consumer_offsets,10] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:41:22,695] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,14] (kafka.controller.KafkaController)
[2016-11-17 16:41:22,695] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,14] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:41:22,696] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,14] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:41:22,697] WARN [Controller 0]: Partition [__consumer_offsets,14] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:41:22,697] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,40] (kafka.controller.KafkaController)
[2016-11-17 16:41:22,697] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,40] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:41:22,698] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,40] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:41:22,698] WARN [Controller 0]: Partition [__consumer_offsets,40] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:41:22,699] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,18] (kafka.controller.KafkaController)
[2016-11-17 16:41:22,699] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,18] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:41:22,700] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,18] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:41:22,700] WARN [Controller 0]: Partition [__consumer_offsets,18] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:41:22,700] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,0] (kafka.controller.KafkaController)
[2016-11-17 16:41:22,700] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:41:22,701] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:41:22,702] WARN [Controller 0]: Partition [__consumer_offsets,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:41:22,702] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,26] (kafka.controller.KafkaController)
[2016-11-17 16:41:22,702] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,26] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:41:22,703] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,26] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:41:22,703] WARN [Controller 0]: Partition [__consumer_offsets,26] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:41:22,703] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,24] (kafka.controller.KafkaController)
[2016-11-17 16:41:22,703] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,24] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:41:22,704] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,24] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:41:22,704] WARN [Controller 0]: Partition [__consumer_offsets,24] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:41:22,704] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,0] (kafka.controller.KafkaController)
[2016-11-17 16:41:22,704] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:41:22,706] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [othertopic,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:41:22,706] WARN [Controller 0]: Partition [othertopic,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:41:22,706] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,20] (kafka.controller.KafkaController)
[2016-11-17 16:41:22,706] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,20] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:41:22,707] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,20] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:41:22,708] WARN [Controller 0]: Partition [__consumer_offsets,20] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:41:22,708] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,22] (kafka.controller.KafkaController)
[2016-11-17 16:41:22,708] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,22] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:41:22,709] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,22] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:41:22,709] WARN [Controller 0]: Partition [__consumer_offsets,22] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:41:22,709] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,12] (kafka.controller.KafkaController)
[2016-11-17 16:41:22,709] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,12] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:41:22,710] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,12] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:41:22,710] WARN [Controller 0]: Partition [__consumer_offsets,12] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:41:22,710] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,8] (kafka.controller.KafkaController)
[2016-11-17 16:41:22,710] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,8] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:41:22,711] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,8] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:41:22,712] WARN [Controller 0]: Partition [__consumer_offsets,8] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:41:22,712] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,48] (kafka.controller.KafkaController)
[2016-11-17 16:41:22,712] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,48] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:41:22,713] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,48] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:41:22,713] WARN [Controller 0]: Partition [__consumer_offsets,48] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:41:22,713] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,6] (kafka.controller.KafkaController)
[2016-11-17 16:41:22,713] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,6] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:41:22,714] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,6] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:41:22,714] WARN [Controller 0]: Partition [__consumer_offsets,6] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:41:22,714] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,28] (kafka.controller.KafkaController)
[2016-11-17 16:41:22,714] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,28] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:41:22,715] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,28] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:41:22,715] WARN [Controller 0]: Partition [__consumer_offsets,28] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:41:22,715] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,4] (kafka.controller.KafkaController)
[2016-11-17 16:41:22,715] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,4] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:41:22,716] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,4] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:41:22,717] WARN [Controller 0]: Partition [__consumer_offsets,4] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:41:22,717] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,44] (kafka.controller.KafkaController)
[2016-11-17 16:41:22,717] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,44] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:41:22,718] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,44] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:41:22,718] WARN [Controller 0]: Partition [__consumer_offsets,44] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:41:22,718] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,42] (kafka.controller.KafkaController)
[2016-11-17 16:41:22,718] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,42] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:41:22,719] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,42] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:41:22,719] WARN [Controller 0]: Partition [__consumer_offsets,42] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:41:22,719] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,34] (kafka.controller.KafkaController)
[2016-11-17 16:41:22,719] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,34] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:41:22,720] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,34] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:41:22,721] WARN [Controller 0]: Partition [__consumer_offsets,34] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:41:22,721] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,46] (kafka.controller.KafkaController)
[2016-11-17 16:41:22,721] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,46] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:41:22,722] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,46] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:41:22,722] WARN [Controller 0]: Partition [__consumer_offsets,46] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:41:22,723] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,32] (kafka.controller.KafkaController)
[2016-11-17 16:41:22,723] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,32] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:41:22,724] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,32] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:41:22,724] WARN [Controller 0]: Partition [__consumer_offsets,32] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:41:22,724] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,36] (kafka.controller.KafkaController)
[2016-11-17 16:41:22,724] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,36] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:41:22,725] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,36] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:41:22,725] WARN [Controller 0]: Partition [__consumer_offsets,36] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:41:22,725] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,38] (kafka.controller.KafkaController)
[2016-11-17 16:41:22,725] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,38] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:41:22,726] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,38] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:41:22,726] WARN [Controller 0]: Partition [__consumer_offsets,38] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:41:22,726] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,2] (kafka.controller.KafkaController)
[2016-11-17 16:41:22,727] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:41:22,727] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:41:22,728] WARN [Controller 0]: Partition [__consumer_offsets,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:41:22,728] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,16] (kafka.controller.KafkaController)
[2016-11-17 16:41:22,728] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,16] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:41:22,729] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,16] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:41:22,729] WARN [Controller 0]: Partition [__consumer_offsets,16] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:41:22,729] DEBUG [Controller 0]: topics not in preferred replica Map([topic2,2] -> List(0, 2, 1), [othertopic,2] -> List(0, 1, 2), [topic4,0] -> List(0, 1)) (kafka.controller.KafkaController)
[2016-11-17 16:41:22,729] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.600000 (kafka.controller.KafkaController)
[2016-11-17 16:41:22,729] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic2,2] (kafka.controller.KafkaController)
[2016-11-17 16:41:22,729] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic2,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:41:22,730] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [topic2,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:41:22,731] WARN [Controller 0]: Partition [topic2,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:41:22,731] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,2] (kafka.controller.KafkaController)
[2016-11-17 16:41:22,731] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:41:22,732] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [othertopic,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:41:22,732] WARN [Controller 0]: Partition [othertopic,2] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
[2016-11-17 16:41:22,732] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic4,0] (kafka.controller.KafkaController)
[2016-11-17 16:41:22,732] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic4,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:41:22,733] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [topic4,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:41:22,733] WARN [Controller 0]: Partition [topic4,0] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
[2016-11-17 16:46:22,656] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2016-11-17 16:46:22,657] DEBUG [Controller 0]: preferred replicas by broker Map(2 -> Map([__consumer_offsets,19] -> List(2, 1), [__consumer_offsets,47] -> List(2, 1), [__consumer_offsets,41] -> List(2, 1), [__consumer_offsets,29] -> List(2, 1), [topic2,1] -> List(2, 1, 0), [__consumer_offsets,39] -> List(2, 1), [__consumer_offsets,17] -> List(2, 1), [__consumer_offsets,33] -> List(2, 1), [__consumer_offsets,5] -> List(2, 1), [__consumer_offsets,3] -> List(2, 1), [__consumer_offsets,21] -> List(2, 1), [othertopic,1] -> List(2, 0, 1), [__consumer_offsets,23] -> List(2, 1), [__consumer_offsets,15] -> List(2, 1), [__consumer_offsets,11] -> List(2, 1), [__consumer_offsets,13] -> List(2, 1), [__consumer_offsets,49] -> List(2, 1), [__consumer_offsets,37] -> List(2, 1), [__consumer_offsets,31] -> List(2, 1), [topic1,0] -> List(2), [topic3,2] -> List(2), [__consumer_offsets,25] -> List(2, 1), [__consumer_offsets,45] -> List(2, 1), [__consumer_offsets,27] -> List(2, 1), [__consumer_offsets,43] -> List(2, 1), [__consumer_offsets,35] -> List(2, 1), [__consumer_offsets,7] -> List(2, 1), [__consumer_offsets,9] -> List(2, 1), [__consumer_offsets,1] -> List(2, 1)), 1 -> Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [topic3,1] -> List(1), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [topic2,0] -> List(1, 0, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2)), 0 -> Map([othertopic,2] -> List(0, 1, 2), [topic2,2] -> List(0, 2, 1), [mytopic,0] -> List(0), [topic3,0] -> List(0), [topic4,0] -> List(0, 1))) (kafka.controller.KafkaController)
[2016-11-17 16:46:22,657] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2016-11-17 16:46:22,657] TRACE [Controller 0]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2016-11-17 16:46:22,657] DEBUG [Controller 0]: topics not in preferred replica Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2)) (kafka.controller.KafkaController)
[2016-11-17 16:46:22,657] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 0.928571 (kafka.controller.KafkaController)
[2016-11-17 16:46:22,657] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,30] (kafka.controller.KafkaController)
[2016-11-17 16:46:22,657] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,30] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:46:22,659] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,30] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:46:22,659] WARN [Controller 0]: Partition [__consumer_offsets,30] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:46:22,659] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,10] (kafka.controller.KafkaController)
[2016-11-17 16:46:22,659] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,10] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:46:22,660] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,10] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:46:22,661] WARN [Controller 0]: Partition [__consumer_offsets,10] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:46:22,661] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,14] (kafka.controller.KafkaController)
[2016-11-17 16:46:22,661] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,14] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:46:22,662] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,14] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:46:22,663] WARN [Controller 0]: Partition [__consumer_offsets,14] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:46:22,663] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,40] (kafka.controller.KafkaController)
[2016-11-17 16:46:22,663] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,40] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:46:22,664] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,40] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:46:22,664] WARN [Controller 0]: Partition [__consumer_offsets,40] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:46:22,664] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,18] (kafka.controller.KafkaController)
[2016-11-17 16:46:22,664] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,18] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:46:22,665] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,18] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:46:22,666] WARN [Controller 0]: Partition [__consumer_offsets,18] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:46:22,666] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,0] (kafka.controller.KafkaController)
[2016-11-17 16:46:22,666] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:46:22,667] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:46:22,667] WARN [Controller 0]: Partition [__consumer_offsets,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:46:22,667] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,26] (kafka.controller.KafkaController)
[2016-11-17 16:46:22,667] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,26] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:46:22,669] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,26] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:46:22,669] WARN [Controller 0]: Partition [__consumer_offsets,26] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:46:22,669] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,24] (kafka.controller.KafkaController)
[2016-11-17 16:46:22,669] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,24] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:46:22,671] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,24] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:46:22,671] WARN [Controller 0]: Partition [__consumer_offsets,24] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:46:22,671] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,0] (kafka.controller.KafkaController)
[2016-11-17 16:46:22,671] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:46:22,672] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [othertopic,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:46:22,673] WARN [Controller 0]: Partition [othertopic,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:46:22,673] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,20] (kafka.controller.KafkaController)
[2016-11-17 16:46:22,673] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,20] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:46:22,674] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,20] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:46:22,674] WARN [Controller 0]: Partition [__consumer_offsets,20] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:46:22,674] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,22] (kafka.controller.KafkaController)
[2016-11-17 16:46:22,674] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,22] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:46:22,675] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,22] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:46:22,676] WARN [Controller 0]: Partition [__consumer_offsets,22] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:46:22,676] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,12] (kafka.controller.KafkaController)
[2016-11-17 16:46:22,676] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,12] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:46:22,677] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,12] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:46:22,677] WARN [Controller 0]: Partition [__consumer_offsets,12] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:46:22,677] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,8] (kafka.controller.KafkaController)
[2016-11-17 16:46:22,677] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,8] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:46:22,678] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,8] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:46:22,679] WARN [Controller 0]: Partition [__consumer_offsets,8] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:46:22,679] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,48] (kafka.controller.KafkaController)
[2016-11-17 16:46:22,679] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,48] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:46:22,680] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,48] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:46:22,680] WARN [Controller 0]: Partition [__consumer_offsets,48] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:46:22,680] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,6] (kafka.controller.KafkaController)
[2016-11-17 16:46:22,680] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,6] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:46:22,681] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,6] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:46:22,681] WARN [Controller 0]: Partition [__consumer_offsets,6] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:46:22,681] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,28] (kafka.controller.KafkaController)
[2016-11-17 16:46:22,682] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,28] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:46:22,682] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,28] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:46:22,683] WARN [Controller 0]: Partition [__consumer_offsets,28] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:46:22,683] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,4] (kafka.controller.KafkaController)
[2016-11-17 16:46:22,683] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,4] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:46:22,684] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,4] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:46:22,684] WARN [Controller 0]: Partition [__consumer_offsets,4] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:46:22,684] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,44] (kafka.controller.KafkaController)
[2016-11-17 16:46:22,684] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,44] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:46:22,685] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,44] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:46:22,686] WARN [Controller 0]: Partition [__consumer_offsets,44] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:46:22,686] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,42] (kafka.controller.KafkaController)
[2016-11-17 16:46:22,686] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,42] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:46:22,687] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,42] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:46:22,687] WARN [Controller 0]: Partition [__consumer_offsets,42] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:46:22,687] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,34] (kafka.controller.KafkaController)
[2016-11-17 16:46:22,687] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,34] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:46:22,688] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,34] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:46:22,689] WARN [Controller 0]: Partition [__consumer_offsets,34] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:46:22,689] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,46] (kafka.controller.KafkaController)
[2016-11-17 16:46:22,689] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,46] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:46:22,690] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,46] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:46:22,691] WARN [Controller 0]: Partition [__consumer_offsets,46] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:46:22,691] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,32] (kafka.controller.KafkaController)
[2016-11-17 16:46:22,691] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,32] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:46:22,692] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,32] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:46:22,692] WARN [Controller 0]: Partition [__consumer_offsets,32] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:46:22,692] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,36] (kafka.controller.KafkaController)
[2016-11-17 16:46:22,692] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,36] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:46:22,693] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,36] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:46:22,693] WARN [Controller 0]: Partition [__consumer_offsets,36] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:46:22,693] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,38] (kafka.controller.KafkaController)
[2016-11-17 16:46:22,693] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,38] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:46:22,694] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,38] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:46:22,695] WARN [Controller 0]: Partition [__consumer_offsets,38] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:46:22,695] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,2] (kafka.controller.KafkaController)
[2016-11-17 16:46:22,695] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:46:22,696] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:46:22,696] WARN [Controller 0]: Partition [__consumer_offsets,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:46:22,696] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,16] (kafka.controller.KafkaController)
[2016-11-17 16:46:22,696] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,16] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:46:22,697] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,16] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:46:22,698] WARN [Controller 0]: Partition [__consumer_offsets,16] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:46:22,698] DEBUG [Controller 0]: topics not in preferred replica Map([topic2,2] -> List(0, 2, 1), [othertopic,2] -> List(0, 1, 2), [topic4,0] -> List(0, 1)) (kafka.controller.KafkaController)
[2016-11-17 16:46:22,698] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.600000 (kafka.controller.KafkaController)
[2016-11-17 16:46:22,698] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic2,2] (kafka.controller.KafkaController)
[2016-11-17 16:46:22,698] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic2,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:46:22,699] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [topic2,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:46:22,700] WARN [Controller 0]: Partition [topic2,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:46:22,700] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,2] (kafka.controller.KafkaController)
[2016-11-17 16:46:22,700] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:46:22,701] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [othertopic,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:46:22,702] WARN [Controller 0]: Partition [othertopic,2] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
[2016-11-17 16:46:22,702] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic4,0] (kafka.controller.KafkaController)
[2016-11-17 16:46:22,702] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic4,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:46:22,703] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [topic4,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:46:22,704] WARN [Controller 0]: Partition [topic4,0] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
[2016-11-17 16:51:22,644] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2016-11-17 16:51:22,644] DEBUG [Controller 0]: preferred replicas by broker Map(2 -> Map([__consumer_offsets,19] -> List(2, 1), [__consumer_offsets,47] -> List(2, 1), [__consumer_offsets,41] -> List(2, 1), [__consumer_offsets,29] -> List(2, 1), [topic2,1] -> List(2, 1, 0), [__consumer_offsets,39] -> List(2, 1), [__consumer_offsets,17] -> List(2, 1), [__consumer_offsets,33] -> List(2, 1), [__consumer_offsets,5] -> List(2, 1), [__consumer_offsets,3] -> List(2, 1), [__consumer_offsets,21] -> List(2, 1), [othertopic,1] -> List(2, 0, 1), [__consumer_offsets,23] -> List(2, 1), [__consumer_offsets,15] -> List(2, 1), [__consumer_offsets,11] -> List(2, 1), [__consumer_offsets,13] -> List(2, 1), [__consumer_offsets,49] -> List(2, 1), [__consumer_offsets,37] -> List(2, 1), [__consumer_offsets,31] -> List(2, 1), [topic1,0] -> List(2), [topic3,2] -> List(2), [__consumer_offsets,25] -> List(2, 1), [__consumer_offsets,45] -> List(2, 1), [__consumer_offsets,27] -> List(2, 1), [__consumer_offsets,43] -> List(2, 1), [__consumer_offsets,35] -> List(2, 1), [__consumer_offsets,7] -> List(2, 1), [__consumer_offsets,9] -> List(2, 1), [__consumer_offsets,1] -> List(2, 1)), 1 -> Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [topic3,1] -> List(1), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [topic2,0] -> List(1, 0, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2)), 0 -> Map([othertopic,2] -> List(0, 1, 2), [topic2,2] -> List(0, 2, 1), [mytopic,0] -> List(0), [topic3,0] -> List(0), [topic4,0] -> List(0, 1))) (kafka.controller.KafkaController)
[2016-11-17 16:51:22,644] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2016-11-17 16:51:22,644] TRACE [Controller 0]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2016-11-17 16:51:22,644] DEBUG [Controller 0]: topics not in preferred replica Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2)) (kafka.controller.KafkaController)
[2016-11-17 16:51:22,644] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 0.928571 (kafka.controller.KafkaController)
[2016-11-17 16:51:22,644] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,30] (kafka.controller.KafkaController)
[2016-11-17 16:51:22,645] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,30] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:51:22,646] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,30] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:51:22,647] WARN [Controller 0]: Partition [__consumer_offsets,30] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:51:22,647] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,10] (kafka.controller.KafkaController)
[2016-11-17 16:51:22,647] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,10] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:51:22,649] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,10] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:51:22,650] WARN [Controller 0]: Partition [__consumer_offsets,10] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:51:22,650] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,14] (kafka.controller.KafkaController)
[2016-11-17 16:51:22,650] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,14] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:51:22,653] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,14] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:51:22,654] WARN [Controller 0]: Partition [__consumer_offsets,14] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:51:22,654] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,40] (kafka.controller.KafkaController)
[2016-11-17 16:51:22,655] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,40] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:51:22,656] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,40] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:51:22,656] WARN [Controller 0]: Partition [__consumer_offsets,40] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:51:22,656] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,18] (kafka.controller.KafkaController)
[2016-11-17 16:51:22,656] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,18] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:51:22,658] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,18] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:51:22,658] WARN [Controller 0]: Partition [__consumer_offsets,18] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:51:22,658] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,0] (kafka.controller.KafkaController)
[2016-11-17 16:51:22,658] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:51:22,659] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:51:22,660] WARN [Controller 0]: Partition [__consumer_offsets,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:51:22,660] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,26] (kafka.controller.KafkaController)
[2016-11-17 16:51:22,660] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,26] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:51:22,661] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,26] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:51:22,662] WARN [Controller 0]: Partition [__consumer_offsets,26] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:51:22,662] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,24] (kafka.controller.KafkaController)
[2016-11-17 16:51:22,662] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,24] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:51:22,663] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,24] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:51:22,664] WARN [Controller 0]: Partition [__consumer_offsets,24] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:51:22,664] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,0] (kafka.controller.KafkaController)
[2016-11-17 16:51:22,664] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:51:22,665] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [othertopic,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:51:22,666] WARN [Controller 0]: Partition [othertopic,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:51:22,666] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,20] (kafka.controller.KafkaController)
[2016-11-17 16:51:22,666] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,20] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:51:22,667] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,20] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:51:22,668] WARN [Controller 0]: Partition [__consumer_offsets,20] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:51:22,668] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,22] (kafka.controller.KafkaController)
[2016-11-17 16:51:22,668] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,22] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:51:22,669] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,22] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:51:22,669] WARN [Controller 0]: Partition [__consumer_offsets,22] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:51:22,669] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,12] (kafka.controller.KafkaController)
[2016-11-17 16:51:22,669] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,12] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:51:22,670] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,12] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:51:22,670] WARN [Controller 0]: Partition [__consumer_offsets,12] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:51:22,670] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,8] (kafka.controller.KafkaController)
[2016-11-17 16:51:22,671] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,8] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:51:22,671] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,8] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:51:22,672] WARN [Controller 0]: Partition [__consumer_offsets,8] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:51:22,672] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,48] (kafka.controller.KafkaController)
[2016-11-17 16:51:22,672] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,48] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:51:22,673] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,48] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:51:22,673] WARN [Controller 0]: Partition [__consumer_offsets,48] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:51:22,673] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,6] (kafka.controller.KafkaController)
[2016-11-17 16:51:22,673] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,6] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:51:22,674] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,6] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:51:22,675] WARN [Controller 0]: Partition [__consumer_offsets,6] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:51:22,675] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,28] (kafka.controller.KafkaController)
[2016-11-17 16:51:22,675] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,28] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:51:22,676] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,28] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:51:22,676] WARN [Controller 0]: Partition [__consumer_offsets,28] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:51:22,676] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,4] (kafka.controller.KafkaController)
[2016-11-17 16:51:22,676] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,4] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:51:22,677] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,4] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:51:22,677] WARN [Controller 0]: Partition [__consumer_offsets,4] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:51:22,677] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,44] (kafka.controller.KafkaController)
[2016-11-17 16:51:22,678] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,44] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:51:22,678] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,44] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:51:22,679] WARN [Controller 0]: Partition [__consumer_offsets,44] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:51:22,679] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,42] (kafka.controller.KafkaController)
[2016-11-17 16:51:22,679] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,42] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:51:22,680] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,42] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:51:22,680] WARN [Controller 0]: Partition [__consumer_offsets,42] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:51:22,680] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,34] (kafka.controller.KafkaController)
[2016-11-17 16:51:22,680] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,34] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:51:22,681] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,34] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:51:22,681] WARN [Controller 0]: Partition [__consumer_offsets,34] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:51:22,682] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,46] (kafka.controller.KafkaController)
[2016-11-17 16:51:22,682] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,46] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:51:22,682] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,46] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:51:22,683] WARN [Controller 0]: Partition [__consumer_offsets,46] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:51:22,683] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,32] (kafka.controller.KafkaController)
[2016-11-17 16:51:22,683] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,32] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:51:22,684] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,32] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:51:22,684] WARN [Controller 0]: Partition [__consumer_offsets,32] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:51:22,684] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,36] (kafka.controller.KafkaController)
[2016-11-17 16:51:22,684] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,36] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:51:22,686] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,36] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:51:22,686] WARN [Controller 0]: Partition [__consumer_offsets,36] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:51:22,686] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,38] (kafka.controller.KafkaController)
[2016-11-17 16:51:22,686] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,38] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:51:22,688] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,38] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:51:22,688] WARN [Controller 0]: Partition [__consumer_offsets,38] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:51:22,688] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,2] (kafka.controller.KafkaController)
[2016-11-17 16:51:22,688] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:51:22,690] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:51:22,691] WARN [Controller 0]: Partition [__consumer_offsets,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:51:22,691] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,16] (kafka.controller.KafkaController)
[2016-11-17 16:51:22,691] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,16] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:51:22,692] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,16] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:51:22,693] WARN [Controller 0]: Partition [__consumer_offsets,16] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:51:22,693] DEBUG [Controller 0]: topics not in preferred replica Map([topic2,2] -> List(0, 2, 1), [othertopic,2] -> List(0, 1, 2), [topic4,0] -> List(0, 1)) (kafka.controller.KafkaController)
[2016-11-17 16:51:22,693] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.600000 (kafka.controller.KafkaController)
[2016-11-17 16:51:22,693] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic2,2] (kafka.controller.KafkaController)
[2016-11-17 16:51:22,693] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic2,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:51:22,694] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [topic2,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:51:22,695] WARN [Controller 0]: Partition [topic2,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:51:22,695] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,2] (kafka.controller.KafkaController)
[2016-11-17 16:51:22,695] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:51:22,696] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [othertopic,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:51:22,696] WARN [Controller 0]: Partition [othertopic,2] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
[2016-11-17 16:51:22,696] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic4,0] (kafka.controller.KafkaController)
[2016-11-17 16:51:22,696] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic4,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:51:22,697] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [topic4,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:51:22,698] WARN [Controller 0]: Partition [topic4,0] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
[2016-11-17 16:56:22,628] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2016-11-17 16:56:22,650] DEBUG [Controller 0]: preferred replicas by broker Map(2 -> Map([__consumer_offsets,19] -> List(2, 1), [__consumer_offsets,47] -> List(2, 1), [__consumer_offsets,41] -> List(2, 1), [__consumer_offsets,29] -> List(2, 1), [topic2,1] -> List(2, 1, 0), [__consumer_offsets,39] -> List(2, 1), [__consumer_offsets,17] -> List(2, 1), [__consumer_offsets,33] -> List(2, 1), [__consumer_offsets,5] -> List(2, 1), [__consumer_offsets,3] -> List(2, 1), [__consumer_offsets,21] -> List(2, 1), [othertopic,1] -> List(2, 0, 1), [__consumer_offsets,23] -> List(2, 1), [__consumer_offsets,15] -> List(2, 1), [__consumer_offsets,11] -> List(2, 1), [__consumer_offsets,13] -> List(2, 1), [__consumer_offsets,49] -> List(2, 1), [__consumer_offsets,37] -> List(2, 1), [__consumer_offsets,31] -> List(2, 1), [topic1,0] -> List(2), [topic3,2] -> List(2), [__consumer_offsets,25] -> List(2, 1), [__consumer_offsets,45] -> List(2, 1), [__consumer_offsets,27] -> List(2, 1), [__consumer_offsets,43] -> List(2, 1), [__consumer_offsets,35] -> List(2, 1), [__consumer_offsets,7] -> List(2, 1), [__consumer_offsets,9] -> List(2, 1), [__consumer_offsets,1] -> List(2, 1)), 1 -> Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [topic3,1] -> List(1), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [topic2,0] -> List(1, 0, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2)), 0 -> Map([othertopic,2] -> List(0, 1, 2), [topic2,2] -> List(0, 2, 1), [mytopic,0] -> List(0), [topic3,0] -> List(0), [topic4,0] -> List(0, 1))) (kafka.controller.KafkaController)
[2016-11-17 16:56:22,663] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2016-11-17 16:56:22,663] TRACE [Controller 0]: leader imbalance ratio for broker 2 is 0.000000 (kafka.controller.KafkaController)
[2016-11-17 16:56:22,663] DEBUG [Controller 0]: topics not in preferred replica Map([__consumer_offsets,30] -> List(1, 2), [__consumer_offsets,10] -> List(1, 2), [__consumer_offsets,14] -> List(1, 2), [__consumer_offsets,40] -> List(1, 2), [__consumer_offsets,18] -> List(1, 2), [__consumer_offsets,0] -> List(1, 2), [__consumer_offsets,26] -> List(1, 2), [__consumer_offsets,24] -> List(1, 2), [othertopic,0] -> List(1, 2, 0), [__consumer_offsets,20] -> List(1, 2), [__consumer_offsets,22] -> List(1, 2), [__consumer_offsets,12] -> List(1, 2), [__consumer_offsets,8] -> List(1, 2), [__consumer_offsets,48] -> List(1, 2), [__consumer_offsets,6] -> List(1, 2), [__consumer_offsets,28] -> List(1, 2), [__consumer_offsets,4] -> List(1, 2), [__consumer_offsets,44] -> List(1, 2), [__consumer_offsets,42] -> List(1, 2), [__consumer_offsets,34] -> List(1, 2), [__consumer_offsets,46] -> List(1, 2), [__consumer_offsets,32] -> List(1, 2), [__consumer_offsets,36] -> List(1, 2), [__consumer_offsets,38] -> List(1, 2), [__consumer_offsets,2] -> List(1, 2), [__consumer_offsets,16] -> List(1, 2)) (kafka.controller.KafkaController)
[2016-11-17 16:56:22,664] TRACE [Controller 0]: leader imbalance ratio for broker 1 is 0.928571 (kafka.controller.KafkaController)
[2016-11-17 16:56:22,664] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,30] (kafka.controller.KafkaController)
[2016-11-17 16:56:22,664] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,30] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:56:22,700] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,30] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:56:22,701] WARN [Controller 0]: Partition [__consumer_offsets,30] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:56:22,701] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,10] (kafka.controller.KafkaController)
[2016-11-17 16:56:22,701] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,10] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:56:22,702] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,10] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:56:22,703] WARN [Controller 0]: Partition [__consumer_offsets,10] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:56:22,703] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,14] (kafka.controller.KafkaController)
[2016-11-17 16:56:22,703] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,14] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:56:22,705] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,14] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:56:22,706] WARN [Controller 0]: Partition [__consumer_offsets,14] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:56:22,706] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,40] (kafka.controller.KafkaController)
[2016-11-17 16:56:22,706] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,40] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:56:22,707] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,40] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:56:22,708] WARN [Controller 0]: Partition [__consumer_offsets,40] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:56:22,708] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,18] (kafka.controller.KafkaController)
[2016-11-17 16:56:22,708] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,18] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:56:22,709] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,18] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:56:22,710] WARN [Controller 0]: Partition [__consumer_offsets,18] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:56:22,710] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,0] (kafka.controller.KafkaController)
[2016-11-17 16:56:22,710] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:56:22,711] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:56:22,712] WARN [Controller 0]: Partition [__consumer_offsets,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:56:22,712] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,26] (kafka.controller.KafkaController)
[2016-11-17 16:56:22,712] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,26] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:56:22,713] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,26] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:56:22,714] WARN [Controller 0]: Partition [__consumer_offsets,26] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:56:22,714] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,24] (kafka.controller.KafkaController)
[2016-11-17 16:56:22,714] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,24] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:56:22,715] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,24] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:56:22,715] WARN [Controller 0]: Partition [__consumer_offsets,24] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:56:22,715] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,0] (kafka.controller.KafkaController)
[2016-11-17 16:56:22,715] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:56:22,716] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [othertopic,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:56:22,717] WARN [Controller 0]: Partition [othertopic,0] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:56:22,717] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,20] (kafka.controller.KafkaController)
[2016-11-17 16:56:22,717] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,20] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:56:22,718] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,20] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:56:22,718] WARN [Controller 0]: Partition [__consumer_offsets,20] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:56:22,718] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,22] (kafka.controller.KafkaController)
[2016-11-17 16:56:22,718] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,22] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:56:22,720] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,22] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:56:22,721] WARN [Controller 0]: Partition [__consumer_offsets,22] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:56:22,721] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,12] (kafka.controller.KafkaController)
[2016-11-17 16:56:22,721] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,12] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:56:22,723] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,12] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:56:22,723] WARN [Controller 0]: Partition [__consumer_offsets,12] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:56:22,724] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,8] (kafka.controller.KafkaController)
[2016-11-17 16:56:22,724] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,8] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:56:22,726] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,8] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:56:22,727] WARN [Controller 0]: Partition [__consumer_offsets,8] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:56:22,727] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,48] (kafka.controller.KafkaController)
[2016-11-17 16:56:22,727] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,48] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:56:22,730] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,48] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:56:22,731] WARN [Controller 0]: Partition [__consumer_offsets,48] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:56:22,731] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,6] (kafka.controller.KafkaController)
[2016-11-17 16:56:22,731] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,6] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:56:22,732] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,6] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:56:22,733] WARN [Controller 0]: Partition [__consumer_offsets,6] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:56:22,733] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,28] (kafka.controller.KafkaController)
[2016-11-17 16:56:22,733] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,28] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:56:22,735] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,28] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:56:22,736] WARN [Controller 0]: Partition [__consumer_offsets,28] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:56:22,736] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,4] (kafka.controller.KafkaController)
[2016-11-17 16:56:22,736] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,4] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:56:22,748] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,4] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:56:22,749] WARN [Controller 0]: Partition [__consumer_offsets,4] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:56:22,749] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,44] (kafka.controller.KafkaController)
[2016-11-17 16:56:22,749] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,44] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:56:22,756] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,44] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:56:22,756] WARN [Controller 0]: Partition [__consumer_offsets,44] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:56:22,756] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,42] (kafka.controller.KafkaController)
[2016-11-17 16:56:22,756] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,42] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:56:22,759] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,42] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:56:22,760] WARN [Controller 0]: Partition [__consumer_offsets,42] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:56:22,760] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,34] (kafka.controller.KafkaController)
[2016-11-17 16:56:22,760] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,34] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:56:22,762] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,34] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:56:22,764] WARN [Controller 0]: Partition [__consumer_offsets,34] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:56:22,764] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,46] (kafka.controller.KafkaController)
[2016-11-17 16:56:22,764] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,46] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:56:22,771] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,46] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:56:22,772] WARN [Controller 0]: Partition [__consumer_offsets,46] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:56:22,772] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,32] (kafka.controller.KafkaController)
[2016-11-17 16:56:22,772] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,32] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:56:22,774] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,32] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:56:22,786] WARN [Controller 0]: Partition [__consumer_offsets,32] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:56:22,787] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,36] (kafka.controller.KafkaController)
[2016-11-17 16:56:22,787] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,36] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:56:22,788] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,36] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:56:22,789] WARN [Controller 0]: Partition [__consumer_offsets,36] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:56:22,789] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,38] (kafka.controller.KafkaController)
[2016-11-17 16:56:22,789] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,38] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:56:22,791] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,38] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:56:22,793] WARN [Controller 0]: Partition [__consumer_offsets,38] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:56:22,793] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,2] (kafka.controller.KafkaController)
[2016-11-17 16:56:22,793] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:56:22,794] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:56:22,795] WARN [Controller 0]: Partition [__consumer_offsets,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:56:22,795] INFO [Controller 0]: Starting preferred replica leader election for partitions [__consumer_offsets,16] (kafka.controller.KafkaController)
[2016-11-17 16:56:22,795] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [__consumer_offsets,16] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:56:22,797] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [__consumer_offsets,16] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:56:22,797] WARN [Controller 0]: Partition [__consumer_offsets,16] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:56:22,797] DEBUG [Controller 0]: topics not in preferred replica Map([topic2,2] -> List(0, 2, 1), [othertopic,2] -> List(0, 1, 2), [topic4,0] -> List(0, 1)) (kafka.controller.KafkaController)
[2016-11-17 16:56:22,798] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.600000 (kafka.controller.KafkaController)
[2016-11-17 16:56:22,798] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic2,2] (kafka.controller.KafkaController)
[2016-11-17 16:56:22,798] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic2,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:56:22,799] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 2 for partition [topic2,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:56:22,800] WARN [Controller 0]: Partition [topic2,2] failed to complete preferred replica leader election. Leader is 2 (kafka.controller.KafkaController)
[2016-11-17 16:56:22,800] INFO [Controller 0]: Starting preferred replica leader election for partitions [othertopic,2] (kafka.controller.KafkaController)
[2016-11-17 16:56:22,800] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [othertopic,2] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:56:22,802] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [othertopic,2] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:56:22,803] WARN [Controller 0]: Partition [othertopic,2] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
[2016-11-17 16:56:22,803] INFO [Controller 0]: Starting preferred replica leader election for partitions [topic4,0] (kafka.controller.KafkaController)
[2016-11-17 16:56:22,803] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions [topic4,0] (kafka.controller.PartitionStateMachine)
[2016-11-17 16:56:22,805] INFO [PreferredReplicaPartitionLeaderSelector]: Current leader 1 for partition [topic4,0] is not the preferred replica. Trigerring preferred replica leader election (kafka.controller.PreferredReplicaPartitionLeaderSelector)
[2016-11-17 16:56:22,805] WARN [Controller 0]: Partition [topic4,0] failed to complete preferred replica leader election. Leader is 1 (kafka.controller.KafkaController)
