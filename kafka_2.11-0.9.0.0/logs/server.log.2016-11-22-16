[2016-11-22 17:36:15,040] WARN [ReplicaFetcherThread-0-2], Error in fetch kafka.server.ReplicaFetcherThread$FetchRequest@3f5e177a. Possible cause: java.io.IOException: Connection to 2 was disconnected before the response was read (kafka.server.ReplicaFetcherThread)
[2016-11-22 17:36:15,047] INFO Partition [test1,0] on broker 0: Shrinking ISR for partition [test1,0] from 0,1,2 to 0 (kafka.cluster.Partition)
[2016-11-22 17:36:15,153] INFO [GroupCoordinator 0]: Preparing to restabilize group KafkaManagerOffsetCache with old generation 1 (kafka.coordinator.GroupCoordinator)
[2016-11-22 17:36:15,214] INFO [GroupCoordinator 0]: Group KafkaManagerOffsetCache generation 1 is dead and removed (kafka.coordinator.GroupCoordinator)
[2016-11-22 17:36:17,621] INFO Creating /controller (is it secure? false) (kafka.utils.ZKCheckedEphemeral)
[2016-11-22 17:36:17,700] INFO Partition [test1,1] on broker 0: Shrinking ISR for partition [test1,1] from 0,1,2 to 0,1 (kafka.cluster.Partition)
[2016-11-22 17:36:17,701] INFO Partition [test1,0] on broker 0: Expanding ISR for partition [test1,0] from 0 to 0,2 (kafka.cluster.Partition)
[2016-11-22 17:36:17,735] INFO Partition [test1,1] on broker 0: Expanding ISR for partition [test1,1] from 0,1 to 0,1,2 (kafka.cluster.Partition)
[2016-11-22 17:36:17,735] INFO Result of znode creation is: NODEEXISTS (kafka.utils.ZKCheckedEphemeral)
[2016-11-22 17:36:17,735] INFO Partition [test1,0] on broker 0: Expanding ISR for partition [test1,0] from 0,2 to 0,2,1 (kafka.cluster.Partition)
[2016-11-22 17:36:17,747] INFO re-registering broker info in ZK for broker 0 (kafka.server.KafkaHealthcheck)
[2016-11-22 17:36:17,757] INFO Creating /brokers/ids/0 (is it secure? false) (kafka.utils.ZKCheckedEphemeral)
[2016-11-22 17:36:17,771] INFO Result of znode creation is: OK (kafka.utils.ZKCheckedEphemeral)
[2016-11-22 17:36:17,771] INFO Registered broker 0 at path /brokers/ids/0 with addresses: PLAINTEXT -> EndPoint(172.16.26.72,9009,PLAINTEXT) (kafka.utils.ZkUtils)
[2016-11-22 17:36:18,186] INFO [GroupCoordinator 0]: Preparing to restabilize group KafkaManagerOffsetCache with old generation 0 (kafka.coordinator.GroupCoordinator)
[2016-11-22 17:36:18,340] INFO done re-registering broker (kafka.server.KafkaHealthcheck)
[2016-11-22 17:36:18,341] INFO Subscribing to /brokers/topics path to watch for new topics (kafka.server.KafkaHealthcheck)
[2016-11-22 17:36:18,345] INFO [GroupCoordinator 0]: Stabilized group KafkaManagerOffsetCache generation 1 (kafka.coordinator.GroupCoordinator)
[2016-11-22 17:36:18,353] INFO [GroupCoordinator 0]: Assignment received from leader for group KafkaManagerOffsetCache for generation 1 (kafka.coordinator.GroupCoordinator)
[2016-11-22 17:36:18,363] INFO New leader is 2 (kafka.server.ZookeeperLeaderElector$LeaderChangeListener)
[2016-11-22 17:36:18,410] INFO New leader is 2 (kafka.server.ZookeeperLeaderElector$LeaderChangeListener)
[2016-11-22 17:36:19,244] ERROR [KafkaApi-0] error when handling request Name:UpdateMetadataRequest;Version:1;Controller:1;ControllerEpoch:38;CorrelationId:2;ClientId:1;AliveBrokers:0 : (EndPoint(172.16.26.72,9009,PLAINTEXT)),2 : (EndPoint(172.16.26.72,9011,PLAINTEXT));PartitionState:[topic66,1] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:29,ControllerEpoch:38),ReplicationFactor:2),AllReplicas:1,2) (kafka.server.KafkaApis)
kafka.common.ControllerMovedException: Broker 0 received update metadata request with correlation id 2 from an old controller 1 with epoch 38. Latest known controller epoch is 39
	at kafka.server.ReplicaManager.maybeUpdateMetadataCache(ReplicaManager.scala:574)
	at kafka.server.KafkaApis.handleUpdateMetadataRequest(KafkaApis.scala:160)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:74)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
[2016-11-22 17:36:19,286] ERROR [KafkaApi-0] error when handling request Name:UpdateMetadataRequest;Version:1;Controller:1;ControllerEpoch:38;CorrelationId:3;ClientId:1;AliveBrokers:0 : (EndPoint(172.16.26.72,9009,PLAINTEXT)),2 : (EndPoint(172.16.26.72,9011,PLAINTEXT));PartitionState:[__consumer_offsets,32] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:37,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:1),[__consumer_offsets,16] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:0),[__consumer_offsets,49] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:0),[__consumer_offsets,44] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:37,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:1),[__consumer_offsets,28] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:0),[topic66,1] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:29,ControllerEpoch:38),ReplicationFactor:2),AllReplicas:1,2),[topic66,0] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,1,LeaderEpoch:21,ControllerEpoch:37),ReplicationFactor:2),AllReplicas:0,1),[__consumer_offsets,17] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:37,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:1),[__consumer_offsets,23] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:37,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:1),[__consumer_offsets,7] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:0),[__consumer_offsets,4] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:0),[topic44,1] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,1,2,LeaderEpoch:31,ControllerEpoch:37),ReplicationFactor:3),AllReplicas:0,2,1),[__consumer_offsets,29] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:37,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:1),[__consumer_offsets,35] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:37,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:1),[__consumer_offsets,3] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:39,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:2),[__consumer_offsets,24] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:39,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:2),[topic11,1] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:15,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:1),[topic44,2] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,1,LeaderEpoch:21,ControllerEpoch:37),ReplicationFactor:2),AllReplicas:1,0),[__consumer_offsets,41] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:37,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:1),[__consumer_offsets,0] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:39,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:2),[__consumer_offsets,38] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:37,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:1),[__consumer_offsets,13] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:0),[__consumer_offsets,8] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:37,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:1),[__consumer_offsets,5] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:37,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:1),[__consumer_offsets,39] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:39,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:2),[__consumer_offsets,36] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:39,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:2),[test1,1] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,1,2,LeaderEpoch:12,ControllerEpoch:37),ReplicationFactor:3),AllReplicas:1,2,0),[__consumer_offsets,40] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:0),[__consumer_offsets,45] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:39,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:2),[__consumer_offsets,15] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:39,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:2),[__consumer_offsets,33] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:39,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:2),[__consumer_offsets,37] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:0),[__consumer_offsets,21] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:39,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:2),[__consumer_offsets,6] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:39,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:2),[__consumer_offsets,11] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:37,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:1),[test1,2] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,0,1,LeaderEpoch:13,ControllerEpoch:37),ReplicationFactor:3),AllReplicas:2,0,1),[__consumer_offsets,20] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:37,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:1),[__consumer_offsets,47] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:37,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:1),[__consumer_offsets,2] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:37,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:1),[__consumer_offsets,27] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:39,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:2),[__consumer_offsets,34] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:0),[__consumer_offsets,9] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:39,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:2),[__consumer_offsets,22] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:0),[__consumer_offsets,42] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:39,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:2),[__consumer_offsets,14] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:37,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:1),[topic44,0] -> (LeaderAndIsrInfo:(Leader:2,ISR:0,1,2,LeaderEpoch:35,ControllerEpoch:37),ReplicationFactor:3),AllReplicas:2,1,0),[topic11,0] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:10,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:0),[__consumer_offsets,25] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:0),[__consumer_offsets,10] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:0),[__consumer_offsets,48] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:39,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:2),[__consumer_offsets,31] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:0),[__consumer_offsets,18] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:39,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:2),[__consumer_offsets,19] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:0),[__consumer_offsets,12] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:39,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:2),[test1,0] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,2,1,LeaderEpoch:13,ControllerEpoch:37),ReplicationFactor:3),AllReplicas:0,1,2),[__consumer_offsets,46] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:0),[__consumer_offsets,43] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:0),[__consumer_offsets,1] -> (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:0),[__consumer_offsets,26] -> (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:37,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:1),[__consumer_offsets,30] -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:39,ControllerEpoch:37),ReplicationFactor:1),AllReplicas:2) (kafka.server.KafkaApis)
kafka.common.ControllerMovedException: Broker 0 received update metadata request with correlation id 3 from an old controller 1 with epoch 38. Latest known controller epoch is 39
	at kafka.server.ReplicaManager.maybeUpdateMetadataCache(ReplicaManager.scala:574)
	at kafka.server.KafkaApis.handleUpdateMetadataRequest(KafkaApis.scala:160)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:74)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
[2016-11-22 17:36:19,474] INFO Creating /controller (is it secure? false) (kafka.utils.ZKCheckedEphemeral)
[2016-11-22 17:36:19,622] INFO Result of znode creation is: NODEEXISTS (kafka.utils.ZKCheckedEphemeral)
[2016-11-22 17:36:19,625] INFO New leader is 1 (kafka.server.ZookeeperLeaderElector$LeaderChangeListener)
[2016-11-22 17:36:25,069] INFO [ReplicaFetcherManager on broker 0] Removed fetcher for partitions [test1,1] (kafka.server.ReplicaFetcherManager)
[2016-11-22 17:36:25,070] INFO Truncating log test1-1 to offset 0. (kafka.log.Log)
[2016-11-22 17:36:25,083] INFO [ReplicaFetcherManager on broker 0] Added fetcher for partitions List([[test1,1], initOffset 0 to broker BrokerEndPoint(1,172.16.26.72,9010)] ) (kafka.server.ReplicaFetcherManager)
[2016-11-22 17:36:25,084] INFO [ReplicaFetcherThread-0-1], Starting  (kafka.server.ReplicaFetcherThread)
[2016-11-22 17:36:25,091] INFO [ReplicaFetcherManager on broker 0] Removed fetcher for partitions [topic44,2] (kafka.server.ReplicaFetcherManager)
[2016-11-22 17:36:25,092] INFO Truncating log topic44-2 to offset 2. (kafka.log.Log)
[2016-11-22 17:36:25,093] INFO [ReplicaFetcherManager on broker 0] Added fetcher for partitions List([[topic44,2], initOffset 2 to broker BrokerEndPoint(1,172.16.26.72,9010)] ) (kafka.server.ReplicaFetcherManager)
[2016-11-22 17:37:38,212] INFO [Group Metadata Manager on Broker 0]: Removed 0 expired offsets in 0 milliseconds. (kafka.coordinator.GroupMetadataManager)
[2016-11-22 17:47:38,184] INFO [Group Metadata Manager on Broker 0]: Removed 0 expired offsets in 0 milliseconds. (kafka.coordinator.GroupMetadataManager)
[2016-11-22 17:57:39,289] INFO [Group Metadata Manager on Broker 0]: Removed 0 expired offsets in 0 milliseconds. (kafka.coordinator.GroupMetadataManager)
