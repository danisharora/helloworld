[2016-11-17 10:03:50,045] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2016-11-17 10:03:51,113] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2016-11-17 10:03:51,113] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2016-11-17 10:03:51,114] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2016-11-17 10:03:51,115] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2016-11-17 10:03:51,120] INFO [Controller-0-to-broker-2-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2016-11-17 10:03:51,121] INFO [Controller-0-to-broker-2-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2016-11-17 10:03:51,121] INFO [Controller-0-to-broker-2-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2016-11-17 10:03:51,128] INFO [Controller-0-to-broker-1-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2016-11-17 10:03:51,128] INFO [Controller-0-to-broker-1-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2016-11-17 10:03:51,128] INFO [Controller-0-to-broker-1-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2016-11-17 10:03:51,129] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2016-11-17 10:03:51,129] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2016-11-17 10:03:51,129] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2016-11-17 10:03:51,129] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2016-11-17 10:03:54,247] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2016-11-17 10:03:58,170] DEBUG Sending MetadataRequest to Brokers:ArrayBuffer(0, 1, 2) for TopicAndPartitions:Set([__consumer_offsets,0], [othertopic,2], [__consumer_offsets,33], [__consumer_offsets,37], [othertopic,1], [__consumer_offsets,12], [othertopic,0]) (kafka.controller.IsrChangeNotificationListener)
[2016-11-17 10:03:58,195] ERROR Haven't been able to send metadata update requests, current state of the map is Map(2 -> Map(othertopic-1 -> (LeaderAndIsrInfo:(Leader:2,ISR:2,0,1,LeaderEpoch:50,ControllerEpoch:48),ReplicationFactor:3),AllReplicas:2,0,1), __consumer_offsets-37 -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:32,ControllerEpoch:48),ReplicationFactor:2),AllReplicas:2,1), othertopic-0 -> (LeaderAndIsrInfo:(Leader:1,ISR:1,0,2,LeaderEpoch:44,ControllerEpoch:50),ReplicationFactor:3),AllReplicas:1,2,0), __consumer_offsets-12 -> (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:29,ControllerEpoch:50),ReplicationFactor:2),AllReplicas:1,2), othertopic-2 -> (LeaderAndIsrInfo:(Leader:0,ISR:0,1,2,LeaderEpoch:48,ControllerEpoch:38),ReplicationFactor:3),AllReplicas:0,1,2), __consumer_offsets-33 -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:31,ControllerEpoch:48),ReplicationFactor:2),AllReplicas:2,1), __consumer_offsets-0 -> (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:29,ControllerEpoch:50),ReplicationFactor:2),AllReplicas:1,2)), 1 -> Map(othertopic-1 -> (LeaderAndIsrInfo:(Leader:2,ISR:2,0,1,LeaderEpoch:50,ControllerEpoch:48),ReplicationFactor:3),AllReplicas:2,0,1), __consumer_offsets-37 -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:32,ControllerEpoch:48),ReplicationFactor:2),AllReplicas:2,1), othertopic-0 -> (LeaderAndIsrInfo:(Leader:1,ISR:1,0,2,LeaderEpoch:44,ControllerEpoch:50),ReplicationFactor:3),AllReplicas:1,2,0), __consumer_offsets-12 -> (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:29,ControllerEpoch:50),ReplicationFactor:2),AllReplicas:1,2), othertopic-2 -> (LeaderAndIsrInfo:(Leader:0,ISR:0,1,2,LeaderEpoch:48,ControllerEpoch:38),ReplicationFactor:3),AllReplicas:0,1,2), __consumer_offsets-33 -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:31,ControllerEpoch:48),ReplicationFactor:2),AllReplicas:2,1), __consumer_offsets-0 -> (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:29,ControllerEpoch:50),ReplicationFactor:2),AllReplicas:1,2)), 0 -> Map(othertopic-1 -> (LeaderAndIsrInfo:(Leader:2,ISR:2,0,1,LeaderEpoch:50,ControllerEpoch:48),ReplicationFactor:3),AllReplicas:2,0,1), __consumer_offsets-37 -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:32,ControllerEpoch:48),ReplicationFactor:2),AllReplicas:2,1), othertopic-0 -> (LeaderAndIsrInfo:(Leader:1,ISR:1,0,2,LeaderEpoch:44,ControllerEpoch:50),ReplicationFactor:3),AllReplicas:1,2,0), __consumer_offsets-12 -> (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:29,ControllerEpoch:50),ReplicationFactor:2),AllReplicas:1,2), othertopic-2 -> (LeaderAndIsrInfo:(Leader:0,ISR:0,1,2,LeaderEpoch:48,ControllerEpoch:38),ReplicationFactor:3),AllReplicas:0,1,2), __consumer_offsets-33 -> (LeaderAndIsrInfo:(Leader:2,ISR:2,1,LeaderEpoch:31,ControllerEpoch:48),ReplicationFactor:2),AllReplicas:2,1), __consumer_offsets-0 -> (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:29,ControllerEpoch:50),ReplicationFactor:2),AllReplicas:1,2))) (kafka.controller.ControllerBrokerRequestBatch)
[2016-11-17 10:03:58,196] ERROR [Controller 0]: Forcing the controller to resign (kafka.controller.KafkaController)
[2016-11-17 10:03:58,236] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0,1 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2016-11-17 10:03:58,251] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"2":[0,1,2],"1":[2,0,1],"0":[1,2,0]}} for path /brokers/topics/othertopic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2016-11-17 10:03:58,257] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/mytopic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2016-11-17 10:03:58,264] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[2]}} for path /brokers/topics/topic1 (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2016-11-17 10:03:58,271] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"2":[2],"1":[1],"0":[0]}} for path /brokers/topics/topic3 (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2016-11-17 10:03:58,279] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"2":[0,2,1],"1":[2,1,0],"0":[1,0,2]}} for path /brokers/topics/topic2 (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2016-11-17 10:03:58,282] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"45":[2,1],"34":[1,2],"12":[1,2],"8":[1,2],"19":[2,1],"23":[2,1],"4":[1,2],"40":[1,2],"15":[2,1],"11":[2,1],"9":[2,1],"44":[1,2],"33":[2,1],"22":[1,2],"26":[1,2],"37":[2,1],"13":[2,1],"46":[1,2],"24":[1,2],"35":[2,1],"16":[1,2],"5":[2,1],"10":[1,2],"48":[1,2],"21":[2,1],"43":[2,1],"32":[1,2],"49":[2,1],"6":[1,2],"36":[1,2],"1":[2,1],"39":[2,1],"17":[2,1],"25":[2,1],"14":[1,2],"47":[2,1],"31":[2,1],"42":[1,2],"0":[1,2],"20":[1,2],"27":[2,1],"2":[1,2],"38":[1,2],"18":[1,2],"30":[1,2],"7":[2,1],"29":[2,1],"41":[2,1],"3":[2,1],"28":[1,2]}} for path /brokers/topics/__consumer_offsets (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2016-11-17 10:03:58,334] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0,1]}} for path /brokers/topics/topic4 (kafka.controller.PartitionStateMachine$AddPartitionsListener)
