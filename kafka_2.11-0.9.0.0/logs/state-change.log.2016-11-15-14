[2016-11-15 15:00:00,244] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:13,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,32] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,245] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,16] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,245] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,49] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,245] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,44] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,246] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,28] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,246] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,17] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,246] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,23] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,246] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,7] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,246] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,4] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,246] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,29] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,246] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,35] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,246] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,3] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,246] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,24] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,249] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,41] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,249] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,0] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,250] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,38] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,250] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,13] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,250] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,8] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,250] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,5] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,250] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,39] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,250] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,36] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,250] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:13,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,40] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,250] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,0,2,LeaderEpoch:32,ControllerEpoch:29),ReplicationFactor:3),AllReplicas:0,1,2) for partition [othertopic,2] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,251] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,45] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,251] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,15] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,251] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,33] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,251] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,37] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,251] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,21] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,251] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,0,2,LeaderEpoch:27,ControllerEpoch:29),ReplicationFactor:3),AllReplicas:2,0,1) for partition [othertopic,1] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,251] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,6] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,251] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,11] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,251] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,20] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,251] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,47] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,251] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,2] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,252] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,27] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,252] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,34] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,252] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,9] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,252] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,22] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,252] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,42] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,252] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,14] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,252] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,25] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,252] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,10] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,252] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,48] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,253] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,31] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,253] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,18] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,253] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,19] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,253] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,12] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,253] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:13,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,46] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,253] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,43] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,253] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,1] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,253] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,26] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,253] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,30] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:00,253] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:1,ISR:1,0,2,LeaderEpoch:25,ControllerEpoch:29),ReplicationFactor:3),AllReplicas:1,2,0) for partition [othertopic,0] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 5 (state.change.logger)
[2016-11-15 15:00:13,014] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 6 from controller 1 epoch 29 for partition [__consumer_offsets,40] (state.change.logger)
[2016-11-15 15:00:13,015] TRACE Broker 2 handling LeaderAndIsr request correlationId 6 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,40] (state.change.logger)
[2016-11-15 15:00:13,017] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 6 for partition [__consumer_offsets,40] (state.change.logger)
[2016-11-15 15:00:13,017] TRACE Broker 2 completed LeaderAndIsr request correlationId 6 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,40] (state.change.logger)
[2016-11-15 15:00:13,021] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,40] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 7 (state.change.logger)
[2016-11-15 15:00:13,045] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 8 from controller 1 epoch 29 for partition [__consumer_offsets,39] (state.change.logger)
[2016-11-15 15:00:13,045] TRACE Broker 2 handling LeaderAndIsr request correlationId 8 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,39] (state.change.logger)
[2016-11-15 15:00:13,046] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 8 for partition [__consumer_offsets,39] (state.change.logger)
[2016-11-15 15:00:13,046] TRACE Broker 2 completed LeaderAndIsr request correlationId 8 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,39] (state.change.logger)
[2016-11-15 15:00:13,052] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,39] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 9 (state.change.logger)
[2016-11-15 15:00:13,059] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 10 from controller 1 epoch 29 for partition [__consumer_offsets,32] (state.change.logger)
[2016-11-15 15:00:13,059] TRACE Broker 2 handling LeaderAndIsr request correlationId 10 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,32] (state.change.logger)
[2016-11-15 15:00:13,059] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 10 for partition [__consumer_offsets,32] (state.change.logger)
[2016-11-15 15:00:13,059] TRACE Broker 2 completed LeaderAndIsr request correlationId 10 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,32] (state.change.logger)
[2016-11-15 15:00:13,063] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,32] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 11 (state.change.logger)
[2016-11-15 15:00:13,087] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,2,LeaderEpoch:33,ControllerEpoch:29),ReplicationFactor:3),AllReplicas:0,1,2) correlation id 12 from controller 1 epoch 29 for partition [othertopic,2] (state.change.logger)
[2016-11-15 15:00:13,087] TRACE Broker 2 handling LeaderAndIsr request correlationId 12 from controller 1 epoch 29 starting the become-follower transition for partition [othertopic,2] (state.change.logger)
[2016-11-15 15:00:13,088] TRACE Broker 2 stopped fetchers as part of become-follower request from controller 1 epoch 29 with correlation id 12 for partition [othertopic,2] (state.change.logger)
[2016-11-15 15:00:13,091] TRACE Broker 2 truncated logs and checkpointed recovery boundaries for partition [othertopic,2] as part of become-follower request with correlation id 12 from controller 1 epoch 29 (state.change.logger)
[2016-11-15 15:00:13,092] TRACE Broker 2 skipped the adding-fetcher step of the become-follower state change with correlation id 12 from controller 1 epoch 29 for partition [othertopic,2] since it is shutting down (state.change.logger)
[2016-11-15 15:00:13,092] TRACE Broker 2 completed LeaderAndIsr request correlationId 12 from controller 1 epoch 29 for the become-follower transition for partition [othertopic,2] (state.change.logger)
[2016-11-15 15:00:13,110] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,2,LeaderEpoch:33,ControllerEpoch:29),ReplicationFactor:3),AllReplicas:0,1,2) for partition [othertopic,2] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 13 (state.change.logger)
[2016-11-15 15:00:13,121] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 14 from controller 1 epoch 29 for partition [__consumer_offsets,13] (state.change.logger)
[2016-11-15 15:00:13,121] TRACE Broker 2 handling LeaderAndIsr request correlationId 14 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,13] (state.change.logger)
[2016-11-15 15:00:13,122] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 14 for partition [__consumer_offsets,13] (state.change.logger)
[2016-11-15 15:00:13,122] TRACE Broker 2 completed LeaderAndIsr request correlationId 14 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,13] (state.change.logger)
[2016-11-15 15:00:13,124] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,13] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 15 (state.change.logger)
[2016-11-15 15:00:13,132] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 16 from controller 1 epoch 29 for partition [__consumer_offsets,21] (state.change.logger)
[2016-11-15 15:00:13,133] TRACE Broker 2 handling LeaderAndIsr request correlationId 16 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,21] (state.change.logger)
[2016-11-15 15:00:13,133] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 16 for partition [__consumer_offsets,21] (state.change.logger)
[2016-11-15 15:00:13,133] TRACE Broker 2 completed LeaderAndIsr request correlationId 16 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,21] (state.change.logger)
[2016-11-15 15:00:13,136] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,21] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 17 (state.change.logger)
[2016-11-15 15:00:13,144] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 18 from controller 1 epoch 29 for partition [__consumer_offsets,12] (state.change.logger)
[2016-11-15 15:00:13,144] TRACE Broker 2 handling LeaderAndIsr request correlationId 18 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,12] (state.change.logger)
[2016-11-15 15:00:13,145] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 18 for partition [__consumer_offsets,12] (state.change.logger)
[2016-11-15 15:00:13,145] TRACE Broker 2 completed LeaderAndIsr request correlationId 18 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,12] (state.change.logger)
[2016-11-15 15:00:13,147] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,12] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 19 (state.change.logger)
[2016-11-15 15:00:13,158] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 20 from controller 1 epoch 29 for partition [__consumer_offsets,7] (state.change.logger)
[2016-11-15 15:00:13,159] TRACE Broker 2 handling LeaderAndIsr request correlationId 20 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,7] (state.change.logger)
[2016-11-15 15:00:13,159] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 20 for partition [__consumer_offsets,7] (state.change.logger)
[2016-11-15 15:00:13,159] TRACE Broker 2 completed LeaderAndIsr request correlationId 20 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,7] (state.change.logger)
[2016-11-15 15:00:13,161] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,7] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 21 (state.change.logger)
[2016-11-15 15:00:13,177] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 22 from controller 1 epoch 29 for partition [__consumer_offsets,18] (state.change.logger)
[2016-11-15 15:00:13,178] TRACE Broker 2 handling LeaderAndIsr request correlationId 22 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,18] (state.change.logger)
[2016-11-15 15:00:13,178] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 22 for partition [__consumer_offsets,18] (state.change.logger)
[2016-11-15 15:00:13,178] TRACE Broker 2 completed LeaderAndIsr request correlationId 22 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,18] (state.change.logger)
[2016-11-15 15:00:13,180] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,18] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 23 (state.change.logger)
[2016-11-15 15:00:13,193] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 24 from controller 1 epoch 29 for partition [__consumer_offsets,24] (state.change.logger)
[2016-11-15 15:00:13,193] TRACE Broker 2 handling LeaderAndIsr request correlationId 24 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,24] (state.change.logger)
[2016-11-15 15:00:13,194] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 24 for partition [__consumer_offsets,24] (state.change.logger)
[2016-11-15 15:00:13,194] TRACE Broker 2 completed LeaderAndIsr request correlationId 24 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,24] (state.change.logger)
[2016-11-15 15:00:13,199] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,24] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 25 (state.change.logger)
[2016-11-15 15:00:13,212] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 26 from controller 1 epoch 29 for partition [__consumer_offsets,26] (state.change.logger)
[2016-11-15 15:00:13,212] TRACE Broker 2 handling LeaderAndIsr request correlationId 26 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,26] (state.change.logger)
[2016-11-15 15:00:13,213] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 26 for partition [__consumer_offsets,26] (state.change.logger)
[2016-11-15 15:00:13,213] TRACE Broker 2 completed LeaderAndIsr request correlationId 26 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,26] (state.change.logger)
[2016-11-15 15:00:13,218] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,26] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 27 (state.change.logger)
[2016-11-15 15:00:13,240] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 28 from controller 1 epoch 29 for partition [__consumer_offsets,19] (state.change.logger)
[2016-11-15 15:00:13,240] TRACE Broker 2 handling LeaderAndIsr request correlationId 28 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,19] (state.change.logger)
[2016-11-15 15:00:13,240] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 28 for partition [__consumer_offsets,19] (state.change.logger)
[2016-11-15 15:00:13,240] TRACE Broker 2 completed LeaderAndIsr request correlationId 28 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,19] (state.change.logger)
[2016-11-15 15:00:13,242] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,19] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 29 (state.change.logger)
[2016-11-15 15:00:13,257] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 30 from controller 1 epoch 29 for partition [__consumer_offsets,22] (state.change.logger)
[2016-11-15 15:00:13,257] TRACE Broker 2 handling LeaderAndIsr request correlationId 30 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,22] (state.change.logger)
[2016-11-15 15:00:13,257] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 30 for partition [__consumer_offsets,22] (state.change.logger)
[2016-11-15 15:00:13,257] TRACE Broker 2 completed LeaderAndIsr request correlationId 30 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,22] (state.change.logger)
[2016-11-15 15:00:13,259] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,22] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 31 (state.change.logger)
[2016-11-15 15:00:13,269] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 32 from controller 1 epoch 29 for partition [__consumer_offsets,36] (state.change.logger)
[2016-11-15 15:00:13,269] TRACE Broker 2 handling LeaderAndIsr request correlationId 32 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,36] (state.change.logger)
[2016-11-15 15:00:13,269] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 32 for partition [__consumer_offsets,36] (state.change.logger)
[2016-11-15 15:00:13,269] TRACE Broker 2 completed LeaderAndIsr request correlationId 32 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,36] (state.change.logger)
[2016-11-15 15:00:13,271] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,36] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 33 (state.change.logger)
[2016-11-15 15:00:13,283] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 34 from controller 1 epoch 29 for partition [__consumer_offsets,49] (state.change.logger)
[2016-11-15 15:00:13,283] TRACE Broker 2 handling LeaderAndIsr request correlationId 34 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,49] (state.change.logger)
[2016-11-15 15:00:13,284] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 34 for partition [__consumer_offsets,49] (state.change.logger)
[2016-11-15 15:00:13,284] TRACE Broker 2 completed LeaderAndIsr request correlationId 34 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,49] (state.change.logger)
[2016-11-15 15:00:13,287] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,49] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 35 (state.change.logger)
[2016-11-15 15:00:13,297] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 36 from controller 1 epoch 29 for partition [__consumer_offsets,27] (state.change.logger)
[2016-11-15 15:00:13,297] TRACE Broker 2 handling LeaderAndIsr request correlationId 36 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,27] (state.change.logger)
[2016-11-15 15:00:13,298] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 36 for partition [__consumer_offsets,27] (state.change.logger)
[2016-11-15 15:00:13,298] TRACE Broker 2 completed LeaderAndIsr request correlationId 36 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,27] (state.change.logger)
[2016-11-15 15:00:13,300] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,27] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 37 (state.change.logger)
[2016-11-15 15:00:13,307] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 38 from controller 1 epoch 29 for partition [__consumer_offsets,11] (state.change.logger)
[2016-11-15 15:00:13,307] TRACE Broker 2 handling LeaderAndIsr request correlationId 38 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,11] (state.change.logger)
[2016-11-15 15:00:13,308] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 38 for partition [__consumer_offsets,11] (state.change.logger)
[2016-11-15 15:00:13,308] TRACE Broker 2 completed LeaderAndIsr request correlationId 38 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,11] (state.change.logger)
[2016-11-15 15:00:13,310] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,11] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 39 (state.change.logger)
[2016-11-15 15:00:13,319] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 40 from controller 1 epoch 29 for partition [__consumer_offsets,46] (state.change.logger)
[2016-11-15 15:00:13,319] TRACE Broker 2 handling LeaderAndIsr request correlationId 40 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,46] (state.change.logger)
[2016-11-15 15:00:13,320] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 40 for partition [__consumer_offsets,46] (state.change.logger)
[2016-11-15 15:00:13,320] TRACE Broker 2 completed LeaderAndIsr request correlationId 40 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,46] (state.change.logger)
[2016-11-15 15:00:13,322] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,46] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 41 (state.change.logger)
[2016-11-15 15:00:13,354] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 42 from controller 1 epoch 29 for partition [__consumer_offsets,31] (state.change.logger)
[2016-11-15 15:00:13,354] TRACE Broker 2 handling LeaderAndIsr request correlationId 42 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,31] (state.change.logger)
[2016-11-15 15:00:13,355] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 42 for partition [__consumer_offsets,31] (state.change.logger)
[2016-11-15 15:00:13,355] TRACE Broker 2 completed LeaderAndIsr request correlationId 42 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,31] (state.change.logger)
[2016-11-15 15:00:13,357] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,31] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 43 (state.change.logger)
[2016-11-15 15:00:13,370] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 44 from controller 1 epoch 29 for partition [__consumer_offsets,2] (state.change.logger)
[2016-11-15 15:00:13,370] TRACE Broker 2 handling LeaderAndIsr request correlationId 44 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,2] (state.change.logger)
[2016-11-15 15:00:13,371] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 44 for partition [__consumer_offsets,2] (state.change.logger)
[2016-11-15 15:00:13,371] TRACE Broker 2 completed LeaderAndIsr request correlationId 44 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,2] (state.change.logger)
[2016-11-15 15:00:13,373] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,2] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 45 (state.change.logger)
[2016-11-15 15:00:13,383] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,2,LeaderEpoch:28,ControllerEpoch:29),ReplicationFactor:3),AllReplicas:2,0,1) correlation id 46 from controller 1 epoch 29 for partition [othertopic,1] (state.change.logger)
[2016-11-15 15:00:13,383] TRACE Broker 2 handling LeaderAndIsr request correlationId 46 from controller 1 epoch 29 starting the become-follower transition for partition [othertopic,1] (state.change.logger)
[2016-11-15 15:00:13,383] TRACE Broker 2 stopped fetchers as part of become-follower request from controller 1 epoch 29 with correlation id 46 for partition [othertopic,1] (state.change.logger)
[2016-11-15 15:00:13,386] TRACE Broker 2 truncated logs and checkpointed recovery boundaries for partition [othertopic,1] as part of become-follower request with correlation id 46 from controller 1 epoch 29 (state.change.logger)
[2016-11-15 15:00:13,386] TRACE Broker 2 skipped the adding-fetcher step of the become-follower state change with correlation id 46 from controller 1 epoch 29 for partition [othertopic,1] since it is shutting down (state.change.logger)
[2016-11-15 15:00:13,387] TRACE Broker 2 completed LeaderAndIsr request correlationId 46 from controller 1 epoch 29 for the become-follower transition for partition [othertopic,1] (state.change.logger)
[2016-11-15 15:00:13,400] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,2,LeaderEpoch:28,ControllerEpoch:29),ReplicationFactor:3),AllReplicas:2,0,1) for partition [othertopic,1] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 47 (state.change.logger)
[2016-11-15 15:00:13,401] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 48 from controller 1 epoch 29 for partition [__consumer_offsets,45] (state.change.logger)
[2016-11-15 15:00:13,401] TRACE Broker 2 handling LeaderAndIsr request correlationId 48 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,45] (state.change.logger)
[2016-11-15 15:00:13,402] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 48 for partition [__consumer_offsets,45] (state.change.logger)
[2016-11-15 15:00:13,402] TRACE Broker 2 completed LeaderAndIsr request correlationId 48 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,45] (state.change.logger)
[2016-11-15 15:00:13,404] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,45] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 49 (state.change.logger)
[2016-11-15 15:00:13,409] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,2,LeaderEpoch:26,ControllerEpoch:29),ReplicationFactor:3),AllReplicas:1,2,0) correlation id 50 from controller 1 epoch 29 for partition [othertopic,0] (state.change.logger)
[2016-11-15 15:00:13,409] TRACE Broker 2 handling LeaderAndIsr request correlationId 50 from controller 1 epoch 29 starting the become-follower transition for partition [othertopic,0] (state.change.logger)
[2016-11-15 15:00:13,409] TRACE Broker 2 stopped fetchers as part of become-follower request from controller 1 epoch 29 with correlation id 50 for partition [othertopic,0] (state.change.logger)
[2016-11-15 15:00:13,412] TRACE Broker 2 truncated logs and checkpointed recovery boundaries for partition [othertopic,0] as part of become-follower request with correlation id 50 from controller 1 epoch 29 (state.change.logger)
[2016-11-15 15:00:13,412] TRACE Broker 2 skipped the adding-fetcher step of the become-follower state change with correlation id 50 from controller 1 epoch 29 for partition [othertopic,0] since it is shutting down (state.change.logger)
[2016-11-15 15:00:13,412] TRACE Broker 2 completed LeaderAndIsr request correlationId 50 from controller 1 epoch 29 for the become-follower transition for partition [othertopic,0] (state.change.logger)
[2016-11-15 15:00:13,427] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,2,LeaderEpoch:26,ControllerEpoch:29),ReplicationFactor:3),AllReplicas:1,2,0) for partition [othertopic,0] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 51 (state.change.logger)
[2016-11-15 15:00:13,442] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 52 from controller 1 epoch 29 for partition [__consumer_offsets,42] (state.change.logger)
[2016-11-15 15:00:13,442] TRACE Broker 2 handling LeaderAndIsr request correlationId 52 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,42] (state.change.logger)
[2016-11-15 15:00:13,443] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 52 for partition [__consumer_offsets,42] (state.change.logger)
[2016-11-15 15:00:13,443] TRACE Broker 2 completed LeaderAndIsr request correlationId 52 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,42] (state.change.logger)
[2016-11-15 15:00:13,451] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,42] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 53 (state.change.logger)
[2016-11-15 15:00:13,473] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 54 from controller 1 epoch 29 for partition [__consumer_offsets,4] (state.change.logger)
[2016-11-15 15:00:13,473] TRACE Broker 2 handling LeaderAndIsr request correlationId 54 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,4] (state.change.logger)
[2016-11-15 15:00:13,474] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 54 for partition [__consumer_offsets,4] (state.change.logger)
[2016-11-15 15:00:13,474] TRACE Broker 2 completed LeaderAndIsr request correlationId 54 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,4] (state.change.logger)
[2016-11-15 15:00:13,476] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,4] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 55 (state.change.logger)
[2016-11-15 15:00:13,494] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 56 from controller 1 epoch 29 for partition [__consumer_offsets,41] (state.change.logger)
[2016-11-15 15:00:13,495] TRACE Broker 2 handling LeaderAndIsr request correlationId 56 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,41] (state.change.logger)
[2016-11-15 15:00:13,495] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 56 for partition [__consumer_offsets,41] (state.change.logger)
[2016-11-15 15:00:13,495] TRACE Broker 2 completed LeaderAndIsr request correlationId 56 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,41] (state.change.logger)
[2016-11-15 15:00:13,498] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,41] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 57 (state.change.logger)
[2016-11-15 15:00:13,514] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 58 from controller 1 epoch 29 for partition [__consumer_offsets,6] (state.change.logger)
[2016-11-15 15:00:13,515] TRACE Broker 2 handling LeaderAndIsr request correlationId 58 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,6] (state.change.logger)
[2016-11-15 15:00:13,515] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 58 for partition [__consumer_offsets,6] (state.change.logger)
[2016-11-15 15:00:13,515] TRACE Broker 2 completed LeaderAndIsr request correlationId 58 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,6] (state.change.logger)
[2016-11-15 15:00:13,517] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,6] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 59 (state.change.logger)
[2016-11-15 15:00:13,529] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 60 from controller 1 epoch 29 for partition [__consumer_offsets,44] (state.change.logger)
[2016-11-15 15:00:13,529] TRACE Broker 2 handling LeaderAndIsr request correlationId 60 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,44] (state.change.logger)
[2016-11-15 15:00:13,530] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 60 for partition [__consumer_offsets,44] (state.change.logger)
[2016-11-15 15:00:13,530] TRACE Broker 2 completed LeaderAndIsr request correlationId 60 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,44] (state.change.logger)
[2016-11-15 15:00:13,532] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,44] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 61 (state.change.logger)
[2016-11-15 15:00:13,540] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 62 from controller 1 epoch 29 for partition [__consumer_offsets,37] (state.change.logger)
[2016-11-15 15:00:13,540] TRACE Broker 2 handling LeaderAndIsr request correlationId 62 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,37] (state.change.logger)
[2016-11-15 15:00:13,540] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 62 for partition [__consumer_offsets,37] (state.change.logger)
[2016-11-15 15:00:13,540] TRACE Broker 2 completed LeaderAndIsr request correlationId 62 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,37] (state.change.logger)
[2016-11-15 15:00:13,543] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,37] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 63 (state.change.logger)
[2016-11-15 15:00:13,549] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 64 from controller 1 epoch 29 for partition [__consumer_offsets,1] (state.change.logger)
[2016-11-15 15:00:13,549] TRACE Broker 2 handling LeaderAndIsr request correlationId 64 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,1] (state.change.logger)
[2016-11-15 15:00:13,550] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 64 for partition [__consumer_offsets,1] (state.change.logger)
[2016-11-15 15:00:13,550] TRACE Broker 2 completed LeaderAndIsr request correlationId 64 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,1] (state.change.logger)
[2016-11-15 15:00:13,556] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,1] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 65 (state.change.logger)
[2016-11-15 15:00:13,563] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 66 from controller 1 epoch 29 for partition [__consumer_offsets,47] (state.change.logger)
[2016-11-15 15:00:13,564] TRACE Broker 2 handling LeaderAndIsr request correlationId 66 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,47] (state.change.logger)
[2016-11-15 15:00:13,564] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 66 for partition [__consumer_offsets,47] (state.change.logger)
[2016-11-15 15:00:13,564] TRACE Broker 2 completed LeaderAndIsr request correlationId 66 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,47] (state.change.logger)
[2016-11-15 15:00:13,566] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,47] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 67 (state.change.logger)
[2016-11-15 15:00:13,586] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 68 from controller 1 epoch 29 for partition [__consumer_offsets,17] (state.change.logger)
[2016-11-15 15:00:13,586] TRACE Broker 2 handling LeaderAndIsr request correlationId 68 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,17] (state.change.logger)
[2016-11-15 15:00:13,587] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 68 for partition [__consumer_offsets,17] (state.change.logger)
[2016-11-15 15:00:13,587] TRACE Broker 2 completed LeaderAndIsr request correlationId 68 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,17] (state.change.logger)
[2016-11-15 15:00:13,589] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,17] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 69 (state.change.logger)
[2016-11-15 15:00:13,602] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 70 from controller 1 epoch 29 for partition [__consumer_offsets,14] (state.change.logger)
[2016-11-15 15:00:13,603] TRACE Broker 2 handling LeaderAndIsr request correlationId 70 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,14] (state.change.logger)
[2016-11-15 15:00:13,603] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 70 for partition [__consumer_offsets,14] (state.change.logger)
[2016-11-15 15:00:13,603] TRACE Broker 2 completed LeaderAndIsr request correlationId 70 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,14] (state.change.logger)
[2016-11-15 15:00:13,606] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,14] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 71 (state.change.logger)
[2016-11-15 15:00:13,614] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 72 from controller 1 epoch 29 for partition [__consumer_offsets,5] (state.change.logger)
[2016-11-15 15:00:13,614] TRACE Broker 2 handling LeaderAndIsr request correlationId 72 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,5] (state.change.logger)
[2016-11-15 15:00:13,615] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 72 for partition [__consumer_offsets,5] (state.change.logger)
[2016-11-15 15:00:13,615] TRACE Broker 2 completed LeaderAndIsr request correlationId 72 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,5] (state.change.logger)
[2016-11-15 15:00:13,617] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,5] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 73 (state.change.logger)
[2016-11-15 15:00:13,632] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 74 from controller 1 epoch 29 for partition [__consumer_offsets,29] (state.change.logger)
[2016-11-15 15:00:13,632] TRACE Broker 2 handling LeaderAndIsr request correlationId 74 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,29] (state.change.logger)
[2016-11-15 15:00:13,632] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 74 for partition [__consumer_offsets,29] (state.change.logger)
[2016-11-15 15:00:13,632] TRACE Broker 2 completed LeaderAndIsr request correlationId 74 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,29] (state.change.logger)
[2016-11-15 15:00:13,634] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,29] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 75 (state.change.logger)
[2016-11-15 15:00:13,637] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 76 from controller 1 epoch 29 for partition [__consumer_offsets,9] (state.change.logger)
[2016-11-15 15:00:13,637] TRACE Broker 2 handling LeaderAndIsr request correlationId 76 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,9] (state.change.logger)
[2016-11-15 15:00:13,638] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 76 for partition [__consumer_offsets,9] (state.change.logger)
[2016-11-15 15:00:13,638] TRACE Broker 2 completed LeaderAndIsr request correlationId 76 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,9] (state.change.logger)
[2016-11-15 15:00:13,640] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,9] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 77 (state.change.logger)
[2016-11-15 15:00:13,645] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 78 from controller 1 epoch 29 for partition [__consumer_offsets,48] (state.change.logger)
[2016-11-15 15:00:13,645] TRACE Broker 2 handling LeaderAndIsr request correlationId 78 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,48] (state.change.logger)
[2016-11-15 15:00:13,646] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 78 for partition [__consumer_offsets,48] (state.change.logger)
[2016-11-15 15:00:13,646] TRACE Broker 2 completed LeaderAndIsr request correlationId 78 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,48] (state.change.logger)
[2016-11-15 15:00:13,648] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,48] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 79 (state.change.logger)
[2016-11-15 15:00:13,656] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 80 from controller 1 epoch 29 for partition [__consumer_offsets,23] (state.change.logger)
[2016-11-15 15:00:13,656] TRACE Broker 2 handling LeaderAndIsr request correlationId 80 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,23] (state.change.logger)
[2016-11-15 15:00:13,656] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 80 for partition [__consumer_offsets,23] (state.change.logger)
[2016-11-15 15:00:13,657] TRACE Broker 2 completed LeaderAndIsr request correlationId 80 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,23] (state.change.logger)
[2016-11-15 15:00:13,659] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,23] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 81 (state.change.logger)
[2016-11-15 15:00:13,664] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 82 from controller 1 epoch 29 for partition [__consumer_offsets,20] (state.change.logger)
[2016-11-15 15:00:13,664] TRACE Broker 2 handling LeaderAndIsr request correlationId 82 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,20] (state.change.logger)
[2016-11-15 15:00:13,665] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 82 for partition [__consumer_offsets,20] (state.change.logger)
[2016-11-15 15:00:13,665] TRACE Broker 2 completed LeaderAndIsr request correlationId 82 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,20] (state.change.logger)
[2016-11-15 15:00:13,668] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,20] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 83 (state.change.logger)
[2016-11-15 15:00:13,673] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 84 from controller 1 epoch 29 for partition [__consumer_offsets,25] (state.change.logger)
[2016-11-15 15:00:13,674] TRACE Broker 2 handling LeaderAndIsr request correlationId 84 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,25] (state.change.logger)
[2016-11-15 15:00:13,674] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 84 for partition [__consumer_offsets,25] (state.change.logger)
[2016-11-15 15:00:13,674] TRACE Broker 2 completed LeaderAndIsr request correlationId 84 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,25] (state.change.logger)
[2016-11-15 15:00:13,676] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,25] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 85 (state.change.logger)
[2016-11-15 15:00:13,683] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 86 from controller 1 epoch 29 for partition [__consumer_offsets,16] (state.change.logger)
[2016-11-15 15:00:13,683] TRACE Broker 2 handling LeaderAndIsr request correlationId 86 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,16] (state.change.logger)
[2016-11-15 15:00:13,684] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 86 for partition [__consumer_offsets,16] (state.change.logger)
[2016-11-15 15:00:13,684] TRACE Broker 2 completed LeaderAndIsr request correlationId 86 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,16] (state.change.logger)
[2016-11-15 15:00:13,687] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,16] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 87 (state.change.logger)
[2016-11-15 15:00:13,690] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 88 from controller 1 epoch 29 for partition [__consumer_offsets,35] (state.change.logger)
[2016-11-15 15:00:13,691] TRACE Broker 2 handling LeaderAndIsr request correlationId 88 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,35] (state.change.logger)
[2016-11-15 15:00:13,691] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 88 for partition [__consumer_offsets,35] (state.change.logger)
[2016-11-15 15:00:13,691] TRACE Broker 2 completed LeaderAndIsr request correlationId 88 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,35] (state.change.logger)
[2016-11-15 15:00:13,693] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,35] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 89 (state.change.logger)
[2016-11-15 15:00:13,698] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 90 from controller 1 epoch 29 for partition [__consumer_offsets,34] (state.change.logger)
[2016-11-15 15:00:13,698] TRACE Broker 2 handling LeaderAndIsr request correlationId 90 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,34] (state.change.logger)
[2016-11-15 15:00:13,699] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 90 for partition [__consumer_offsets,34] (state.change.logger)
[2016-11-15 15:00:13,699] TRACE Broker 2 completed LeaderAndIsr request correlationId 90 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,34] (state.change.logger)
[2016-11-15 15:00:13,701] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,34] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 91 (state.change.logger)
[2016-11-15 15:00:13,774] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 92 from controller 1 epoch 29 for partition [__consumer_offsets,15] (state.change.logger)
[2016-11-15 15:00:13,774] TRACE Broker 2 handling LeaderAndIsr request correlationId 92 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,15] (state.change.logger)
[2016-11-15 15:00:13,775] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 92 for partition [__consumer_offsets,15] (state.change.logger)
[2016-11-15 15:00:13,775] TRACE Broker 2 completed LeaderAndIsr request correlationId 92 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,15] (state.change.logger)
[2016-11-15 15:00:13,777] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,15] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 93 (state.change.logger)
[2016-11-15 15:00:13,784] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 94 from controller 1 epoch 29 for partition [__consumer_offsets,10] (state.change.logger)
[2016-11-15 15:00:13,785] TRACE Broker 2 handling LeaderAndIsr request correlationId 94 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,10] (state.change.logger)
[2016-11-15 15:00:13,785] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 94 for partition [__consumer_offsets,10] (state.change.logger)
[2016-11-15 15:00:13,785] TRACE Broker 2 completed LeaderAndIsr request correlationId 94 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,10] (state.change.logger)
[2016-11-15 15:00:13,787] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,10] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 95 (state.change.logger)
[2016-11-15 15:00:13,796] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 96 from controller 1 epoch 29 for partition [__consumer_offsets,3] (state.change.logger)
[2016-11-15 15:00:13,796] TRACE Broker 2 handling LeaderAndIsr request correlationId 96 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,3] (state.change.logger)
[2016-11-15 15:00:13,797] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 96 for partition [__consumer_offsets,3] (state.change.logger)
[2016-11-15 15:00:13,797] TRACE Broker 2 completed LeaderAndIsr request correlationId 96 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,3] (state.change.logger)
[2016-11-15 15:00:13,799] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,3] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 97 (state.change.logger)
[2016-11-15 15:00:13,806] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 98 from controller 1 epoch 29 for partition [__consumer_offsets,28] (state.change.logger)
[2016-11-15 15:00:13,806] TRACE Broker 2 handling LeaderAndIsr request correlationId 98 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,28] (state.change.logger)
[2016-11-15 15:00:13,807] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 98 for partition [__consumer_offsets,28] (state.change.logger)
[2016-11-15 15:00:13,807] TRACE Broker 2 completed LeaderAndIsr request correlationId 98 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,28] (state.change.logger)
[2016-11-15 15:00:13,809] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,28] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 99 (state.change.logger)
[2016-11-15 15:00:13,816] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 100 from controller 1 epoch 29 for partition [__consumer_offsets,30] (state.change.logger)
[2016-11-15 15:00:13,816] TRACE Broker 2 handling LeaderAndIsr request correlationId 100 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,30] (state.change.logger)
[2016-11-15 15:00:13,816] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 100 for partition [__consumer_offsets,30] (state.change.logger)
[2016-11-15 15:00:13,816] TRACE Broker 2 completed LeaderAndIsr request correlationId 100 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,30] (state.change.logger)
[2016-11-15 15:00:13,819] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,30] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 101 (state.change.logger)
[2016-11-15 15:00:13,842] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 102 from controller 1 epoch 29 for partition [__consumer_offsets,43] (state.change.logger)
[2016-11-15 15:00:13,843] TRACE Broker 2 handling LeaderAndIsr request correlationId 102 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,43] (state.change.logger)
[2016-11-15 15:00:13,843] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 102 for partition [__consumer_offsets,43] (state.change.logger)
[2016-11-15 15:00:13,843] TRACE Broker 2 completed LeaderAndIsr request correlationId 102 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,43] (state.change.logger)
[2016-11-15 15:00:13,845] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,43] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 103 (state.change.logger)
[2016-11-15 15:00:13,855] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 104 from controller 1 epoch 29 for partition [__consumer_offsets,0] (state.change.logger)
[2016-11-15 15:00:13,855] TRACE Broker 2 handling LeaderAndIsr request correlationId 104 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,0] (state.change.logger)
[2016-11-15 15:00:13,855] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 104 for partition [__consumer_offsets,0] (state.change.logger)
[2016-11-15 15:00:13,856] TRACE Broker 2 completed LeaderAndIsr request correlationId 104 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,0] (state.change.logger)
[2016-11-15 15:00:13,857] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,0] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 105 (state.change.logger)
[2016-11-15 15:00:13,870] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 106 from controller 1 epoch 29 for partition [__consumer_offsets,38] (state.change.logger)
[2016-11-15 15:00:13,870] TRACE Broker 2 handling LeaderAndIsr request correlationId 106 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,38] (state.change.logger)
[2016-11-15 15:00:13,870] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 106 for partition [__consumer_offsets,38] (state.change.logger)
[2016-11-15 15:00:13,870] TRACE Broker 2 completed LeaderAndIsr request correlationId 106 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,38] (state.change.logger)
[2016-11-15 15:00:13,872] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,38] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 107 (state.change.logger)
[2016-11-15 15:00:13,882] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 108 from controller 1 epoch 29 for partition [__consumer_offsets,33] (state.change.logger)
[2016-11-15 15:00:13,882] TRACE Broker 2 handling LeaderAndIsr request correlationId 108 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,33] (state.change.logger)
[2016-11-15 15:00:13,883] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 108 for partition [__consumer_offsets,33] (state.change.logger)
[2016-11-15 15:00:13,883] TRACE Broker 2 completed LeaderAndIsr request correlationId 108 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,33] (state.change.logger)
[2016-11-15 15:00:13,884] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,33] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 109 (state.change.logger)
[2016-11-15 15:00:13,892] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 110 from controller 1 epoch 29 for partition [__consumer_offsets,8] (state.change.logger)
[2016-11-15 15:00:13,892] TRACE Broker 2 handling LeaderAndIsr request correlationId 110 from controller 1 epoch 29 starting the become-leader transition for partition [__consumer_offsets,8] (state.change.logger)
[2016-11-15 15:00:13,892] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 110 for partition [__consumer_offsets,8] (state.change.logger)
[2016-11-15 15:00:13,892] TRACE Broker 2 completed LeaderAndIsr request correlationId 110 from controller 1 epoch 29 for the become-leader transition for partition [__consumer_offsets,8] (state.change.logger)
[2016-11-15 15:00:13,970] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,8] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 111 (state.change.logger)
[2016-11-15 15:00:13,998] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:27,ControllerEpoch:29),ReplicationFactor:3),AllReplicas:1,2,0) correlation id 112 from controller 1 epoch 29 for partition [othertopic,0] (state.change.logger)
[2016-11-15 15:00:13,999] TRACE Broker 2 handling LeaderAndIsr request correlationId 112 from controller 1 epoch 29 starting the become-leader transition for partition [othertopic,0] (state.change.logger)
[2016-11-15 15:00:13,999] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 112 for partition [othertopic,0] (state.change.logger)
[2016-11-15 15:00:13,999] TRACE Broker 2 completed LeaderAndIsr request correlationId 112 from controller 1 epoch 29 for the become-leader transition for partition [othertopic,0] (state.change.logger)
[2016-11-15 15:00:14,003] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:27,ControllerEpoch:29),ReplicationFactor:3),AllReplicas:1,2,0) for partition [othertopic,0] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 113 (state.change.logger)
[2016-11-15 15:00:14,005] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:29,ControllerEpoch:29),ReplicationFactor:3),AllReplicas:2,0,1) correlation id 114 from controller 1 epoch 29 for partition [othertopic,1] (state.change.logger)
[2016-11-15 15:00:14,006] TRACE Broker 2 handling LeaderAndIsr request correlationId 114 from controller 1 epoch 29 starting the become-leader transition for partition [othertopic,1] (state.change.logger)
[2016-11-15 15:00:14,006] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 114 for partition [othertopic,1] (state.change.logger)
[2016-11-15 15:00:14,006] TRACE Broker 2 completed LeaderAndIsr request correlationId 114 from controller 1 epoch 29 for the become-leader transition for partition [othertopic,1] (state.change.logger)
[2016-11-15 15:00:14,009] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:29,ControllerEpoch:29),ReplicationFactor:3),AllReplicas:2,0,1) for partition [othertopic,1] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 115 (state.change.logger)
[2016-11-15 15:00:14,011] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:29),ReplicationFactor:3),AllReplicas:0,1,2) correlation id 116 from controller 1 epoch 29 for partition [othertopic,2] (state.change.logger)
[2016-11-15 15:00:14,011] TRACE Broker 2 handling LeaderAndIsr request correlationId 116 from controller 1 epoch 29 starting the become-leader transition for partition [othertopic,2] (state.change.logger)
[2016-11-15 15:00:14,012] TRACE Broker 2 stopped fetchers as part of become-leader request from controller 1 epoch 29 with correlation id 116 for partition [othertopic,2] (state.change.logger)
[2016-11-15 15:00:14,012] TRACE Broker 2 completed LeaderAndIsr request correlationId 116 from controller 1 epoch 29 for the become-leader transition for partition [othertopic,2] (state.change.logger)
[2016-11-15 15:00:14,014] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:29),ReplicationFactor:3),AllReplicas:0,1,2) for partition [othertopic,2] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 117 (state.change.logger)
[2016-11-15 15:00:15,972] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:27,ControllerEpoch:29),ReplicationFactor:3),AllReplicas:1,2,0) correlation id 118 from controller 1 epoch 29 for partition [othertopic,0] (state.change.logger)
[2016-11-15 15:00:15,973] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:29,ControllerEpoch:29),ReplicationFactor:3),AllReplicas:2,0,1) correlation id 118 from controller 1 epoch 29 for partition [othertopic,1] (state.change.logger)
[2016-11-15 15:00:15,973] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:29),ReplicationFactor:3),AllReplicas:0,1,2) correlation id 118 from controller 1 epoch 29 for partition [othertopic,2] (state.change.logger)
[2016-11-15 15:00:15,974] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 118 epoch 29 for partition [othertopic,0] since its associated leader epoch 27 is old. Current leader epoch is 27 (state.change.logger)
[2016-11-15 15:00:15,974] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 118 epoch 29 for partition [othertopic,1] since its associated leader epoch 29 is old. Current leader epoch is 29 (state.change.logger)
[2016-11-15 15:00:15,974] WARN Broker 2 ignoring LeaderAndIsr request from controller 1 with correlation id 118 epoch 29 for partition [othertopic,2] since its associated leader epoch 34 is old. Current leader epoch is 34 (state.change.logger)
[2016-11-15 15:00:15,979] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:27,ControllerEpoch:29),ReplicationFactor:3),AllReplicas:1,2,0) for partition [othertopic,0] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 119 (state.change.logger)
[2016-11-15 15:00:15,979] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:29,ControllerEpoch:29),ReplicationFactor:3),AllReplicas:2,0,1) for partition [othertopic,1] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 119 (state.change.logger)
[2016-11-15 15:00:15,979] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:29),ReplicationFactor:3),AllReplicas:0,1,2) for partition [othertopic,2] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 119 (state.change.logger)
[2016-11-15 15:00:15,979] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:29,ControllerEpoch:29),ReplicationFactor:1),AllReplicas:0) for partition [mytopic,0] in response to UpdateMetadata request sent by controller 1 epoch 29 with correlation id 119 (state.change.logger)
[2016-11-15 15:00:16,979] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,17] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,979] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,38] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,979] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,39] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,979] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,23] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,979] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,48] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,980] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,42] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,980] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,2] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,980] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,22] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,980] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,13] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,980] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,34] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,980] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [othertopic,1] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,980] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,40] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,980] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,33] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,980] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,3] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,980] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,37] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,981] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,24] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,981] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,11] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,981] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,20] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,981] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,27] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,981] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,30] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,981] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [topic1,0] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,981] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,15] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,981] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,28] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,981] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,7] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,981] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,43] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,981] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,10] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,982] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,12] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,982] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,32] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,982] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,4] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,982] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,26] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,982] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,35] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,982] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,46] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,982] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,6] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,982] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,8] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,982] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,44] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,982] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,45] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,983] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,49] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,983] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,1] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,983] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,19] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,983] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,36] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,983] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,14] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,983] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [othertopic,0] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,983] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,31] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,984] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,21] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,984] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [othertopic,2] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,984] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,25] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,984] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,5] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,984] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,41] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,984] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,47] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,985] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,16] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,985] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,0] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,985] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,29] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,985] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,18] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,985] TRACE Controller 2 epoch 30 changed state of replica 2 for partition [__consumer_offsets,9] from OnlineReplica to OnlineReplica (state.change.logger)
[2016-11-15 15:00:16,988] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,49] (state.change.logger)
[2016-11-15 15:00:16,988] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,38] (state.change.logger)
[2016-11-15 15:00:16,988] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,16] (state.change.logger)
[2016-11-15 15:00:16,988] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,27] (state.change.logger)
[2016-11-15 15:00:16,989] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:29,ControllerEpoch:29) to broker 2 for partition [othertopic,1] (state.change.logger)
[2016-11-15 15:00:16,989] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,8] (state.change.logger)
[2016-11-15 15:00:16,989] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,19] (state.change.logger)
[2016-11-15 15:00:16,989] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,2] (state.change.logger)
[2016-11-15 15:00:16,989] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,13] (state.change.logger)
[2016-11-15 15:00:16,989] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:11,ControllerEpoch:29) to broker 2 for partition [topic1,0] (state.change.logger)
[2016-11-15 15:00:16,989] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,24] (state.change.logger)
[2016-11-15 15:00:16,989] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,35] (state.change.logger)
[2016-11-15 15:00:16,989] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,46] (state.change.logger)
[2016-11-15 15:00:16,989] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,5] (state.change.logger)
[2016-11-15 15:00:16,989] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,43] (state.change.logger)
[2016-11-15 15:00:16,989] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,32] (state.change.logger)
[2016-11-15 15:00:16,989] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,21] (state.change.logger)
[2016-11-15 15:00:16,989] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,10] (state.change.logger)
[2016-11-15 15:00:16,989] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,37] (state.change.logger)
[2016-11-15 15:00:16,989] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,48] (state.change.logger)
[2016-11-15 15:00:16,989] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,18] (state.change.logger)
[2016-11-15 15:00:16,989] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,29] (state.change.logger)
[2016-11-15 15:00:16,989] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,40] (state.change.logger)
[2016-11-15 15:00:16,989] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,7] (state.change.logger)
[2016-11-15 15:00:16,989] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,23] (state.change.logger)
[2016-11-15 15:00:16,989] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,34] (state.change.logger)
[2016-11-15 15:00:16,989] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,45] (state.change.logger)
[2016-11-15 15:00:16,989] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,26] (state.change.logger)
[2016-11-15 15:00:16,989] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,15] (state.change.logger)
[2016-11-15 15:00:16,989] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,4] (state.change.logger)
[2016-11-15 15:00:16,990] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,42] (state.change.logger)
[2016-11-15 15:00:16,990] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,9] (state.change.logger)
[2016-11-15 15:00:16,990] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,20] (state.change.logger)
[2016-11-15 15:00:16,990] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,31] (state.change.logger)
[2016-11-15 15:00:16,990] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:27,ControllerEpoch:29) to broker 2 for partition [othertopic,0] (state.change.logger)
[2016-11-15 15:00:16,990] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,12] (state.change.logger)
[2016-11-15 15:00:16,990] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,1] (state.change.logger)
[2016-11-15 15:00:16,990] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,28] (state.change.logger)
[2016-11-15 15:00:16,990] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,17] (state.change.logger)
[2016-11-15 15:00:16,991] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,6] (state.change.logger)
[2016-11-15 15:00:16,991] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,39] (state.change.logger)
[2016-11-15 15:00:16,991] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,44] (state.change.logger)
[2016-11-15 15:00:16,991] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:29) to broker 2 for partition [othertopic,2] (state.change.logger)
[2016-11-15 15:00:16,991] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,36] (state.change.logger)
[2016-11-15 15:00:16,991] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,47] (state.change.logger)
[2016-11-15 15:00:16,991] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,3] (state.change.logger)
[2016-11-15 15:00:16,991] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,14] (state.change.logger)
[2016-11-15 15:00:16,991] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,25] (state.change.logger)
[2016-11-15 15:00:16,991] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,30] (state.change.logger)
[2016-11-15 15:00:16,991] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,41] (state.change.logger)
[2016-11-15 15:00:16,991] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,11] (state.change.logger)
[2016-11-15 15:00:16,991] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,22] (state.change.logger)
[2016-11-15 15:00:16,991] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,33] (state.change.logger)
[2016-11-15 15:00:16,992] TRACE Controller 2 epoch 30 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition [__consumer_offsets,0] (state.change.logger)
[2016-11-15 15:00:17,003] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-49 (state.change.logger)
[2016-11-15 15:00:17,004] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-38 (state.change.logger)
[2016-11-15 15:00:17,005] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-16 (state.change.logger)
[2016-11-15 15:00:17,006] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-27 (state.change.logger)
[2016-11-15 15:00:17,006] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:29,ControllerEpoch:29) to broker 2 for partition othertopic-1 (state.change.logger)
[2016-11-15 15:00:17,006] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-8 (state.change.logger)
[2016-11-15 15:00:17,006] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-19 (state.change.logger)
[2016-11-15 15:00:17,006] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-2 (state.change.logger)
[2016-11-15 15:00:17,006] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-13 (state.change.logger)
[2016-11-15 15:00:17,006] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:11,ControllerEpoch:29) to broker 2 for partition topic1-0 (state.change.logger)
[2016-11-15 15:00:17,008] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,32] (state.change.logger)
[2016-11-15 15:00:17,008] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,16] (state.change.logger)
[2016-11-15 15:00:17,008] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,49] (state.change.logger)
[2016-11-15 15:00:17,008] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,44] (state.change.logger)
[2016-11-15 15:00:17,008] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,28] (state.change.logger)
[2016-11-15 15:00:17,008] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,17] (state.change.logger)
[2016-11-15 15:00:17,008] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,23] (state.change.logger)
[2016-11-15 15:00:17,008] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,7] (state.change.logger)
[2016-11-15 15:00:17,008] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,4] (state.change.logger)
[2016-11-15 15:00:17,008] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,29] (state.change.logger)
[2016-11-15 15:00:17,008] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,35] (state.change.logger)
[2016-11-15 15:00:17,008] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,3] (state.change.logger)
[2016-11-15 15:00:17,008] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,24] (state.change.logger)
[2016-11-15 15:00:17,008] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,41] (state.change.logger)
[2016-11-15 15:00:17,008] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:11,ControllerEpoch:29),ReplicationFactor:1),AllReplicas:2) correlation id 0 from controller 2 epoch 30 for partition [topic1,0] (state.change.logger)
[2016-11-15 15:00:17,008] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,0] (state.change.logger)
[2016-11-15 15:00:17,009] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,38] (state.change.logger)
[2016-11-15 15:00:17,009] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,13] (state.change.logger)
[2016-11-15 15:00:17,009] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,8] (state.change.logger)
[2016-11-15 15:00:17,009] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,5] (state.change.logger)
[2016-11-15 15:00:17,009] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,39] (state.change.logger)
[2016-11-15 15:00:17,009] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,36] (state.change.logger)
[2016-11-15 15:00:17,009] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,40] (state.change.logger)
[2016-11-15 15:00:17,009] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:29),ReplicationFactor:3),AllReplicas:0,1,2) correlation id 0 from controller 2 epoch 30 for partition [othertopic,2] (state.change.logger)
[2016-11-15 15:00:17,009] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,45] (state.change.logger)
[2016-11-15 15:00:17,009] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,15] (state.change.logger)
[2016-11-15 15:00:17,009] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,33] (state.change.logger)
[2016-11-15 15:00:17,009] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,37] (state.change.logger)
[2016-11-15 15:00:17,009] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,21] (state.change.logger)
[2016-11-15 15:00:17,009] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:29,ControllerEpoch:29),ReplicationFactor:3),AllReplicas:2,0,1) correlation id 0 from controller 2 epoch 30 for partition [othertopic,1] (state.change.logger)
[2016-11-15 15:00:17,009] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,6] (state.change.logger)
[2016-11-15 15:00:17,009] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,11] (state.change.logger)
[2016-11-15 15:00:17,009] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,20] (state.change.logger)
[2016-11-15 15:00:17,009] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,47] (state.change.logger)
[2016-11-15 15:00:17,010] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,2] (state.change.logger)
[2016-11-15 15:00:17,010] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,27] (state.change.logger)
[2016-11-15 15:00:17,010] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,34] (state.change.logger)
[2016-11-15 15:00:17,010] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,9] (state.change.logger)
[2016-11-15 15:00:17,010] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,22] (state.change.logger)
[2016-11-15 15:00:17,010] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,42] (state.change.logger)
[2016-11-15 15:00:17,010] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,14] (state.change.logger)
[2016-11-15 15:00:17,010] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,25] (state.change.logger)
[2016-11-15 15:00:17,010] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,10] (state.change.logger)
[2016-11-15 15:00:17,010] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,48] (state.change.logger)
[2016-11-15 15:00:17,010] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,31] (state.change.logger)
[2016-11-15 15:00:17,010] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,18] (state.change.logger)
[2016-11-15 15:00:17,010] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,19] (state.change.logger)
[2016-11-15 15:00:17,010] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,12] (state.change.logger)
[2016-11-15 15:00:17,010] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,46] (state.change.logger)
[2016-11-15 15:00:17,011] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,43] (state.change.logger)
[2016-11-15 15:00:17,011] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,1] (state.change.logger)
[2016-11-15 15:00:17,011] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,26] (state.change.logger)
[2016-11-15 15:00:17,011] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) correlation id 0 from controller 2 epoch 30 for partition [__consumer_offsets,30] (state.change.logger)
[2016-11-15 15:00:17,011] TRACE Broker 2 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:27,ControllerEpoch:29),ReplicationFactor:3),AllReplicas:1,2,0) correlation id 0 from controller 2 epoch 30 for partition [othertopic,0] (state.change.logger)
[2016-11-15 15:00:17,011] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,32] since its associated leader epoch 14 is old. Current leader epoch is 14 (state.change.logger)
[2016-11-15 15:00:17,011] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,16] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,011] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,49] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,011] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,44] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,011] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,28] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,011] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,17] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,011] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,23] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,011] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,7] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,011] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,4] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,011] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,29] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,011] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,35] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,012] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,3] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,012] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,24] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,012] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,41] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,012] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [topic1,0] since its associated leader epoch 11 is old. Current leader epoch is 11 (state.change.logger)
[2016-11-15 15:00:17,012] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,0] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,012] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,38] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,012] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,13] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,012] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,8] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,012] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,5] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,012] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,39] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,012] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,36] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,012] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,40] since its associated leader epoch 14 is old. Current leader epoch is 14 (state.change.logger)
[2016-11-15 15:00:17,012] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [othertopic,2] since its associated leader epoch 34 is old. Current leader epoch is 34 (state.change.logger)
[2016-11-15 15:00:17,012] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,45] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,012] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,15] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,012] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,33] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,012] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,37] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,013] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,21] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,013] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [othertopic,1] since its associated leader epoch 29 is old. Current leader epoch is 29 (state.change.logger)
[2016-11-15 15:00:17,013] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,6] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,013] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,11] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,013] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,20] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,013] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,47] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,013] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,2] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,013] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,27] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,013] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,34] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,013] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,9] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,013] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,22] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,013] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,42] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,013] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,14] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,013] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,25] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,013] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,10] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,013] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,48] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,013] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,31] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,013] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,18] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,014] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,19] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,014] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,12] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,014] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,46] since its associated leader epoch 14 is old. Current leader epoch is 14 (state.change.logger)
[2016-11-15 15:00:17,014] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,43] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,014] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,1] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,014] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,26] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,014] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [__consumer_offsets,30] since its associated leader epoch 15 is old. Current leader epoch is 15 (state.change.logger)
[2016-11-15 15:00:17,014] WARN Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 0 epoch 30 for partition [othertopic,0] since its associated leader epoch 27 is old. Current leader epoch is 27 (state.change.logger)
[2016-11-15 15:00:17,016] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-24 (state.change.logger)
[2016-11-15 15:00:17,017] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-35 (state.change.logger)
[2016-11-15 15:00:17,017] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-46 (state.change.logger)
[2016-11-15 15:00:17,017] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-5 (state.change.logger)
[2016-11-15 15:00:17,017] TRACE Controller 2 epoch 30 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=19,error_code=13},{topic=__consumer_offsets,partition=30,error_code=13},{topic=__consumer_offsets,partition=47,error_code=13},{topic=__consumer_offsets,partition=29,error_code=13},{topic=__consumer_offsets,partition=41,error_code=13},{topic=__consumer_offsets,partition=39,error_code=13},{topic=__consumer_offsets,partition=17,error_code=13},{topic=__consumer_offsets,partition=10,error_code=13},{topic=__consumer_offsets,partition=14,error_code=13},{topic=__consumer_offsets,partition=40,error_code=13},{topic=__consumer_offsets,partition=18,error_code=13},{topic=__consumer_offsets,partition=26,error_code=13},{topic=__consumer_offsets,partition=0,error_code=13},{topic=__consumer_offsets,partition=24,error_code=13},{topic=__consumer_offsets,partition=33,error_code=13},{topic=othertopic,partition=0,error_code=13},{topic=__consumer_offsets,partition=20,error_code=13},{topic=__consumer_offsets,partition=3,error_code=13},{topic=__consumer_offsets,partition=21,error_code=13},{topic=__consumer_offsets,partition=5,error_code=13},{topic=__consumer_offsets,partition=22,error_code=13},{topic=othertopic,partition=1,error_code=13},{topic=__consumer_offsets,partition=12,error_code=13},{topic=__consumer_offsets,partition=8,error_code=13},{topic=__consumer_offsets,partition=23,error_code=13},{topic=__consumer_offsets,partition=15,error_code=13},{topic=__consumer_offsets,partition=11,error_code=13},{topic=__consumer_offsets,partition=48,error_code=13},{topic=__consumer_offsets,partition=13,error_code=13},{topic=__consumer_offsets,partition=49,error_code=13},{topic=__consumer_offsets,partition=6,error_code=13},{topic=__consumer_offsets,partition=28,error_code=13},{topic=__consumer_offsets,partition=4,error_code=13},{topic=__consumer_offsets,partition=37,error_code=13},{topic=__consumer_offsets,partition=31,error_code=13},{topic=__consumer_offsets,partition=44,error_code=13},{topic=__consumer_offsets,partition=42,error_code=13},{topic=__consumer_offsets,partition=34,error_code=13},{topic=topic1,partition=0,error_code=13},{topic=__consumer_offsets,partition=46,error_code=13},{topic=__consumer_offsets,partition=25,error_code=13},{topic=__consumer_offsets,partition=45,error_code=13},{topic=__consumer_offsets,partition=27,error_code=13},{topic=__consumer_offsets,partition=32,error_code=13},{topic=__consumer_offsets,partition=43,error_code=13},{topic=othertopic,partition=2,error_code=13},{topic=__consumer_offsets,partition=36,error_code=13},{topic=__consumer_offsets,partition=35,error_code=13},{topic=__consumer_offsets,partition=7,error_code=13},{topic=__consumer_offsets,partition=38,error_code=13},{topic=__consumer_offsets,partition=9,error_code=13},{topic=__consumer_offsets,partition=1,error_code=13},{topic=__consumer_offsets,partition=16,error_code=13},{topic=__consumer_offsets,partition=2,error_code=13}]} for a request sent to broker Node(2, localhost, 9094) (state.change.logger)
[2016-11-15 15:00:17,017] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-43 (state.change.logger)
[2016-11-15 15:00:17,017] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-32 (state.change.logger)
[2016-11-15 15:00:17,017] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-21 (state.change.logger)
[2016-11-15 15:00:17,017] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-10 (state.change.logger)
[2016-11-15 15:00:17,017] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-37 (state.change.logger)
[2016-11-15 15:00:17,017] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-48 (state.change.logger)
[2016-11-15 15:00:17,017] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-18 (state.change.logger)
[2016-11-15 15:00:17,017] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-29 (state.change.logger)
[2016-11-15 15:00:17,017] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-40 (state.change.logger)
[2016-11-15 15:00:17,017] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-7 (state.change.logger)
[2016-11-15 15:00:17,017] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-23 (state.change.logger)
[2016-11-15 15:00:17,017] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-34 (state.change.logger)
[2016-11-15 15:00:17,018] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-45 (state.change.logger)
[2016-11-15 15:00:17,018] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-26 (state.change.logger)
[2016-11-15 15:00:17,018] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-15 (state.change.logger)
[2016-11-15 15:00:17,018] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-4 (state.change.logger)
[2016-11-15 15:00:17,018] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-42 (state.change.logger)
[2016-11-15 15:00:17,018] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-9 (state.change.logger)
[2016-11-15 15:00:17,018] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-20 (state.change.logger)
[2016-11-15 15:00:17,018] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-31 (state.change.logger)
[2016-11-15 15:00:17,018] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:27,ControllerEpoch:29) to broker 2 for partition othertopic-0 (state.change.logger)
[2016-11-15 15:00:17,018] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-12 (state.change.logger)
[2016-11-15 15:00:17,018] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-1 (state.change.logger)
[2016-11-15 15:00:17,018] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-28 (state.change.logger)
[2016-11-15 15:00:17,018] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-17 (state.change.logger)
[2016-11-15 15:00:17,018] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-6 (state.change.logger)
[2016-11-15 15:00:17,018] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-39 (state.change.logger)
[2016-11-15 15:00:17,018] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-44 (state.change.logger)
[2016-11-15 15:00:17,018] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:29) to broker 2 for partition othertopic-2 (state.change.logger)
[2016-11-15 15:00:17,018] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-36 (state.change.logger)
[2016-11-15 15:00:17,018] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-47 (state.change.logger)
[2016-11-15 15:00:17,019] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-3 (state.change.logger)
[2016-11-15 15:00:17,019] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-14 (state.change.logger)
[2016-11-15 15:00:17,019] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-25 (state.change.logger)
[2016-11-15 15:00:17,019] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-30 (state.change.logger)
[2016-11-15 15:00:17,019] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-41 (state.change.logger)
[2016-11-15 15:00:17,019] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-11 (state.change.logger)
[2016-11-15 15:00:17,019] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-22 (state.change.logger)
[2016-11-15 15:00:17,019] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-33 (state.change.logger)
[2016-11-15 15:00:17,019] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-0 (state.change.logger)
[2016-11-15 15:00:17,028] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,32] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,029] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,16] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,029] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,49] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,029] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,44] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,029] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,28] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,029] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,17] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,029] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,23] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,029] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,7] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,029] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,4] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,029] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,29] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,029] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,35] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,029] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,3] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,029] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,24] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,029] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,41] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,030] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:11,ControllerEpoch:29),ReplicationFactor:1),AllReplicas:2) for partition [topic1,0] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,030] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,0] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,030] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,38] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,030] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,13] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,030] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,8] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,030] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,5] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,030] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,39] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,030] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,36] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,030] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,40] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,030] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:29),ReplicationFactor:3),AllReplicas:0,1,2) for partition [othertopic,2] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,030] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,45] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,030] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,15] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,030] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,33] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,031] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,37] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,031] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,21] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,031] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:29,ControllerEpoch:29),ReplicationFactor:3),AllReplicas:2,0,1) for partition [othertopic,1] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,031] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,6] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,031] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,11] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,031] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,20] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,031] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,47] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,032] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,2] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,032] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,27] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,032] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,34] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,032] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,9] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,032] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,22] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,032] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,42] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,032] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,14] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,032] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,25] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,032] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,10] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,032] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,48] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,032] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,31] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,033] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,18] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,033] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,19] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,033] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,12] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,033] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,46] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,033] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,43] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,033] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,1] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,033] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,26] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,033] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,30] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,033] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:27,ControllerEpoch:29),ReplicationFactor:3),AllReplicas:1,2,0) for partition [othertopic,0] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 1 (state.change.logger)
[2016-11-15 15:00:17,034] TRACE Controller 2 epoch 30 received response {error_code=0} for a request sent to broker Node(2, localhost, 9094) (state.change.logger)
[2016-11-15 15:00:17,038] TRACE Controller 2 epoch 30 started leader election for partition [mytopic,0] (state.change.logger)
[2016-11-15 15:00:17,049] ERROR Controller 2 epoch 30 initiated state change for partition [mytopic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [mytopic,0] is alive. Live brokers are: [Set(2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply$mcZ$sp(ZookeeperLeaderElector.scala:146)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:141)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener$$anonfun$handleDataDeleted$1.apply(ZookeeperLeaderElector.scala:141)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.server.ZookeeperLeaderElector$LeaderChangeListener.handleDataDeleted(ZookeeperLeaderElector.scala:141)
	at org.I0Itec.zkclient.ZkClient$9.run(ZkClient.java:823)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2016-11-15 15:00:17,104] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-49 (state.change.logger)
[2016-11-15 15:00:17,105] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-38 (state.change.logger)
[2016-11-15 15:00:17,105] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-16 (state.change.logger)
[2016-11-15 15:00:17,105] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-27 (state.change.logger)
[2016-11-15 15:00:17,105] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:29,ControllerEpoch:29) to broker 2 for partition othertopic-1 (state.change.logger)
[2016-11-15 15:00:17,105] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-8 (state.change.logger)
[2016-11-15 15:00:17,105] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-19 (state.change.logger)
[2016-11-15 15:00:17,105] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-2 (state.change.logger)
[2016-11-15 15:00:17,105] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-13 (state.change.logger)
[2016-11-15 15:00:17,105] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-24 (state.change.logger)
[2016-11-15 15:00:17,105] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:11,ControllerEpoch:29) to broker 2 for partition topic1-0 (state.change.logger)
[2016-11-15 15:00:17,105] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-46 (state.change.logger)
[2016-11-15 15:00:17,105] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-35 (state.change.logger)
[2016-11-15 15:00:17,105] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:29,ControllerEpoch:29) to broker 2 for partition mytopic-0 (state.change.logger)
[2016-11-15 15:00:17,105] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-5 (state.change.logger)
[2016-11-15 15:00:17,106] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-43 (state.change.logger)
[2016-11-15 15:00:17,106] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-21 (state.change.logger)
[2016-11-15 15:00:17,106] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-32 (state.change.logger)
[2016-11-15 15:00:17,106] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-10 (state.change.logger)
[2016-11-15 15:00:17,106] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-37 (state.change.logger)
[2016-11-15 15:00:17,106] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-48 (state.change.logger)
[2016-11-15 15:00:17,106] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-29 (state.change.logger)
[2016-11-15 15:00:17,106] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-40 (state.change.logger)
[2016-11-15 15:00:17,106] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-18 (state.change.logger)
[2016-11-15 15:00:17,106] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-7 (state.change.logger)
[2016-11-15 15:00:17,106] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-23 (state.change.logger)
[2016-11-15 15:00:17,106] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-34 (state.change.logger)
[2016-11-15 15:00:17,106] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-45 (state.change.logger)
[2016-11-15 15:00:17,106] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-26 (state.change.logger)
[2016-11-15 15:00:17,106] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-15 (state.change.logger)
[2016-11-15 15:00:17,106] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-4 (state.change.logger)
[2016-11-15 15:00:17,106] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-42 (state.change.logger)
[2016-11-15 15:00:17,106] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-9 (state.change.logger)
[2016-11-15 15:00:17,107] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-20 (state.change.logger)
[2016-11-15 15:00:17,107] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-31 (state.change.logger)
[2016-11-15 15:00:17,107] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:27,ControllerEpoch:29) to broker 2 for partition othertopic-0 (state.change.logger)
[2016-11-15 15:00:17,107] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-1 (state.change.logger)
[2016-11-15 15:00:17,107] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-12 (state.change.logger)
[2016-11-15 15:00:17,107] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-17 (state.change.logger)
[2016-11-15 15:00:17,107] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-28 (state.change.logger)
[2016-11-15 15:00:17,107] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-6 (state.change.logger)
[2016-11-15 15:00:17,107] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-39 (state.change.logger)
[2016-11-15 15:00:17,107] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-44 (state.change.logger)
[2016-11-15 15:00:17,107] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:29) to broker 2 for partition othertopic-2 (state.change.logger)
[2016-11-15 15:00:17,107] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-47 (state.change.logger)
[2016-11-15 15:00:17,107] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-36 (state.change.logger)
[2016-11-15 15:00:17,107] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-3 (state.change.logger)
[2016-11-15 15:00:17,107] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-14 (state.change.logger)
[2016-11-15 15:00:17,107] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-25 (state.change.logger)
[2016-11-15 15:00:17,107] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-30 (state.change.logger)
[2016-11-15 15:00:17,107] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-41 (state.change.logger)
[2016-11-15 15:00:17,107] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-22 (state.change.logger)
[2016-11-15 15:00:17,108] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-33 (state.change.logger)
[2016-11-15 15:00:17,108] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-11 (state.change.logger)
[2016-11-15 15:00:17,108] TRACE Controller 2 epoch 30 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29) to broker 2 for partition __consumer_offsets-0 (state.change.logger)
[2016-11-15 15:00:17,111] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,32] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,111] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,16] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,111] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,49] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,111] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,44] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,111] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,28] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,112] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,17] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,112] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,23] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,112] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,7] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,112] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,4] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,112] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,29] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,112] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,35] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,112] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,3] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,112] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,24] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,112] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,41] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,112] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:11,ControllerEpoch:29),ReplicationFactor:1),AllReplicas:2) for partition [topic1,0] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,112] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,0] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,112] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,38] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,112] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,13] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,112] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,8] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,113] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,5] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,113] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,39] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,113] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,36] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,113] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,40] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,113] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:34,ControllerEpoch:29),ReplicationFactor:3),AllReplicas:0,1,2) for partition [othertopic,2] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,113] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,45] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,113] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,15] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,113] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,33] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,114] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,37] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,114] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,21] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,114] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:29,ControllerEpoch:29),ReplicationFactor:3),AllReplicas:2,0,1) for partition [othertopic,1] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,114] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,6] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,114] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,11] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,114] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,20] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,114] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,47] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,114] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,2] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,114] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,27] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,114] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:29,ControllerEpoch:29),ReplicationFactor:1),AllReplicas:0) for partition [mytopic,0] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,114] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,34] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,115] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,9] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,115] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,22] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,115] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,42] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,115] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,14] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,115] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,25] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,115] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,10] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,115] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,48] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,115] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,31] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,115] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,18] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,115] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,19] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,115] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,12] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,115] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,46] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,115] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,43] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,116] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:2,1) for partition [__consumer_offsets,1] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,116] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,26] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,116] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:29),ReplicationFactor:2),AllReplicas:1,2) for partition [__consumer_offsets,30] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,116] TRACE Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:27,ControllerEpoch:29),ReplicationFactor:3),AllReplicas:1,2,0) for partition [othertopic,0] in response to UpdateMetadata request sent by controller 2 epoch 30 with correlation id 2 (state.change.logger)
[2016-11-15 15:00:17,116] TRACE Controller 2 epoch 30 received response {error_code=0} for a request sent to broker Node(2, localhost, 9094) (state.change.logger)
[2016-11-15 15:00:18,960] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,40] (state.change.logger)
[2016-11-15 15:00:18,965] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,40] due to: No other replicas in ISR 2 for [__consumer_offsets,40] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:18,965] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,40] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,40] due to: No other replicas in ISR 2 for [__consumer_offsets,40] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,40] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:18,968] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,39] (state.change.logger)
[2016-11-15 15:00:18,970] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,39] due to: No other replicas in ISR 2 for [__consumer_offsets,39] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:18,971] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,39] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,39] due to: No other replicas in ISR 2 for [__consumer_offsets,39] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,39] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:18,971] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,32] (state.change.logger)
[2016-11-15 15:00:18,974] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,32] due to: No other replicas in ISR 2 for [__consumer_offsets,32] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:18,974] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,32] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,32] due to: No other replicas in ISR 2 for [__consumer_offsets,32] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,32] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:18,975] TRACE Controller 2 epoch 30 started leader election for partition [othertopic,2] (state.change.logger)
[2016-11-15 15:00:18,976] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [othertopic,2] due to: No other replicas in ISR 2 for [othertopic,2] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:18,976] ERROR Controller 2 epoch 30 initiated state change for partition [othertopic,2] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [othertopic,2] due to: No other replicas in ISR 2 for [othertopic,2] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [othertopic,2] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:18,977] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,13] (state.change.logger)
[2016-11-15 15:00:18,979] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,13] due to: No other replicas in ISR 2 for [__consumer_offsets,13] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:18,979] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,13] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,13] due to: No other replicas in ISR 2 for [__consumer_offsets,13] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,13] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:18,980] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,21] (state.change.logger)
[2016-11-15 15:00:18,983] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,21] due to: No other replicas in ISR 2 for [__consumer_offsets,21] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:18,983] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,21] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,21] due to: No other replicas in ISR 2 for [__consumer_offsets,21] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,21] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 21 more
[2016-11-15 15:00:18,984] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,12] (state.change.logger)
[2016-11-15 15:00:18,995] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,12] due to: No other replicas in ISR 2 for [__consumer_offsets,12] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:18,995] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,12] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,12] due to: No other replicas in ISR 2 for [__consumer_offsets,12] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,12] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 21 more
[2016-11-15 15:00:18,996] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,7] (state.change.logger)
[2016-11-15 15:00:19,000] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,7] due to: No other replicas in ISR 2 for [__consumer_offsets,7] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,001] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,7] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,7] due to: No other replicas in ISR 2 for [__consumer_offsets,7] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,7] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 21 more
[2016-11-15 15:00:19,001] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,18] (state.change.logger)
[2016-11-15 15:00:19,004] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,18] due to: No other replicas in ISR 2 for [__consumer_offsets,18] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,004] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,18] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,18] due to: No other replicas in ISR 2 for [__consumer_offsets,18] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,18] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 21 more
[2016-11-15 15:00:19,005] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,24] (state.change.logger)
[2016-11-15 15:00:19,007] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,24] due to: No other replicas in ISR 2 for [__consumer_offsets,24] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,008] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,24] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,24] due to: No other replicas in ISR 2 for [__consumer_offsets,24] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,24] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:19,011] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,26] (state.change.logger)
[2016-11-15 15:00:19,013] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,26] due to: No other replicas in ISR 2 for [__consumer_offsets,26] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,013] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,26] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,26] due to: No other replicas in ISR 2 for [__consumer_offsets,26] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,26] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:19,014] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,19] (state.change.logger)
[2016-11-15 15:00:19,016] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,19] due to: No other replicas in ISR 2 for [__consumer_offsets,19] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,016] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,19] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,19] due to: No other replicas in ISR 2 for [__consumer_offsets,19] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,19] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:19,017] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,22] (state.change.logger)
[2016-11-15 15:00:19,020] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,22] due to: No other replicas in ISR 2 for [__consumer_offsets,22] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,020] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,22] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,22] due to: No other replicas in ISR 2 for [__consumer_offsets,22] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,22] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:19,021] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,36] (state.change.logger)
[2016-11-15 15:00:19,024] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,36] due to: No other replicas in ISR 2 for [__consumer_offsets,36] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,024] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,36] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,36] due to: No other replicas in ISR 2 for [__consumer_offsets,36] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,36] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:19,025] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,49] (state.change.logger)
[2016-11-15 15:00:19,028] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,49] due to: No other replicas in ISR 2 for [__consumer_offsets,49] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,028] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,49] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,49] due to: No other replicas in ISR 2 for [__consumer_offsets,49] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,49] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:19,029] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,27] (state.change.logger)
[2016-11-15 15:00:19,031] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,27] due to: No other replicas in ISR 2 for [__consumer_offsets,27] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,031] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,27] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,27] due to: No other replicas in ISR 2 for [__consumer_offsets,27] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,27] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:19,032] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,11] (state.change.logger)
[2016-11-15 15:00:19,035] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,11] due to: No other replicas in ISR 2 for [__consumer_offsets,11] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,035] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,11] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,11] due to: No other replicas in ISR 2 for [__consumer_offsets,11] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,11] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:19,035] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,46] (state.change.logger)
[2016-11-15 15:00:19,038] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,46] due to: No other replicas in ISR 2 for [__consumer_offsets,46] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,038] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,46] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,46] due to: No other replicas in ISR 2 for [__consumer_offsets,46] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,46] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 21 more
[2016-11-15 15:00:19,038] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,31] (state.change.logger)
[2016-11-15 15:00:19,041] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,31] due to: No other replicas in ISR 2 for [__consumer_offsets,31] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,041] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,31] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,31] due to: No other replicas in ISR 2 for [__consumer_offsets,31] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,31] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:19,042] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,2] (state.change.logger)
[2016-11-15 15:00:19,045] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,2] due to: No other replicas in ISR 2 for [__consumer_offsets,2] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,045] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,2] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,2] due to: No other replicas in ISR 2 for [__consumer_offsets,2] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,2] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:19,046] TRACE Controller 2 epoch 30 started leader election for partition [othertopic,1] (state.change.logger)
[2016-11-15 15:00:19,048] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [othertopic,1] due to: No other replicas in ISR 2 for [othertopic,1] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,049] ERROR Controller 2 epoch 30 initiated state change for partition [othertopic,1] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [othertopic,1] due to: No other replicas in ISR 2 for [othertopic,1] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [othertopic,1] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:19,049] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,45] (state.change.logger)
[2016-11-15 15:00:19,052] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,45] due to: No other replicas in ISR 2 for [__consumer_offsets,45] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,052] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,45] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,45] due to: No other replicas in ISR 2 for [__consumer_offsets,45] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,45] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:19,053] TRACE Controller 2 epoch 30 started leader election for partition [othertopic,0] (state.change.logger)
[2016-11-15 15:00:19,057] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [othertopic,0] due to: No other replicas in ISR 2 for [othertopic,0] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,057] ERROR Controller 2 epoch 30 initiated state change for partition [othertopic,0] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [othertopic,0] due to: No other replicas in ISR 2 for [othertopic,0] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [othertopic,0] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:19,057] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,42] (state.change.logger)
[2016-11-15 15:00:19,059] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,42] due to: No other replicas in ISR 2 for [__consumer_offsets,42] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,059] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,42] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,42] due to: No other replicas in ISR 2 for [__consumer_offsets,42] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,42] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:19,060] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,4] (state.change.logger)
[2016-11-15 15:00:19,062] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,4] due to: No other replicas in ISR 2 for [__consumer_offsets,4] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,062] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,4] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,4] due to: No other replicas in ISR 2 for [__consumer_offsets,4] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,4] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:19,062] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,41] (state.change.logger)
[2016-11-15 15:00:19,065] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,41] due to: No other replicas in ISR 2 for [__consumer_offsets,41] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,065] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,41] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,41] due to: No other replicas in ISR 2 for [__consumer_offsets,41] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,41] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:19,065] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,6] (state.change.logger)
[2016-11-15 15:00:19,068] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,6] due to: No other replicas in ISR 2 for [__consumer_offsets,6] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,068] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,6] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,6] due to: No other replicas in ISR 2 for [__consumer_offsets,6] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,6] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:19,068] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,44] (state.change.logger)
[2016-11-15 15:00:19,071] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,44] due to: No other replicas in ISR 2 for [__consumer_offsets,44] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,071] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,44] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,44] due to: No other replicas in ISR 2 for [__consumer_offsets,44] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,44] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 21 more
[2016-11-15 15:00:19,072] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,37] (state.change.logger)
[2016-11-15 15:00:19,074] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,37] due to: No other replicas in ISR 2 for [__consumer_offsets,37] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,074] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,37] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,37] due to: No other replicas in ISR 2 for [__consumer_offsets,37] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,37] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:19,074] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,1] (state.change.logger)
[2016-11-15 15:00:19,076] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,1] due to: No other replicas in ISR 2 for [__consumer_offsets,1] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,076] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,1] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,1] due to: No other replicas in ISR 2 for [__consumer_offsets,1] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,1] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:19,076] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,47] (state.change.logger)
[2016-11-15 15:00:19,078] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,47] due to: No other replicas in ISR 2 for [__consumer_offsets,47] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,078] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,47] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,47] due to: No other replicas in ISR 2 for [__consumer_offsets,47] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,47] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:19,079] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,17] (state.change.logger)
[2016-11-15 15:00:19,081] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,17] due to: No other replicas in ISR 2 for [__consumer_offsets,17] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,081] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,17] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,17] due to: No other replicas in ISR 2 for [__consumer_offsets,17] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,17] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:19,082] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,14] (state.change.logger)
[2016-11-15 15:00:19,083] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,14] due to: No other replicas in ISR 2 for [__consumer_offsets,14] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,083] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,14] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,14] due to: No other replicas in ISR 2 for [__consumer_offsets,14] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,14] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:19,084] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,5] (state.change.logger)
[2016-11-15 15:00:19,087] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,5] due to: No other replicas in ISR 2 for [__consumer_offsets,5] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,087] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,5] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,5] due to: No other replicas in ISR 2 for [__consumer_offsets,5] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,5] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:19,087] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,29] (state.change.logger)
[2016-11-15 15:00:19,089] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,29] due to: No other replicas in ISR 2 for [__consumer_offsets,29] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,090] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,29] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,29] due to: No other replicas in ISR 2 for [__consumer_offsets,29] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,29] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:19,090] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,9] (state.change.logger)
[2016-11-15 15:00:19,092] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,9] due to: No other replicas in ISR 2 for [__consumer_offsets,9] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,092] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,9] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,9] due to: No other replicas in ISR 2 for [__consumer_offsets,9] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,9] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:19,092] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,48] (state.change.logger)
[2016-11-15 15:00:19,094] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,48] due to: No other replicas in ISR 2 for [__consumer_offsets,48] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,094] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,48] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,48] due to: No other replicas in ISR 2 for [__consumer_offsets,48] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,48] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:19,095] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,23] (state.change.logger)
[2016-11-15 15:00:19,097] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,23] due to: No other replicas in ISR 2 for [__consumer_offsets,23] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,097] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,23] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,23] due to: No other replicas in ISR 2 for [__consumer_offsets,23] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,23] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:19,098] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,20] (state.change.logger)
[2016-11-15 15:00:19,100] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,20] due to: No other replicas in ISR 2 for [__consumer_offsets,20] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,100] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,20] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,20] due to: No other replicas in ISR 2 for [__consumer_offsets,20] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,20] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:19,101] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,25] (state.change.logger)
[2016-11-15 15:00:19,102] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,25] due to: No other replicas in ISR 2 for [__consumer_offsets,25] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,103] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,25] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,25] due to: No other replicas in ISR 2 for [__consumer_offsets,25] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,25] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 21 more
[2016-11-15 15:00:19,103] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,16] (state.change.logger)
[2016-11-15 15:00:19,105] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,16] due to: No other replicas in ISR 2 for [__consumer_offsets,16] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,105] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,16] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,16] due to: No other replicas in ISR 2 for [__consumer_offsets,16] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,16] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 21 more
[2016-11-15 15:00:19,105] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,35] (state.change.logger)
[2016-11-15 15:00:19,107] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,35] due to: No other replicas in ISR 2 for [__consumer_offsets,35] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,108] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,35] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,35] due to: No other replicas in ISR 2 for [__consumer_offsets,35] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,35] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 21 more
[2016-11-15 15:00:19,108] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,34] (state.change.logger)
[2016-11-15 15:00:19,110] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,34] due to: No other replicas in ISR 2 for [__consumer_offsets,34] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,110] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,34] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,34] due to: No other replicas in ISR 2 for [__consumer_offsets,34] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,34] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 21 more
[2016-11-15 15:00:19,111] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,15] (state.change.logger)
[2016-11-15 15:00:19,112] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,15] due to: No other replicas in ISR 2 for [__consumer_offsets,15] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,112] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,15] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,15] due to: No other replicas in ISR 2 for [__consumer_offsets,15] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,15] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:19,113] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,10] (state.change.logger)
[2016-11-15 15:00:19,115] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,10] due to: No other replicas in ISR 2 for [__consumer_offsets,10] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,115] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,10] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,10] due to: No other replicas in ISR 2 for [__consumer_offsets,10] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,10] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:19,116] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,3] (state.change.logger)
[2016-11-15 15:00:19,117] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,3] due to: No other replicas in ISR 2 for [__consumer_offsets,3] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,117] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,3] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,3] due to: No other replicas in ISR 2 for [__consumer_offsets,3] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,3] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 21 more
[2016-11-15 15:00:19,118] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,28] (state.change.logger)
[2016-11-15 15:00:19,119] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,28] due to: No other replicas in ISR 2 for [__consumer_offsets,28] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,119] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,28] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,28] due to: No other replicas in ISR 2 for [__consumer_offsets,28] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,28] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:19,120] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,30] (state.change.logger)
[2016-11-15 15:00:19,122] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,30] due to: No other replicas in ISR 2 for [__consumer_offsets,30] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,122] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,30] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,30] due to: No other replicas in ISR 2 for [__consumer_offsets,30] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,30] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:19,122] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,43] (state.change.logger)
[2016-11-15 15:00:19,125] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,43] due to: No other replicas in ISR 2 for [__consumer_offsets,43] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,125] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,43] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,43] due to: No other replicas in ISR 2 for [__consumer_offsets,43] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,43] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:19,125] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,0] (state.change.logger)
[2016-11-15 15:00:19,127] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,0] due to: No other replicas in ISR 2 for [__consumer_offsets,0] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,127] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,0] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,0] due to: No other replicas in ISR 2 for [__consumer_offsets,0] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,0] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:19,128] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,38] (state.change.logger)
[2016-11-15 15:00:19,129] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,38] due to: No other replicas in ISR 2 for [__consumer_offsets,38] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,129] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,38] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,38] due to: No other replicas in ISR 2 for [__consumer_offsets,38] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,38] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:19,130] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,33] (state.change.logger)
[2016-11-15 15:00:19,133] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,33] due to: No other replicas in ISR 2 for [__consumer_offsets,33] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,133] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,33] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,33] due to: No other replicas in ISR 2 for [__consumer_offsets,33] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,33] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:19,133] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,8] (state.change.logger)
[2016-11-15 15:00:19,135] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,8] due to: No other replicas in ISR 2 for [__consumer_offsets,8] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:19,135] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,8] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,8] due to: No other replicas in ISR 2 for [__consumer_offsets,8] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,8] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 21 more
[2016-11-15 15:00:24,159] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,40] (state.change.logger)
[2016-11-15 15:00:24,161] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,40] due to: No other replicas in ISR 2 for [__consumer_offsets,40] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,161] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,40] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,40] due to: No other replicas in ISR 2 for [__consumer_offsets,40] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,40] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:24,161] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,39] (state.change.logger)
[2016-11-15 15:00:24,164] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,39] due to: No other replicas in ISR 2 for [__consumer_offsets,39] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,164] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,39] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,39] due to: No other replicas in ISR 2 for [__consumer_offsets,39] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,39] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:24,165] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,32] (state.change.logger)
[2016-11-15 15:00:24,166] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,32] due to: No other replicas in ISR 2 for [__consumer_offsets,32] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,166] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,32] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,32] due to: No other replicas in ISR 2 for [__consumer_offsets,32] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,32] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:24,172] TRACE Controller 2 epoch 30 started leader election for partition [othertopic,2] (state.change.logger)
[2016-11-15 15:00:24,174] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [othertopic,2] due to: No other replicas in ISR 2 for [othertopic,2] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,174] ERROR Controller 2 epoch 30 initiated state change for partition [othertopic,2] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [othertopic,2] due to: No other replicas in ISR 2 for [othertopic,2] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [othertopic,2] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:24,174] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,13] (state.change.logger)
[2016-11-15 15:00:24,177] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,13] due to: No other replicas in ISR 2 for [__consumer_offsets,13] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,177] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,13] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,13] due to: No other replicas in ISR 2 for [__consumer_offsets,13] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,13] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:24,177] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,21] (state.change.logger)
[2016-11-15 15:00:24,179] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,21] due to: No other replicas in ISR 2 for [__consumer_offsets,21] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,179] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,21] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,21] due to: No other replicas in ISR 2 for [__consumer_offsets,21] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,21] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 21 more
[2016-11-15 15:00:24,180] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,12] (state.change.logger)
[2016-11-15 15:00:24,182] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,12] due to: No other replicas in ISR 2 for [__consumer_offsets,12] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,182] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,12] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,12] due to: No other replicas in ISR 2 for [__consumer_offsets,12] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,12] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 21 more
[2016-11-15 15:00:24,183] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,7] (state.change.logger)
[2016-11-15 15:00:24,186] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,7] due to: No other replicas in ISR 2 for [__consumer_offsets,7] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,186] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,7] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,7] due to: No other replicas in ISR 2 for [__consumer_offsets,7] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,7] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 21 more
[2016-11-15 15:00:24,186] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,18] (state.change.logger)
[2016-11-15 15:00:24,188] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,18] due to: No other replicas in ISR 2 for [__consumer_offsets,18] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,188] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,18] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,18] due to: No other replicas in ISR 2 for [__consumer_offsets,18] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,18] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 21 more
[2016-11-15 15:00:24,189] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,24] (state.change.logger)
[2016-11-15 15:00:24,191] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,24] due to: No other replicas in ISR 2 for [__consumer_offsets,24] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,191] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,24] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,24] due to: No other replicas in ISR 2 for [__consumer_offsets,24] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,24] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:24,192] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,26] (state.change.logger)
[2016-11-15 15:00:24,194] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,26] due to: No other replicas in ISR 2 for [__consumer_offsets,26] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,194] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,26] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,26] due to: No other replicas in ISR 2 for [__consumer_offsets,26] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,26] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:24,194] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,19] (state.change.logger)
[2016-11-15 15:00:24,196] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,19] due to: No other replicas in ISR 2 for [__consumer_offsets,19] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,197] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,19] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,19] due to: No other replicas in ISR 2 for [__consumer_offsets,19] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,19] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:24,197] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,22] (state.change.logger)
[2016-11-15 15:00:24,199] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,22] due to: No other replicas in ISR 2 for [__consumer_offsets,22] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,200] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,22] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,22] due to: No other replicas in ISR 2 for [__consumer_offsets,22] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,22] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:24,200] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,36] (state.change.logger)
[2016-11-15 15:00:24,202] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,36] due to: No other replicas in ISR 2 for [__consumer_offsets,36] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,202] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,36] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,36] due to: No other replicas in ISR 2 for [__consumer_offsets,36] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,36] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:24,202] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,49] (state.change.logger)
[2016-11-15 15:00:24,205] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,49] due to: No other replicas in ISR 2 for [__consumer_offsets,49] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,205] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,49] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,49] due to: No other replicas in ISR 2 for [__consumer_offsets,49] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,49] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:24,206] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,27] (state.change.logger)
[2016-11-15 15:00:24,208] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,27] due to: No other replicas in ISR 2 for [__consumer_offsets,27] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,209] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,27] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,27] due to: No other replicas in ISR 2 for [__consumer_offsets,27] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,27] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:24,209] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,11] (state.change.logger)
[2016-11-15 15:00:24,211] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,11] due to: No other replicas in ISR 2 for [__consumer_offsets,11] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,211] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,11] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,11] due to: No other replicas in ISR 2 for [__consumer_offsets,11] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,11] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:24,212] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,46] (state.change.logger)
[2016-11-15 15:00:24,214] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,46] due to: No other replicas in ISR 2 for [__consumer_offsets,46] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,214] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,46] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,46] due to: No other replicas in ISR 2 for [__consumer_offsets,46] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,46] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 21 more
[2016-11-15 15:00:24,215] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,31] (state.change.logger)
[2016-11-15 15:00:24,217] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,31] due to: No other replicas in ISR 2 for [__consumer_offsets,31] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,217] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,31] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,31] due to: No other replicas in ISR 2 for [__consumer_offsets,31] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,31] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:24,218] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,2] (state.change.logger)
[2016-11-15 15:00:24,221] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,2] due to: No other replicas in ISR 2 for [__consumer_offsets,2] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,221] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,2] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,2] due to: No other replicas in ISR 2 for [__consumer_offsets,2] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,2] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:24,221] TRACE Controller 2 epoch 30 started leader election for partition [othertopic,1] (state.change.logger)
[2016-11-15 15:00:24,224] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [othertopic,1] due to: No other replicas in ISR 2 for [othertopic,1] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,224] ERROR Controller 2 epoch 30 initiated state change for partition [othertopic,1] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [othertopic,1] due to: No other replicas in ISR 2 for [othertopic,1] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [othertopic,1] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:24,224] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,45] (state.change.logger)
[2016-11-15 15:00:24,227] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,45] due to: No other replicas in ISR 2 for [__consumer_offsets,45] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,227] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,45] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,45] due to: No other replicas in ISR 2 for [__consumer_offsets,45] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,45] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:24,227] TRACE Controller 2 epoch 30 started leader election for partition [othertopic,0] (state.change.logger)
[2016-11-15 15:00:24,230] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [othertopic,0] due to: No other replicas in ISR 2 for [othertopic,0] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,230] ERROR Controller 2 epoch 30 initiated state change for partition [othertopic,0] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [othertopic,0] due to: No other replicas in ISR 2 for [othertopic,0] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [othertopic,0] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:24,231] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,42] (state.change.logger)
[2016-11-15 15:00:24,233] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,42] due to: No other replicas in ISR 2 for [__consumer_offsets,42] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,233] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,42] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,42] due to: No other replicas in ISR 2 for [__consumer_offsets,42] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,42] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:24,234] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,4] (state.change.logger)
[2016-11-15 15:00:24,237] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,4] due to: No other replicas in ISR 2 for [__consumer_offsets,4] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,237] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,4] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,4] due to: No other replicas in ISR 2 for [__consumer_offsets,4] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,4] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:24,238] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,41] (state.change.logger)
[2016-11-15 15:00:24,239] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,41] due to: No other replicas in ISR 2 for [__consumer_offsets,41] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,239] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,41] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,41] due to: No other replicas in ISR 2 for [__consumer_offsets,41] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,41] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:24,240] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,6] (state.change.logger)
[2016-11-15 15:00:24,242] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,6] due to: No other replicas in ISR 2 for [__consumer_offsets,6] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,242] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,6] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,6] due to: No other replicas in ISR 2 for [__consumer_offsets,6] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,6] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:24,242] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,44] (state.change.logger)
[2016-11-15 15:00:24,244] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,44] due to: No other replicas in ISR 2 for [__consumer_offsets,44] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,244] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,44] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,44] due to: No other replicas in ISR 2 for [__consumer_offsets,44] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,44] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 21 more
[2016-11-15 15:00:24,244] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,37] (state.change.logger)
[2016-11-15 15:00:24,246] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,37] due to: No other replicas in ISR 2 for [__consumer_offsets,37] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,246] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,37] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,37] due to: No other replicas in ISR 2 for [__consumer_offsets,37] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,37] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:24,246] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,1] (state.change.logger)
[2016-11-15 15:00:24,248] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,1] due to: No other replicas in ISR 2 for [__consumer_offsets,1] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,248] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,1] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,1] due to: No other replicas in ISR 2 for [__consumer_offsets,1] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,1] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:24,249] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,47] (state.change.logger)
[2016-11-15 15:00:24,251] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,47] due to: No other replicas in ISR 2 for [__consumer_offsets,47] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,251] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,47] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,47] due to: No other replicas in ISR 2 for [__consumer_offsets,47] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,47] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:24,252] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,17] (state.change.logger)
[2016-11-15 15:00:24,254] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,17] due to: No other replicas in ISR 2 for [__consumer_offsets,17] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,254] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,17] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,17] due to: No other replicas in ISR 2 for [__consumer_offsets,17] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,17] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:24,254] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,14] (state.change.logger)
[2016-11-15 15:00:24,257] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,14] due to: No other replicas in ISR 2 for [__consumer_offsets,14] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,257] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,14] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,14] due to: No other replicas in ISR 2 for [__consumer_offsets,14] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,14] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:24,257] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,5] (state.change.logger)
[2016-11-15 15:00:24,260] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,5] due to: No other replicas in ISR 2 for [__consumer_offsets,5] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,260] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,5] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,5] due to: No other replicas in ISR 2 for [__consumer_offsets,5] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,5] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:24,260] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,29] (state.change.logger)
[2016-11-15 15:00:24,263] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,29] due to: No other replicas in ISR 2 for [__consumer_offsets,29] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,263] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,29] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,29] due to: No other replicas in ISR 2 for [__consumer_offsets,29] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,29] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:24,264] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,9] (state.change.logger)
[2016-11-15 15:00:24,266] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,9] due to: No other replicas in ISR 2 for [__consumer_offsets,9] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,266] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,9] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,9] due to: No other replicas in ISR 2 for [__consumer_offsets,9] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,9] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:24,267] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,48] (state.change.logger)
[2016-11-15 15:00:24,269] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,48] due to: No other replicas in ISR 2 for [__consumer_offsets,48] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,270] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,48] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,48] due to: No other replicas in ISR 2 for [__consumer_offsets,48] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,48] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:24,270] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,23] (state.change.logger)
[2016-11-15 15:00:24,273] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,23] due to: No other replicas in ISR 2 for [__consumer_offsets,23] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,273] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,23] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,23] due to: No other replicas in ISR 2 for [__consumer_offsets,23] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,23] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:24,273] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,20] (state.change.logger)
[2016-11-15 15:00:24,276] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,20] due to: No other replicas in ISR 2 for [__consumer_offsets,20] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,276] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,20] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,20] due to: No other replicas in ISR 2 for [__consumer_offsets,20] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,20] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:24,277] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,25] (state.change.logger)
[2016-11-15 15:00:24,279] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,25] due to: No other replicas in ISR 2 for [__consumer_offsets,25] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,279] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,25] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,25] due to: No other replicas in ISR 2 for [__consumer_offsets,25] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,25] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 21 more
[2016-11-15 15:00:24,280] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,16] (state.change.logger)
[2016-11-15 15:00:24,282] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,16] due to: No other replicas in ISR 2 for [__consumer_offsets,16] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,282] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,16] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,16] due to: No other replicas in ISR 2 for [__consumer_offsets,16] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,16] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 21 more
[2016-11-15 15:00:24,282] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,35] (state.change.logger)
[2016-11-15 15:00:24,284] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,35] due to: No other replicas in ISR 2 for [__consumer_offsets,35] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,284] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,35] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,35] due to: No other replicas in ISR 2 for [__consumer_offsets,35] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,35] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 21 more
[2016-11-15 15:00:24,285] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,34] (state.change.logger)
[2016-11-15 15:00:24,287] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,34] due to: No other replicas in ISR 2 for [__consumer_offsets,34] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,287] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,34] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,34] due to: No other replicas in ISR 2 for [__consumer_offsets,34] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,34] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 21 more
[2016-11-15 15:00:24,287] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,15] (state.change.logger)
[2016-11-15 15:00:24,290] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,15] due to: No other replicas in ISR 2 for [__consumer_offsets,15] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,290] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,15] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,15] due to: No other replicas in ISR 2 for [__consumer_offsets,15] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,15] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:24,290] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,10] (state.change.logger)
[2016-11-15 15:00:24,293] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,10] due to: No other replicas in ISR 2 for [__consumer_offsets,10] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,293] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,10] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,10] due to: No other replicas in ISR 2 for [__consumer_offsets,10] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,10] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:24,293] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,3] (state.change.logger)
[2016-11-15 15:00:24,295] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,3] due to: No other replicas in ISR 2 for [__consumer_offsets,3] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,295] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,3] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,3] due to: No other replicas in ISR 2 for [__consumer_offsets,3] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,3] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 21 more
[2016-11-15 15:00:24,296] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,28] (state.change.logger)
[2016-11-15 15:00:24,298] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,28] due to: No other replicas in ISR 2 for [__consumer_offsets,28] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,298] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,28] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,28] due to: No other replicas in ISR 2 for [__consumer_offsets,28] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,28] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:24,298] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,30] (state.change.logger)
[2016-11-15 15:00:24,300] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,30] due to: No other replicas in ISR 2 for [__consumer_offsets,30] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,300] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,30] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,30] due to: No other replicas in ISR 2 for [__consumer_offsets,30] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,30] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:24,301] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,43] (state.change.logger)
[2016-11-15 15:00:24,303] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,43] due to: No other replicas in ISR 2 for [__consumer_offsets,43] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,303] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,43] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,43] due to: No other replicas in ISR 2 for [__consumer_offsets,43] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,43] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:24,304] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,0] (state.change.logger)
[2016-11-15 15:00:24,305] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,0] due to: No other replicas in ISR 2 for [__consumer_offsets,0] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,305] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,0] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,0] due to: No other replicas in ISR 2 for [__consumer_offsets,0] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,0] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:24,306] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,38] (state.change.logger)
[2016-11-15 15:00:24,308] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,38] due to: No other replicas in ISR 2 for [__consumer_offsets,38] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,308] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,38] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,38] due to: No other replicas in ISR 2 for [__consumer_offsets,38] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,38] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:24,309] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,33] (state.change.logger)
[2016-11-15 15:00:24,311] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,33] due to: No other replicas in ISR 2 for [__consumer_offsets,33] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,311] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,33] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,33] due to: No other replicas in ISR 2 for [__consumer_offsets,33] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,33] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 22 more
[2016-11-15 15:00:24,312] TRACE Controller 2 epoch 30 started leader election for partition [__consumer_offsets,8] (state.change.logger)
[2016-11-15 15:00:24,314] ERROR Controller 2 epoch 30 encountered error while electing leader for partition [__consumer_offsets,8] due to: No other replicas in ISR 2 for [__consumer_offsets,8] besides shutting down brokers 2. (state.change.logger)
[2016-11-15 15:00:24,314] ERROR Controller 2 epoch 30 initiated state change for partition [__consumer_offsets,8] from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,8] due to: No other replicas in ISR 2 for [__consumer_offsets,8] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:368)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:79)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:265)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:260)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:260)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:259)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:256)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:322)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:978)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:256)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:174)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:75)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,8] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:196)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	... 21 more
