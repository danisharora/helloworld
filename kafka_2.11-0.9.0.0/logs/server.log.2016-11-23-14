[2016-11-23 15:03:29,161] INFO [Group Metadata Manager on Broker 1]: Removed 0 expired offsets in 0 milliseconds. (kafka.coordinator.GroupMetadataManager)
[2016-11-23 15:13:29,132] INFO [Group Metadata Manager on Broker 1]: Removed 0 expired offsets in 0 milliseconds. (kafka.coordinator.GroupMetadataManager)
[2016-11-23 15:23:29,108] INFO [Group Metadata Manager on Broker 1]: Removed 0 expired offsets in 0 milliseconds. (kafka.coordinator.GroupMetadataManager)
[2016-11-23 15:31:17,214] WARN [ReplicaFetcherThread-0-2], Error in fetch kafka.server.ReplicaFetcherThread$FetchRequest@2ee9a958. Possible cause: java.io.IOException: Connection to 2 was disconnected before the response was read (kafka.server.ReplicaFetcherThread)
[2016-11-23 15:31:17,215] INFO Partition [__consumer_offsets,14] on broker 1: Shrinking ISR for partition [__consumer_offsets,14] from 1,0,2 to 1 (kafka.cluster.Partition)
[2016-11-23 15:31:17,214] WARN [ReplicaFetcherThread-0-0], Error in fetch kafka.server.ReplicaFetcherThread$FetchRequest@2bfe175. Possible cause: java.io.IOException: Connection to 0 was disconnected before the response was read (kafka.server.ReplicaFetcherThread)
[2016-11-23 15:31:19,725] INFO Creating /controller (is it secure? false) (kafka.utils.ZKCheckedEphemeral)
[2016-11-23 15:31:19,726] INFO Partition [__consumer_offsets,2] on broker 1: Shrinking ISR for partition [__consumer_offsets,2] from 1,0,2 to 1 (kafka.cluster.Partition)
[2016-11-23 15:31:19,736] INFO Partition [__consumer_offsets,32] on broker 1: Shrinking ISR for partition [__consumer_offsets,32] from 1,0,2 to 1 (kafka.cluster.Partition)
[2016-11-23 15:31:19,746] INFO Result of znode creation is: NODEEXISTS (kafka.utils.ZKCheckedEphemeral)
[2016-11-23 15:31:19,755] INFO Partition [__consumer_offsets,29] on broker 1: Shrinking ISR for partition [__consumer_offsets,29] from 1,0,2 to 1 (kafka.cluster.Partition)
[2016-11-23 15:31:19,763] INFO re-registering broker info in ZK for broker 1 (kafka.server.KafkaHealthcheck)
[2016-11-23 15:31:19,765] INFO Partition [__consumer_offsets,5] on broker 1: Shrinking ISR for partition [__consumer_offsets,5] from 1,0,2 to 1 (kafka.cluster.Partition)
[2016-11-23 15:31:19,776] INFO Creating /brokers/ids/1 (is it secure? false) (kafka.utils.ZKCheckedEphemeral)
[2016-11-23 15:31:19,816] INFO Partition [__consumer_offsets,11] on broker 1: Shrinking ISR for partition [__consumer_offsets,11] from 1,0,2 to 1 (kafka.cluster.Partition)
[2016-11-23 15:31:19,818] INFO Result of znode creation is: OK (kafka.utils.ZKCheckedEphemeral)
[2016-11-23 15:31:19,818] INFO Registered broker 1 at path /brokers/ids/1 with addresses: PLAINTEXT -> EndPoint(localhost,9010,PLAINTEXT) (kafka.utils.ZkUtils)
[2016-11-23 15:31:19,818] INFO done re-registering broker (kafka.server.KafkaHealthcheck)
[2016-11-23 15:31:19,818] INFO Subscribing to /brokers/topics path to watch for new topics (kafka.server.KafkaHealthcheck)
[2016-11-23 15:31:19,821] INFO Partition [test2,0] on broker 1: Shrinking ISR for partition [test2,0] from 1,2 to 1 (kafka.cluster.Partition)
[2016-11-23 15:31:19,825] INFO Partition [__consumer_offsets,47] on broker 1: Shrinking ISR for partition [__consumer_offsets,47] from 1,0,2 to 1 (kafka.cluster.Partition)
[2016-11-23 15:31:19,829] INFO Partition [__consumer_offsets,44] on broker 1: Shrinking ISR for partition [__consumer_offsets,44] from 1,0,2 to 1 (kafka.cluster.Partition)
[2016-11-23 15:31:19,833] INFO New leader is 0 (kafka.server.ZookeeperLeaderElector$LeaderChangeListener)
[2016-11-23 15:31:19,834] INFO Partition [__consumer_offsets,17] on broker 1: Shrinking ISR for partition [__consumer_offsets,17] from 1,0,2 to 1 (kafka.cluster.Partition)
[2016-11-23 15:31:19,837] INFO Partition [__consumer_offsets,20] on broker 1: Shrinking ISR for partition [__consumer_offsets,20] from 1,0,2 to 1 (kafka.cluster.Partition)
[2016-11-23 15:31:19,839] INFO Partition [__consumer_offsets,23] on broker 1: Shrinking ISR for partition [__consumer_offsets,23] from 1,0,2 to 1 (kafka.cluster.Partition)
[2016-11-23 15:31:19,842] INFO Partition [__consumer_offsets,38] on broker 1: Shrinking ISR for partition [__consumer_offsets,38] from 1,0,2 to 1 (kafka.cluster.Partition)
[2016-11-23 15:31:19,846] INFO Partition [__consumer_offsets,26] on broker 1: Shrinking ISR for partition [__consumer_offsets,26] from 1,0,2 to 1 (kafka.cluster.Partition)
[2016-11-23 15:31:19,849] INFO Partition [__consumer_offsets,35] on broker 1: Shrinking ISR for partition [__consumer_offsets,35] from 1,0,2 to 1 (kafka.cluster.Partition)
[2016-11-23 15:31:19,852] INFO Partition [__consumer_offsets,41] on broker 1: Shrinking ISR for partition [__consumer_offsets,41] from 1,0,2 to 1 (kafka.cluster.Partition)
[2016-11-23 15:31:19,854] INFO Partition [test2,1] on broker 1: Shrinking ISR for partition [test2,1] from 1,2 to 1 (kafka.cluster.Partition)
[2016-11-23 15:31:19,863] INFO Partition [__consumer_offsets,8] on broker 1: Shrinking ISR for partition [__consumer_offsets,8] from 1,0,2 to 1 (kafka.cluster.Partition)
[2016-11-23 15:31:21,067] INFO [ReplicaFetcherManager on broker 1] Removed fetcher for partitions [__consumer_offsets,16],[__consumer_offsets,28],[__consumer_offsets,4],[__consumer_offsets,40],[__consumer_offsets,34],[__consumer_offsets,22],[__consumer_offsets,10],[__consumer_offsets,46] (kafka.server.ReplicaFetcherManager)
[2016-11-23 15:31:21,069] INFO [ReplicaFetcherManager on broker 1] Removed fetcher for partitions [__consumer_offsets,7],[__consumer_offsets,31],[__consumer_offsets,49],[__consumer_offsets,19],[__consumer_offsets,1],[__consumer_offsets,43],[__consumer_offsets,25],[__consumer_offsets,37],[__consumer_offsets,13] (kafka.server.ReplicaFetcherManager)
[2016-11-23 15:31:21,070] INFO Truncating log __consumer_offsets-49 to offset 0. (kafka.log.Log)
[2016-11-23 15:31:21,070] INFO Truncating log __consumer_offsets-7 to offset 0. (kafka.log.Log)
[2016-11-23 15:31:21,071] INFO Truncating log __consumer_offsets-13 to offset 0. (kafka.log.Log)
[2016-11-23 15:31:21,071] INFO Truncating log __consumer_offsets-37 to offset 0. (kafka.log.Log)
[2016-11-23 15:31:21,071] INFO Truncating log __consumer_offsets-25 to offset 0. (kafka.log.Log)
[2016-11-23 15:31:21,071] INFO Truncating log __consumer_offsets-31 to offset 0. (kafka.log.Log)
[2016-11-23 15:31:21,071] INFO Truncating log __consumer_offsets-19 to offset 0. (kafka.log.Log)
[2016-11-23 15:31:21,071] INFO Truncating log __consumer_offsets-43 to offset 0. (kafka.log.Log)
[2016-11-23 15:31:21,071] INFO Truncating log __consumer_offsets-1 to offset 0. (kafka.log.Log)
[2016-11-23 15:31:21,078] ERROR [KafkaApi-1] error when handling request Name:LeaderAndIsrRequest;Version:0;Controller:0;ControllerEpoch:6;CorrelationId:2;ClientId:0;Leaders:BrokerEndPoint(1,localhost,9010),BrokerEndPoint(2,localhost,9011);PartitionState:(__consumer_offsets,16) -> (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:0,1,2),(__consumer_offsets,49) -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:0,2,1),(__consumer_offsets,28) -> (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:0,1,2),(__consumer_offsets,7) -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:0,2,1),(__consumer_offsets,4) -> (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:0,1,2),(__consumer_offsets,13) -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:0,2,1),(__consumer_offsets,40) -> (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:0,1,2),(__consumer_offsets,37) -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:0,2,1),(__consumer_offsets,34) -> (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:0,1,2),(__consumer_offsets,22) -> (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:0,1,2),(__consumer_offsets,25) -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:0,2,1),(__consumer_offsets,10) -> (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:0,1,2),(__consumer_offsets,31) -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:0,2,1),(__consumer_offsets,19) -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:0,2,1),(__consumer_offsets,46) -> (LeaderAndIsrInfo:(Leader:1,ISR:1,LeaderEpoch:5,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:0,1,2),(__consumer_offsets,43) -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:0,2,1),(__consumer_offsets,1) -> (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:5,ControllerEpoch:6),ReplicationFactor:3),AllReplicas:0,2,1) (kafka.server.KafkaApis)
java.lang.IllegalArgumentException: A metric named 'MetricName [name=connection-close-rate, group=replica-fetcher-metrics, description=Connections closed per second in the window., tags={broker-id=2, fetcher-id=0}]' already exists, can't register another one.
	at org.apache.kafka.common.metrics.Metrics.registerMetric(Metrics.java:285)
	at org.apache.kafka.common.metrics.Sensor.add(Sensor.java:177)
	at org.apache.kafka.common.metrics.Sensor.add(Sensor.java:162)
	at org.apache.kafka.common.network.Selector$SelectorMetrics.<init>(Selector.java:572)
	at org.apache.kafka.common.network.Selector.<init>(Selector.java:112)
	at kafka.server.ReplicaFetcherThread.<init>(ReplicaFetcherThread.scala:73)
	at kafka.server.ReplicaFetcherManager.createFetcherThread(ReplicaFetcherManager.scala:35)
	at kafka.server.AbstractFetcherManager$$anonfun$addFetcherForPartitions$2.apply(AbstractFetcherManager.scala:83)
	at kafka.server.AbstractFetcherManager$$anonfun$addFetcherForPartitions$2.apply(AbstractFetcherManager.scala:78)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.immutable.Map$Map1.foreach(Map.scala:116)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.server.AbstractFetcherManager.addFetcherForPartitions(AbstractFetcherManager.scala:78)
	at kafka.server.ReplicaManager.makeFollowers(ReplicaManager.scala:816)
	at kafka.server.ReplicaManager.becomeLeaderOrFollower(ReplicaManager.scala:641)
	at kafka.server.KafkaApis.handleLeaderAndIsrRequest(KafkaApis.scala:131)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:72)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
[2016-11-23 15:31:49,229] WARN [ReplicaFetcherThread-0-2], Error in fetch kafka.server.ReplicaFetcherThread$FetchRequest@3fbb39d. Possible cause: java.io.IOException: Connection to Node(2, 172.16.26.72, 9011) failed (kafka.server.ReplicaFetcherThread)
[2016-11-23 15:31:49,229] WARN [ReplicaFetcherThread-0-0], Error in fetch kafka.server.ReplicaFetcherThread$FetchRequest@47bd6f46. Possible cause: java.io.IOException: Connection to Node(0, 172.16.26.72, 9009) failed (kafka.server.ReplicaFetcherThread)
[2016-11-23 15:32:21,235] WARN [ReplicaFetcherThread-0-2], Error in fetch kafka.server.ReplicaFetcherThread$FetchRequest@7f138a54. Possible cause: java.io.IOException: Connection to Node(2, 172.16.26.72, 9011) failed (kafka.server.ReplicaFetcherThread)
[2016-11-23 15:32:23,242] INFO Partition [__consumer_offsets,32] on broker 1: Expanding ISR for partition [__consumer_offsets,32] from 1 to 1,2 (kafka.cluster.Partition)
[2016-11-23 15:32:23,244] INFO Partition [__consumer_offsets,44] on broker 1: Expanding ISR for partition [__consumer_offsets,44] from 1 to 1,2 (kafka.cluster.Partition)
[2016-11-23 15:32:23,245] INFO Partition [__consumer_offsets,17] on broker 1: Expanding ISR for partition [__consumer_offsets,17] from 1 to 1,2 (kafka.cluster.Partition)
[2016-11-23 15:32:23,246] INFO Partition [__consumer_offsets,23] on broker 1: Expanding ISR for partition [__consumer_offsets,23] from 1 to 1,2 (kafka.cluster.Partition)
[2016-11-23 15:32:23,249] INFO Partition [__consumer_offsets,29] on broker 1: Expanding ISR for partition [__consumer_offsets,29] from 1 to 1,2 (kafka.cluster.Partition)
[2016-11-23 15:32:23,252] INFO Partition [__consumer_offsets,35] on broker 1: Expanding ISR for partition [__consumer_offsets,35] from 1 to 1,2 (kafka.cluster.Partition)
[2016-11-23 15:32:23,348] INFO Partition [__consumer_offsets,41] on broker 1: Expanding ISR for partition [__consumer_offsets,41] from 1 to 1,2 (kafka.cluster.Partition)
[2016-11-23 15:32:23,416] INFO Partition [__consumer_offsets,38] on broker 1: Expanding ISR for partition [__consumer_offsets,38] from 1 to 1,2 (kafka.cluster.Partition)
[2016-11-23 15:32:23,420] INFO Partition [__consumer_offsets,8] on broker 1: Expanding ISR for partition [__consumer_offsets,8] from 1 to 1,2 (kafka.cluster.Partition)
[2016-11-23 15:32:23,422] INFO Partition [__consumer_offsets,5] on broker 1: Expanding ISR for partition [__consumer_offsets,5] from 1 to 1,2 (kafka.cluster.Partition)
[2016-11-23 15:32:23,424] INFO Partition [__consumer_offsets,11] on broker 1: Expanding ISR for partition [__consumer_offsets,11] from 1 to 1,2 (kafka.cluster.Partition)
[2016-11-23 15:32:23,427] INFO Partition [__consumer_offsets,20] on broker 1: Expanding ISR for partition [__consumer_offsets,20] from 1 to 1,2 (kafka.cluster.Partition)
[2016-11-23 15:32:23,429] INFO Partition [__consumer_offsets,47] on broker 1: Expanding ISR for partition [__consumer_offsets,47] from 1 to 1,2 (kafka.cluster.Partition)
[2016-11-23 15:32:23,430] INFO Partition [__consumer_offsets,2] on broker 1: Expanding ISR for partition [__consumer_offsets,2] from 1 to 1,2 (kafka.cluster.Partition)
[2016-11-23 15:32:23,431] INFO Partition [test2,0] on broker 1: Expanding ISR for partition [test2,0] from 1 to 1,2 (kafka.cluster.Partition)
[2016-11-23 15:32:23,433] INFO Partition [__consumer_offsets,14] on broker 1: Expanding ISR for partition [__consumer_offsets,14] from 1 to 1,2 (kafka.cluster.Partition)
[2016-11-23 15:32:23,434] INFO Partition [test2,1] on broker 1: Expanding ISR for partition [test2,1] from 1 to 1,2 (kafka.cluster.Partition)
[2016-11-23 15:32:23,436] INFO Partition [__consumer_offsets,26] on broker 1: Expanding ISR for partition [__consumer_offsets,26] from 1 to 1,2 (kafka.cluster.Partition)
[2016-11-23 15:32:23,486] INFO Partition [__consumer_offsets,32] on broker 1: Expanding ISR for partition [__consumer_offsets,32] from 1,2 to 1,2,0 (kafka.cluster.Partition)
[2016-11-23 15:32:23,646] INFO Partition [__consumer_offsets,44] on broker 1: Expanding ISR for partition [__consumer_offsets,44] from 1,2 to 1,2,0 (kafka.cluster.Partition)
[2016-11-23 15:32:23,648] INFO Partition [__consumer_offsets,17] on broker 1: Expanding ISR for partition [__consumer_offsets,17] from 1,2 to 1,2,0 (kafka.cluster.Partition)
[2016-11-23 15:32:23,649] INFO Partition [__consumer_offsets,23] on broker 1: Expanding ISR for partition [__consumer_offsets,23] from 1,2 to 1,2,0 (kafka.cluster.Partition)
[2016-11-23 15:32:23,651] INFO Partition [__consumer_offsets,29] on broker 1: Expanding ISR for partition [__consumer_offsets,29] from 1,2 to 1,2,0 (kafka.cluster.Partition)
[2016-11-23 15:32:23,652] INFO Partition [__consumer_offsets,35] on broker 1: Expanding ISR for partition [__consumer_offsets,35] from 1,2 to 1,2,0 (kafka.cluster.Partition)
[2016-11-23 15:32:23,654] INFO Partition [__consumer_offsets,41] on broker 1: Expanding ISR for partition [__consumer_offsets,41] from 1,2 to 1,2,0 (kafka.cluster.Partition)
[2016-11-23 15:32:23,655] INFO Partition [__consumer_offsets,38] on broker 1: Expanding ISR for partition [__consumer_offsets,38] from 1,2 to 1,2,0 (kafka.cluster.Partition)
[2016-11-23 15:32:23,656] INFO Partition [__consumer_offsets,8] on broker 1: Expanding ISR for partition [__consumer_offsets,8] from 1,2 to 1,2,0 (kafka.cluster.Partition)
[2016-11-23 15:32:23,657] INFO Partition [__consumer_offsets,5] on broker 1: Expanding ISR for partition [__consumer_offsets,5] from 1,2 to 1,2,0 (kafka.cluster.Partition)
[2016-11-23 15:32:23,658] INFO Partition [__consumer_offsets,11] on broker 1: Expanding ISR for partition [__consumer_offsets,11] from 1,2 to 1,2,0 (kafka.cluster.Partition)
[2016-11-23 15:32:23,659] INFO Partition [__consumer_offsets,20] on broker 1: Expanding ISR for partition [__consumer_offsets,20] from 1,2 to 1,2,0 (kafka.cluster.Partition)
[2016-11-23 15:32:23,660] INFO Partition [__consumer_offsets,47] on broker 1: Expanding ISR for partition [__consumer_offsets,47] from 1,2 to 1,2,0 (kafka.cluster.Partition)
[2016-11-23 15:32:23,661] INFO Partition [__consumer_offsets,2] on broker 1: Expanding ISR for partition [__consumer_offsets,2] from 1,2 to 1,2,0 (kafka.cluster.Partition)
[2016-11-23 15:32:23,662] INFO Partition [__consumer_offsets,14] on broker 1: Expanding ISR for partition [__consumer_offsets,14] from 1,2 to 1,2,0 (kafka.cluster.Partition)
[2016-11-23 15:32:23,663] INFO Partition [__consumer_offsets,26] on broker 1: Expanding ISR for partition [__consumer_offsets,26] from 1,2 to 1,2,0 (kafka.cluster.Partition)
[2016-11-23 15:35:28,653] INFO [Group Metadata Manager on Broker 1]: Removed 0 expired offsets in 0 milliseconds. (kafka.coordinator.GroupMetadataManager)
[2016-11-23 15:45:28,621] INFO [Group Metadata Manager on Broker 1]: Removed 0 expired offsets in 0 milliseconds. (kafka.coordinator.GroupMetadataManager)
[2016-11-23 15:55:28,594] INFO [Group Metadata Manager on Broker 1]: Removed 0 expired offsets in 0 milliseconds. (kafka.coordinator.GroupMetadataManager)
